function initializeStartupConfiguration(){window.imTableConstraint={goAnnotation:[],datasetName:[],pathwayName:[],proteinDomainName:[],diseaseName:[]},window.interminesHashMap=null,window.locationFilter=null,window.interactionsFilter=null,window.clinVarFilter=null,window.expressionFilter=null,window.proteinLocalisationFilter=null,window.currentClassViewFilter=null,window.pieChartObject=null,window.geneLengthChartObject=null,window.minesConfigs=null,readTextFile("./mine_configs/mines_filters.json",function(e){window.minesConfigs=JSON.parse(e)}),window.mineUrl="httpCOLONSLASHSLASHwww.humanmine.orgSLASHhumanmineSLASHservice",window.selectedMineName="HumanMine",sessionStorage.getItem("currentClassView")||sessionStorage.setItem("currentClassView","Gene"),"undefined"!=typeof Storage&&localStorage.getItem("selectedMineName")&&localStorage.getItem("mineUrl")&&(window.mineUrl=localStorage.getItem("mineUrl"),window.selectedMineName=localStorage.getItem("selectedMineName")),$("#apiKeyManagerButton").click(function(){initializeKeyManager(),$("#apiKeyManagerModal").appendTo("body").modal("show")}),$("#apiKeyManagerSaveButton").click(function(){var i=[],n=!1;$("#apiKeyManagerModalKeysDiv").children("div").each(function(){var t=$(this).children("label").text(),a=$(this).children("input").val();""!=a?$.ajax({url:findElementJSONarray(window.interminesHashMap,"mine",t).mineurl+"/user/whoami?token="+a,type:"GET",async:!1,success:function(e){i.push({mine:t,apikey:a})},error:function(e){n=!0,0==$("#invalidAPIkeyAlert").length?($("#navbarResponsive").prepend("<div class='alert' id='invalidAPIkeyAlert'><span class='closebtn' id='closeInvalidAPIkeyAlert'>×</span>Error: API key provided for "+t+" is not a valid API key - please check you have entered it correctly.</div><br/>"),$("#closeInvalidAPIkeyAlert").click(function(){$("#invalidAPIkeyAlert").hide()})):$("#invalidAPIkeyAlert").show()}.bind(this,n)}):i.push({mine:t,apikey:a})}).promise().done(function(){n||(localStorage.setItem("api-keys",JSON.stringify(i)),location.reload()),$("#apiKeyManagerModal").modal("toggle")})}),$("#viewManagerButton").click(function(){initializeViewManager(),$("#viewManagerModal").appendTo("body").modal("show")})}function updateTableWithConstraints(){for(;0<window.imTable.query.constraints.length;)try{window.imTable.query.removeConstraint(window.imTable.query.constraints[0])}catch(e){continue}0<window.imTableConstraint.goAnnotation.length&&("Gene"==sessionStorage.getItem("currentClassView")?window.imTable.query.addConstraint({path:"goAnnotation.ontologyTerm.name",op:"ONE OF",values:window.imTableConstraint.goAnnotation}):window.imTable.query.addConstraint({path:"ontologyAnnotations.ontologyTerm.name",op:"ONE OF",values:window.imTableConstraint.goAnnotation})),0<window.imTableConstraint.datasetName.length&&window.imTable.query.addConstraint({path:"dataSets.name",op:"ONE OF",values:window.imTableConstraint.datasetName}),0<window.imTableConstraint.pathwayName.length&&window.imTable.query.addConstraint({path:"pathways.name",op:"ONE OF",values:window.imTableConstraint.pathwayName}),0<window.imTableConstraint.proteinDomainName.length&&("Gene"==sessionStorage.getItem("currentClassView")?window.imTable.query.addConstraint({path:"proteins.proteinDomainRegions.proteinDomain.name",op:"ONE OF",values:window.imTableConstraint.proteinDomainName}):window.imTable.query.addConstraint({path:"proteinDomainRegions.proteinDomain.name",op:"ONE OF",values:window.imTableConstraint.proteinDomainName})),0<window.imTableConstraint.diseaseName.length&&window.imTable.query.addConstraint({path:"diseases.name",op:"ONE OF",values:window.imTableConstraint.diseaseName})}function showMoreDatasetNames(){$.when(getDatasetNamesInClass()).done(function(e){for(var t=[],a=0;a<e.results.length;a++)if(null!=e.results[a].item){if("KEGG pathways data set"==e.results[a].item||"HGNC identifiers"==e.results[a].item||"BioGRID interaction data set"==e.results[a].item||"IntAct interactions data set"==e.results[a].item||"ClinVar data set"==e.results[a].item||"OMIM diseases"==e.results[a].item)continue;t.push({label:e.results[a].item+" ("+e.results[a].count+")",value:e.results[a].item})}var i=[];for(a=0;a<t.length;a++)i.push(t[a].value);if(i.sort(),!(i.length<4)){var n=(i=i.slice(3)).length;for(a=0;a<n;a++){var l=i[a];$("#datasetsSelector").append('<div class="form-check" style="margin-left: 10px;"><input class="form-check-input" type="checkbox" id="'+l.replace(/[^a-zA-Z0-9]/g,"")+'" value="'+l+'"><label class="form-check-label" for="'+l+'"><p>'+l+"</p></label></div>"),$("#"+l.replace(/[^a-zA-Z0-9]/g,"")).change(function(){if($(this).is(":checked")){var e=$(this).val();window.imTableConstraint.datasetName.push(e)}else{e=$(this).val();remove(window.imTableConstraint.datasetName,e)}updateTableWithConstraints()})}}})}function clearExtraFilters(){$("#locationFilterLi").remove(),$("#diseasesFilterLi").remove(),$("#clinvarFilterLi").remove(),$("#proteinLocalisationFilterLi").remove(),$("#proteinDomainFilterLi").remove(),$("#interactionsFilterLi").remove(),$("#expressionFilterLi").remove(),$("#datasetFilterLi").remove(),window.extraFiltersAdded=!1}function addExtraFilters(){if(!window.extraFiltersAdded)if("Gene"==sessionStorage.getItem("currentClassView")){var e=window.minesConfigs[window.selectedMineName].extra_filters;e.includes("location")&&$("#sidebarUl").append('<li class="nav-item" data-toggle="tooltip" data-placement="right" title="Location" id="locationFilterLi"><a class="nav-link" data-toggle="collapse" href="#locationSearchCardBlock" aria-controls="locationSearchCardBlock" style="color:black;"><i class="fa fa-fw fa-location-arrow"></i><span class="nav-link-text"></span>Location</a>    <div class="card" style="width: 100%;">        <div class="collapse card-block" id="locationSearchCardBlock" style="overflow-y: auto; overflow-x:hidden;">            <div class="ul list-group list-group-flush" id="locationFilterList"></div>            <form-group class="ui-front">                <div class="row" style="align: center;"><input class="form-control" type="text" id="locationChromosomeSearchInput" placeholder="Chromosome (e.g. 12)" style="width: 100%; float:left; margin-left: 15px;" /></div>                <div class="row" style="align: center;"><input class="form-control" type="text" id="locationStartSearchInput" placeholder="Start" style="width: 45%; float:left; margin-left: 15px;" /><input class="form-control" type="text" id="locationEndSearchInput" placeholder="End" style="width: 45%;"                    /></div><button class="btn btn-success" type="button" style="width:100%;" id="locationSearchButton">Go!</button><button class="btn btn-danger" type="button" style="width:100%;" id="locationResetButton">Reset</button></form-group>        </div>    </div></li>'),e.includes("expression")&&$("#sidebarUl").append('<li class="nav-item" data-toggle="tooltip" data-placement="right" title="Expression" id="expressionFilterLi"><a class="nav-link" data-toggle="collapse" href="#expressionSearchCardBlock" aria-controls="expressionSearchCardBlock" style="color:black;"><i class="fa fa-fw fa-tasks"></i><span class="nav-link-text"></span>Expression</a><div class="card" style="width: 100%;"><div class="collapse card-block" id="expressionSearchCardBlock" style="overflow-y: auto; overflow-x:hidden;"><div class="ul list-group list-group-flush" id="expressionFilterList"></div><form-group class="ui-front"><div class="row" style="align: center;"><select class="form-control" id="expressionExpressionSelector" style="width: 45%; float:left; margin-left: 15px;"><option value="UP">UP</option><option value="DOWN">DOWN</option><option value="NONDE">NONDE</option></select><select class="form-control" id="expressionDatasetSelector" style="width: 45%;"><option value="All">All (Set)</option><option value="ArrayExpress accession: E-MTAB-62">E-MTAB-62</option><option value="E-MTAB-513 illumina body map">Illumina bodymap</option></select></div><div class="row" style="align: center;"><input class="form-control" type="text" id="expressionPvalueSearchInput" placeholder="P-value (Opt)" style="width: 45%; float:left; margin-left: 15px;"/><input class="form-control" type="text" id="expressionTstatisticSearchInput" placeholder="T-statistic (Opt)" style="width: 45%;"/></div><button class="btn btn-success" type="button" style="width:100%;" id="expressionSearchButton">Go!</button><button class="btn btn-danger" type="button" style="width:100%;" id="expressionResetButton">Reset</button></form-group></div></div></li>'),e.includes("interactions")&&($("#sidebarUl").append('<li class="nav-item" data-toggle="tooltip" data-placement="right" title="Interactions" id="interactionsFilterLi"><a class="nav-link" data-toggle="collapse" href="#interactionsSearchCardBlock" aria-controls="interactionsSearchCardBlock" style="color:black;"><i class="fa fa-fw fa-podcast"></i><span class="nav-link-text"></span>Interactions</a><div class="card" style="width: 100%;"><div class="collapse card-block" id="interactionsSearchCardBlock" style="overflow-y: auto; overflow-x:hidden;"><div class="ul list-group list-group-flush" id="interactionsFilterList"></div><form-group class="ui-front"><div class="row" style="align: center;"><input class="form-control" type="text" id="interactionsParticipant2SearchInput" placeholder="Optional: Participant 2 (symbol)" style="width: 100%; float:left; margin-left: 15px;"/></div><div class="row" style="align: center;"><select class="form-control" id="interactionsTypeSelector" style="width: 45%; float:left; margin-left: 15px;"><option value="All">All (Type)</option><option value="physical">Physical</option><option value="genetic">Genetic</option></select><select class="form-control" id="interactionsDatasetSelector" style="width: 45%;"><option value="All">All (Set)</option><option value="BioGRID interaction data set">BioGRID</option><option value="IntAct interactions data set">IntAct</option></select></div><button class="btn btn-success" type="button" style="width:100%;" id="interactionsSearchButton">Go!</button><button class="btn btn-danger" type="button" style="width:100%;" id="interactionsResetButton">Reset</button></form-group></div></div></li>'),$.when(getParticipant2SymbolsInClass()).done(function(e){for(var a=[],t=0;t<e.results.length;t++)null!=e.results[t].item&&a.push({label:e.results[t].item+" ("+e.results[t].count+")",value:e.results[t].item});$("#interactionsParticipant2SearchInput").autocomplete({minLength:3,source:function(e,t){t($.ui.autocomplete.filter(a,e.term).slice(0,15))},select:function(e,t){e.preventDefault(),$("#interactionsParticipant2SearchInput").val(t.item.value)},focus:function(e,t){e.preventDefault(),$("#interactionsParticipant2SearchInput").val(t.item.value)}})})),e.includes("diseases")&&($("#sidebarUl").append('<li class="nav-item" data-toggle="tooltip" data-placement="right" title="Diseases (OMIM)" id="diseasesFilterLi"><a class="nav-link" data-toggle="collapse" href="#diseasesSearchCardBlock" aria-controls="diseasesSearchCardBlock" style="color:black;"><i class="fa fa-fw fa-certificate"></i><span class="nav-link-text"></span>Diseases (OMIM)</a><div class="card" style="width: 100%;"><div class="collapse card-block" id="diseasesSearchCardBlock" style="overflow: auto;"><div class="ul list-group list-group-flush" id="diseasesFilterList"></div><form-group class="ui-front"><input class="form-control" type="text" id="diseasesSearchInput" placeholder="e.g. alzheimer disease"/></form-group></div></div></li>'),$.when(getDiseasesNamesInClass()).done(function(e){for(var a=[],t=0;t<e.results.length;t++)null!=e.results[t].item&&a.push({label:e.results[t].item+" ("+e.results[t].count+")",value:e.results[t].item});$("#diseasesSearchInput").autocomplete({minLength:3,source:function(e,t){t($.ui.autocomplete.filter(a,e.term).slice(0,15))},select:function(e,t){e.preventDefault(),$("#diseasesSearchInput").val(t.item.value),window.imTableConstraint.diseaseName.push(t.item.value),updateTableWithConstraints();var a=t.item.value.replace(/[^a-zA-Z0-9]/g,"")+"button";$("#diseasesFilterList").append('<div class="input-group" id="'+t.item.value.replace(/[^a-zA-Z0-9]/g,"")+'"><label class="form-control">'+t.item.value.slice(0,22)+'</label><span class="input-group-btn"><button class="btn btn-sm" type="button" id="'+a+'" style="height: 100%;">x</button></span></div>'),$("#"+a).click(function(){remove(window.imTableConstraint.diseaseName,t.item.value),updateTableWithConstraints(),$("#"+t.item.value.replace(/[^a-zA-Z0-9]/g,"")).remove()})},focus:function(e,t){e.preventDefault(),$("#diseasesSearchInput").val(t.item.value)}})})),e.includes("clinvar")&&($("#sidebarUl").append('<li class="nav-item" data-toggle="tooltip" data-placement="right" title="ClinVar" id="clinvarFilterLi"><a class="nav-link" data-toggle="collapse" href="#clinvarSearchCardBlock" aria-controls="clinvarSearchCardBlock" style="color:black;"><i class="fa fa-fw fa-eyedropper"></i><span class="nav-link-text"></span>ClinVar</a><div class="card" style="width: 100%;"><div class="collapse card-block" id="clinvarSearchCardBlock" style="overflow-y: auto; overflow-x:hidden;"><form-group class="ui-front"><div style="align: center;"><input class="form-control" type="text" id="clinvarClinicalSignificanceSearchInput" placeholder="Significance (e.g. Pathogenic)" style="width: 100%;"/><input class="form-control" type="text" id="clinvarTypeSearchInput" placeholder="Type (e.g. insertion)" style="width: 100%;"/></div><button class="btn btn-success" type="button" style="width:100%;" id="clinvarSearchButton">Go!</button><button class="btn btn-danger" type="button" style="width:100%;" id="clinvarResetButton">Reset</button></form-group></div></div></li>'),$.when(getAllelesClinicalSignifanceInClass()).done(function(e){for(var a=[],t=0;t<e.results.length;t++)null!=e.results[t].item&&a.push({label:e.results[t].item+" ("+e.results[t].count+")",value:e.results[t].item});$("#clinvarClinicalSignificanceSearchInput").autocomplete({minLength:2,source:function(e,t){t($.ui.autocomplete.filter(a,e.term).slice(0,15))},select:function(e,t){e.preventDefault(),$("#clinvarClinicalSignificanceSearchInput").val(t.item.value)},focus:function(e,t){e.preventDefault(),$("#clinvarClinicalSignificanceSearchInput").val(t.item.value)}})}),$.when(getAllelesTypesInClass()).done(function(e){for(var a=[],t=0;t<e.results.length;t++)null!=e.results[t].item&&a.push({label:e.results[t].item+" ("+e.results[t].count+")",value:e.results[t].item});$("#clinvarTypeSearchInput").autocomplete({minLength:2,source:function(e,t){t($.ui.autocomplete.filter(a,e.term).slice(0,15))},select:function(e,t){e.preventDefault(),$("#clinvarTypeSearchInput").val(t.item.value)},focus:function(e,t){e.preventDefault(),$("#clinvarTypeSearchInput").val(t.item.value)}})})),e.includes("protein-localisation")&&($("#sidebarUl").append('<li class="nav-item" data-toggle="tooltip" data-placement="right" title="Protein Localisation" id="proteinLocalisationFilterLi"><a class="nav-link" data-toggle="collapse" href="#proteinLocalisationSearchCardBlock" aria-controls="proteinLocalisationSearchCardBlock" style="color:black;"><i class="fa fa-fw fa-trello"></i><span class="nav-link-text"></span>Protein Localisation</a><div class="card" style="width: 100%;"><div class="collapse card-block" id="proteinLocalisationSearchCardBlock" style="overflow-y: auto; overflow-x:hidden;"><div class="ul list-group list-group-flush" id="proteinLocalisationFilterList"></div><form-group class="ui-front"><div class="row"><input class="form-control" type="text" id="proteinLocalisationCellTypeSearchInput" placeholder="Cell type (e.g. adipocytes)" style="width: 100%; margin-left: 15px;"/></div><div class="row" style="align: center;"><select class="form-control" id="proteinLocalisationExpressionTypeSelector" style="width: 45%; float:left; margin-left: 15px;"><option value="All">All (Type)</option><option value="APE - two or more antibodies">Two or more antibodies</option><option value="Staining - one antibody only">One antibody only</option></select><select class="form-control" id="proteinLocalisationLevelSelector" style="width: 45%;"><option value="All">All (Level)</option><option value="Low">Low</option><option value="Medium">Medium</option><option value="High">High</option><option value="Not detected">Not detected</option></select></div><div class="row" style="align: center;"><input class="form-control" type="text" id="proteinLocalisationTissueSearchInput" placeholder="Tissue" style="width: 45%; float:left; margin-left: 15px;"/><select class="form-control" id="proteinLocalisationRealibilitySelector" style="width: 45%;"><option value="All">All (Realibility)</option><option value="Low">Low</option><option value="Uncertain">Uncertain</option><option value="Supportive">Supportive</option><option value="High">High</option></select></div><button class="btn btn-success" type="button" style="width:100%;" id="proteinLocalisationSearchButton">Go!</button><button class="btn btn-danger" type="button" style="width:100%;" id="proteinLocalisationResetButton">Reset</button></form-group></div></div></li>'),$.when(getProteinAtlasExpressionCellTypesInClass()).done(function(e){for(var a=[],t=0;t<e.results.length;t++)null!=e.results[t].item&&a.push({label:e.results[t].item+" ("+e.results[t].count+")",value:e.results[t].item});$("#proteinLocalisationCellTypeSearchInput").autocomplete({minLength:2,source:function(e,t){t($.ui.autocomplete.filter(a,e.term).slice(0,15))},select:function(e,t){e.preventDefault(),$("#proteinLocalisationCellTypeSearchInput").val(t.item.value)},focus:function(e,t){e.preventDefault(),$("#proteinLocalisationCellTypeSearchInput").val(t.item.value)}})}),$.when(getProteinAtlasExpressionTissueNamesInClass()).done(function(e){for(var a=[],t=0;t<e.results.length;t++)null!=e.results[t].item&&a.push({label:e.results[t].item+" ("+e.results[t].count+")",value:e.results[t].item});$("#proteinLocalisationTissueSearchInput").autocomplete({minLength:2,source:function(e,t){t($.ui.autocomplete.filter(a,e.term).slice(0,15))},select:function(e,t){e.preventDefault(),$("#proteinLocalisationTissueSearchInput").val(t.item.value)},focus:function(e,t){e.preventDefault(),$("#proteinLocalisationTissueSearchInput").val(t.item.value)}})})),e.includes("protein-domain")&&($("#sidebarUl").append('<li class="nav-item" data-toggle="tooltip" data-placement="right" title="Protein Domain Name" id="proteinDomainFilterLi"><a class="nav-link" data-toggle="collapse" href="#proteinDomainNameSearchCardBlock" aria-controls="proteinDomainNameSearchCardBlock" style="color:black;"><i class="fa fa-fw fa-product-hunt"></i><span class="nav-link-text"></span>Protein Domain Name</a><div class="card" style="width: 100%;"><div class="collapse card-block" id="proteinDomainNameSearchCardBlock" style="overflow: auto;"><div class="ul list-group list-group-flush" id="proteinDomainNameFilterList"></div><form-group class="ui-front"><input class="form-control" type="text" id="proteinDomainNameSearchInput" placeholder="e.g. immunoglobulin subtype"/></form-group></div></div></li>'),$.when(getProteinDomainNamesInClass()).done(function(e){for(var a=[],t=0;t<e.results.length;t++)null!=e.results[t].item&&a.push({label:e.results[t].item+" ("+e.results[t].count+")",value:e.results[t].item});$("#proteinDomainNameSearchInput").autocomplete({minLength:3,source:function(e,t){t($.ui.autocomplete.filter(a,e.term).slice(0,15))},select:function(e,t){e.preventDefault(),$("#proteinDomainNameSearchInput").val(t.item.value),window.imTableConstraint.proteinDomainName.push(t.item.value),updateTableWithConstraints();var a=t.item.value.replace(/[^a-zA-Z0-9]/g,"")+"button";$("#proteinDomainNameFilterList").append('<div class="input-group" id="'+t.item.value.replace(/[^a-zA-Z0-9]/g,"")+'"><label class="form-control">'+t.item.value.slice(0,22)+'</label><span class="input-group-btn"><button class="btn btn-sm" type="button" id="'+a+'" style="height: 100%;">x</button></span></div>'),$("#"+a).click(function(){remove(window.imTableConstraint.proteinDomainName,t.item.value),updateTableWithConstraints(),$("#"+t.item.value.replace(/[^a-zA-Z0-9]/g,"")).remove()})},focus:function(e,t){e.preventDefault(),$("#proteinDomainNameSearchInput").val(t.item.value)}})})),createDatasetFilter(),window.extraFiltersAdded=!0}else createDatasetFilter()}function displayItemsInClass(e){$("#organismshortnamelist").parent().find("li").remove();for(var t=[],a=[],i=getColorsArray(e[0].response.results.length),n=0;n<e[0].response.results.length;n++)t.push(e[0].response.results[n].count),a.push(e[0].response.results[n].item);var l=e[0].response.results.length;5<l&&(l=5);for(n=0;n<l;n++){var o=e[0].response.results[n].item,s="("+e[0].response.results[n].count+")";$("#organismshortnamelist").append('<li class="list-group-item" style="border-width: 2px; border-style: solid; border-color: '+i[n]+';"><a class="nav-link" href="#" style="color:black; text-align:center;"><p class="float-md-left">'+o+'</p><p class="float-md-right">'+s+"</p></a></li>")}}function updatePieChart(e,t){window.pieChartObject&&window.pieChartObject.destroy();for(var a=document.getElementById(t),i=[],n=[],l=getColorsArray(e[0].response.results.length),o=0;o<e[0].response.results.length;o++)i.push(e[0].response.results[o].count),n.push(e[0].response.results[o].item+" ("+e[0].response.results[o].count+")");var s={responsive:!0,maintainAspectRatio:!1,elements:{center:{text:"90%",color:"#FF6384",fontStyle:"Arial",sidePadding:20}},legend:{display:!0,position:"top",onClick:function(e){e.stopPropagation()}},hover:{mode:"nearest",intersect:!0},title:{display:!0,text:"Number of results for "+sessionStorage.getItem("currentClassView")+" by organism",position:"bottom"},tooltips:{callbacks:{label:function(e,t){return t.labels[e.index]}},custom:function(e){e.opacity||(document.getElementById(t).style.cursor="default")}},onClick:function(e,t){if(t.length){var a=t[0]._index;selectedSegment=window.pieChartObject.data.labels[a].split("(")[0].trim(),window.imTable.query.addConstraint({path:"organism.shortName",op:"==",value:selectedSegment})}}};window.pieChartObject=new Chart(a,{type:"pie",data:{labels:n,datasets:[{data:i,backgroundColor:l}]},options:s})}function createGoAnnotationFilter(){try{$.when(getOntologyTermsInClass()).done(function(e){for(var a=[],t=0;t<e.results.length;t++)null!=e.results[t].item&&a.push({label:e.results[t].item+" ("+e.results[t].count+")",value:e.results[t].item});$("#goAnnotationSearchInput").autocomplete({minLength:3,source:function(e,t){t($.ui.autocomplete.filter(a,e.term).slice(0,15))},updater:function(e){return e},select:function(e,t){e.preventDefault(),$("#goAnnotationSearchInput").val(t.item.value),window.imTableConstraint.goAnnotation.push(t.item.value),updateTableWithConstraints();var a=t.item.value.replace(/[^a-zA-Z0-9]/g,"")+"button";$("#goAnnotationFilterList").append('<div class="input-group" id="'+t.item.value.replace(/[^a-zA-Z0-9]/g,"")+'"><label class="form-control">'+t.item.value.slice(0,22)+'</label><span class="input-group-btn"><button class="btn btn-sm" type="button" id="'+a+'" style="height: 100%;">x</button></span></div>'),$("#"+a).click(function(){remove(window.imTableConstraint.goAnnotation,t.item.value),updateTableWithConstraints(),$("#"+t.item.value.replace(/[^a-zA-Z0-9]/g,"")).remove()})},focus:function(e,t){e.preventDefault(),$("#goAnnotationSearchInput").val(t.item.value)}})})}catch(e){$("#goAnnotationFilterLi").remove(),console.log(e)}}function createDatasetFilter(){try{0==$("#datasetFilterLi").length&&$("#sidebarUl").append('<li class="nav-item" data-toggle="tooltip" data-placement="right" title="Dataset Name" id="datasetFilterLi"><a class="nav-link" data-toggle="collapse" href="#datasetNameSearchCardBlock" aria-controls="datasetNameSearchCardBlock" style="color:black;"><i class="fa fa-fw fa-database"></i><span class="nav-link-text"></span>Dataset Name</a><div class="card" style="width: 100%;">        <div class="collapse card-block" id="datasetNameSearchCardBlock" style="overflow-y: auto; overflow-x:hidden;">            <form-group class="ui-front">                <div id="datasetsSelector"></div>            </form-group><button class="btn btn-block btn-warning" id="btnDatasetViewMore" type="button">View more</button></div>    </div></li>'),$.when(getDatasetNamesInClass()).done(function(e){if(!window.datasetNamesLoaded){for(var t=[],a=0;a<e.results.length;a++)if(null!=e.results[a].item){if("KEGG pathways data set"==e.results[a].item||"HGNC identifiers"==e.results[a].item||"BioGRID interaction data set"==e.results[a].item||"IntAct interactions data set"==e.results[a].item||"ClinVar data set"==e.results[a].item||"OMIM diseases"==e.results[a].item)continue;t.push({label:e.results[a].item+" ("+e.results[a].count+")",value:e.results[a].item})}$("#datasetsSelector").empty();var i=e.results.length,n=[];for(a=0;a<t.length;a++)n.push(t[a].value);n.sort(),3<i&&(i=3);for(a=0;a<i;a++){var l=n[a];$("#datasetsSelector").append('<div class="form-check" style="margin-left: 10px;"><input class="form-check-input" type="checkbox" id="'+l.replace(/[^a-zA-Z0-9]/g,"")+'" value="'+l+'"><label class="form-check-label" for="'+l+'"><p>'+l+"</p></label></div>"),$("#"+l.replace(/[^a-zA-Z0-9]/g,"")).change(function(){if($(this).is(":checked")){var e=$(this).val();window.imTableConstraint.datasetName.push(e)}else{e=$(this).val();remove(window.imTableConstraint.datasetName,e)}updateTableWithConstraints()})}window.datasetNamesLoaded=!0}})}catch(e){$("#datasetFilterLi").remove(),console.log(e)}}function createPathwaysNameFilter(){try{$.when(getPathwayNamesInClass()).done(function(e){for(var a=[],t=0;t<e.results.length;t++)null!=e.results[t].item&&a.push({label:e.results[t].item+" ("+e.results[t].count+")",value:e.results[t].item});$("#pathwayNameSearchInput").autocomplete({minLength:3,source:function(e,t){t($.ui.autocomplete.filter(a,e.term).slice(0,15))},select:function(e,t){e.preventDefault(),$("#pathwayNameSearchInput").val(t.item.value),window.imTableConstraint.pathwayName.push(t.item.value),updateTableWithConstraints();var a=t.item.value.replace(/[^a-zA-Z0-9]/g,"")+"button";$("#pathwayFilterList").append('<div class="input-group" id="'+t.item.value.replace(/[^a-zA-Z0-9]/g,"")+'"><label class="form-control">'+t.item.value.slice(0,22)+'</label><span class="input-group-btn"><button class="btn btn-sm" type="button" id="'+a+'" style="height: 100%;">x</button></span></div>'),$("#"+a).click(function(){remove(window.imTableConstraint.pathwayName,t.item.value),updateTableWithConstraints(),$("#"+t.item.value.replace(/[^a-zA-Z0-9]/g,"")).remove()})},focus:function(e,t){e.preventDefault(),$("#pathwayNameSearchInput").val(t.item.value)}})})}catch(e){$("#pathwayNameFilterLi").remove(),console.log(e)}}function addDefaultFilters(){createPathwaysNameFilter(),createGoAnnotationFilter()}function fillMineSelector(){if(0==$("#mineSelector option").length){var l=new URL(window.location.href);$.when(getIntermines()).done(function(e){for(var t,a,i=0;i<e.instances.length;i++)if(!e.instances[i].url.startsWith("https")&&"GrapeMine"!=e.instances[i].name&&"RepetDB"!=e.instances[i].name&&"Wheat3BMine"!=e.instances[i].name&&"WormMine"!=e.instances[i].name&&"XenMine"!=e.instances[i].name&&"PlanMine"!=e.instances[i].name&&"ModMine"!=e.instances[i].name&&"MitoMiner"!=e.instances[i].name){var n=e.instances[i].url;"/"==n[n.length-1]?n+="service":n+="/service",n=formatMineURL(n),e.instances[i].name===window.selectedMineName?(t=e.instances[i].name,a=n):$("#mineSelector").append('<option value="'+n+'">'+e.instances[i].name+"</option>").val(n),l.searchParams.get("givenMine")&&e.instances[i].name==l.searchParams.get("givenMine")&&(window.mineUrl=n,window.selectedMineName=e.instances[i].name,sessionStorage.setItem("currentClassView","Gene"),clearExtraFilters(),updateElements(window.imTable.history.currentQuery.constraints,"PieChart"),updateGeneLengthChart(window.imTable.history.currentQuery.constraints,"GeneLengthChart"))}$("#mineSelector").append('<option value="'+a+'">'+t+"</option>").val(n),$("#mineSelector option[value='"+a+"']").attr("selected","selected"),$("#mineSelector").change(function(a){if(!a.eventPhase)return!1;var i=!0,n=$("#mineSelector option:selected").text(),e=$(this).val();$.ajax({url:escapeMineURL(e),data:{},async:!1,error:function(e,t){if(500<=e.status&&e.status<=511||400<=e.status&&e.status<=431)return 0==$("#unavailableMineAlert").length?($("#navbarResponsive").prepend("<div class='alert' id='unavailableMineAlert'><span class='closebtn' id='closeUnavailableMineAlert'>×</span>Sorry, it looks like the "+n+" server is having problems right now. You can try coming back later, or try browsing a different mine using the mine selector in the top-left corner.</div><br/>"),$("#closeUnavailableMineAlert").click(function(){$("#unavailableMineAlert").hide()})):$("#unavailableMineAlert").show(),i=!1,a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation(),!1}}),i&&(window.mineUrl=e,window.selectedMineName=n,sessionStorage.setItem("currentClassView","Gene"),window.datasetNamesLoaded=!1,window.extraFiltersAdded=!1,"undefined"!=typeof Storage&&(localStorage.setItem("mineUrl",window.mineUrl),localStorage.setItem("selectedMineName",window.selectedMineName)),location.reload())}),$("#mineSelector").trigger("change")})}}function handleExtraFilters(){window.extraFiltersAdded||(window.minesConfigs[window.selectedMineName]?(addExtraFilters(),window.extraFiltersAdded=!0):createDatasetFilter())}function updateElements(e,t){fillMineSelector(),addDefaultFilters(),handleExtraFilters(),initializeKeyManager(),initializeViewManager(),$.when(getItemsInClass(e)).done(function(e){displayItemsInClass(e),createSidebarEvents(),updatePieChart(e,t)})}function initializeKeyManager(){"undefined"!=typeof Storage&&(window.interminesHashMap=[],$.when(getIntermines()).done(function(e){for(var t=0;t<e.instances.length;t++)if(!e.instances[t].url.startsWith("https")&&"GrapeMine"!=e.instances[t].name&&"RepetDB"!=e.instances[t].name&&"Wheat3BMine"!=e.instances[t].name&&"WormMine"!=e.instances[t].name&&"XenMine"!=e.instances[t].name&&"PlanMine"!=e.instances[t].name&&"ModMine"!=e.instances[t].name&&"MitoMiner"!=e.instances[t].name){var a=e.instances[t].name,i=e.instances[t].url;"/"==i[i.length-1]?i+="service":i+="/service",window.interminesHashMap.push({mine:a,mineurl:i,apikey:"Paste your API key here"})}if(localStorage.getItem("api-keys")){var n=JSON.parse(localStorage.getItem("api-keys"));for(t=0;t<window.interminesHashMap.length;t++)findElementJSONarray(n,"mine",window.interminesHashMap[t].mine)||n.push({mine:window.interminesHashMap[t].mine,apikey:"Paste your API key here"});localStorage.setItem("api-keys",JSON.stringify(n))}else localStorage.setItem("api-keys",JSON.stringify(window.interminesHashMap));$("#apiKeyManagerModalKeysDiv").html("");var l=JSON.parse(localStorage.getItem("api-keys"));for(t=0;t<l.length;t++){var o='<div class="apiKeyElement"><label>'+l[t].mine+"</label>";"Paste your API key here"!=l[t].apikey&&""!=l[t].apikey?o+='<input type="text" value="'+l[t].apikey+'"></div>':o+='<input type="text" placeholder="Paste your API key here"></div>',$("#apiKeyManagerModalKeysDiv").append(o)}}))}function initializeViewManager(){if("undefined"!=typeof Storage){var a,i;if(localStorage.getItem("view-manager")||localStorage.setItem("view-manager","[]"),a=JSON.parse(localStorage.getItem("view-manager")),$("#viewManagerModalCurrentViewsDiv").html(""),findElementJSONarray(a,"mine",window.selectedMineName))if((i=findElementJSONarray(a,"mine",window.selectedMineName)).viewNames)for(var e=i.viewNames.split(","),t=0;t<e.length;t++){var n='<div class="viewManagerElement" id="viewManager'+e[t]+'Div"><label id="viewManager'+e[t]+'Label">'+e[t]+"</label>";n+='<button class="btn btn-danger" type="button" id="viewManager'+e[t]+'RemoveButton" data-dismiss="modal">Remove</button></div>',$("#viewManagerModalCurrentViewsDiv").append(n),$("#viewManager"+e[t]+"RemoveButton").click(function(){var e=$(this).closest("div").find("label").text(),t=findElementJSONarray(JSON.parse(localStorage.getItem("view-manager")),"mine",window.selectedMineName),a=t.viewNames.split(",");remove(a,e),a=a.join(","),t.viewNames=a,localStorage.setItem("view-manager",JSON.stringify([t])),$("#viewManager"+e+"Div").remove(),$("#"+e+"Button").remove(),""===t.viewNames.split(",")[0]&&$("#viewManagerModalCurrentViewsDiv").html("You have not added any custom view for this mine.")})}else $("#viewManagerModalCurrentViewsDiv").html("You have not added any custom view for this mine.");else $("#viewManagerModalCurrentViewsDiv").html("You have not added any custom view for this mine.");$("#viewManagerAddViewButton").click(function(){var e=$("#viewManagerAddViewInput").val();(i=findElementJSONarray(a,"mine",window.selectedMineName))||(a.push({mine:window.selectedMineName,viewNames:""}),i=findElementJSONarray(a,"mine",window.selectedMineName));var t=i.viewNames.split(",");"Gene"==e||"Protein"==e||t.includes(e)||(t.push(e),""===t[0]?i.viewNames=t[1]:i.viewNames=t.join(","),localStorage.setItem("view-manager",JSON.stringify([i])),location.reload())})}}function updateGeneLengthChart(e,f){$.when(getGeneLengthsInClass(e)).done(function(e){window.geneLengthChartObject&&window.geneLengthChartObject.destroy();for(var t=document.getElementById(f),a=[],i=[],n=[],l=Array(e.results.length).fill("#337ab7"),o=e.uniqueValues,s=e.results[0].min,r=e.results[0].max,c=parseFloat(e.results[0].average).toFixed(3),u=(r-s)/e.results[0].buckets,d="Distribution of "+o+" Gene Lengths",p="Min: "+s+". Max: "+r+". Avg: "+c+". Stdev: "+parseFloat(e.results[0].stdev).toFixed(3),m=0;m<e.results.length-1;m++){var v=Math.round(s+u*m),h=Math.round(s+u*(m+1));a.push(Math.log2(e.results[m].count)+1),i.push(v+" to "+h),n.push(v+" to "+h+": "+e.results[m].count+" values")}var g={responsive:!0,maintainAspectRatio:!1,scaleBeginAtZero:!0,elements:{center:{text:"90%",color:"#FF6384",fontStyle:"Arial",sidePadding:20}},legend:{display:!1,position:"top",onClick:function(e){e.stopPropagation()}},hover:{mode:"nearest",intersect:!0},title:{display:!0,text:[d,p],position:"bottom"},scales:{xAxes:[{ticks:{beginAtZero:!1,autoSkip:!1,maxRotation:90,minRotation:90}}],yAxes:[{ticks:{beginAtZero:!0,min:0,display:!1}}]},tooltips:{callbacks:{label:function(e,t){return n[e.index]}},custom:function(e){e.opacity||(document.getElementById(f).style.cursor="default")}}};window.geneLengthChartObject=new Chart(t,{type:"bar",data:{labels:i,datasets:[{data:a,backgroundColor:l}]},options:g})})}$(document).ready(function(){initializeStartupConfiguration()});