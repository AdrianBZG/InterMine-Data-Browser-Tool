!function(s){!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.imjs=t()}}(function(){return function o(s,a,u){function h(n,t){if(!a[n]){if(!s[n]){var e="function"==typeof require&&require;if(!t&&e)return e(n,!0);if(c)return c(n,!0);var r=new Error("Cannot find module '"+n+"'");throw r.code="MODULE_NOT_FOUND",r}var i=a[n]={exports:{}};s[n][0].call(i.exports,function(t){var e=s[n][1][t];return h(e||t)},i,i.exports,o,s,a,u)}return a[n].exports}for(var c="function"==typeof require&&require,t=0;t<u.length;t++)h(u[t]);return h}({1:[function(t,e,n){(function(){n.ACCEPT_HEADER={xml:"application/xml",json:"application/json",tsv:"text/tab-separated-values",tab:"text/tab-separated-values",csv:"text/comma-separated-values",fasta:"text/x-fasta",gff3:"text/x-gff3",bed:"text/x-bed",objects:"application/json;type=objects",jsonobjects:"application/json;type=objects",jsontable:"application/json;type=table",jsonrows:"application/json;type=rows",jsoncount:"application/json;type=count",jsonp:"application/javascript",jsonpobjects:"application/javascript;type=objects",jsonptable:"application/javascript;type=table",jsonprows:"application/javascript;type=rows",jsonpcount:"application/javascript;type=count"}}).call(this)},{}],2:[function(i,o,t){(function(r){(function(){var t,e,n;i("./shiv"),o.exports=e=i("./service"),n=e.utils.merge,(t=function(t,e){return r[t]=e})("imjs",e),t("intermine",void 0===s?e:n(s,e))}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./service":11,"./shiv":13}],3:[function(n,t,r){(function(){var h,o,c,t,f,p,d,l,g,y,v,e,m,b,w;c=n("url"),o=n("JSONStream"),g=n("http"),h=n("./constants").ACCEPT_HEADER,t=n("./version").VERSION,e=w=n("./util"),d=e.error,p=e.defer,y=e.merge,e.invoke,r.supports=function(){return!0},b=function(t,r,i){return function(t){var e,n;return null==t.pipe?i(new Error("response is not a stream")):(t.on("error",i),null!=t.statusCode&&200!==t.statusCode?((e=o.parse("error")).pause(),t.pipe(e),i([t.statusCode,e])):((n=o.parse("results.*")).pause(),t.pipe(n),r(n)))}},l=function(t,e,n,r){return"Could not parse response to "+t.type+" "+t.url+': "'+e+'" ('+r+": "+n+")"},f=function(u,h,c){return function(s){var a;return a="",s.on("data",function(t){return a+=t}),s.on("error",c),s.on("end",function(){var t,e,n,r,i,o;if(null!=(null!=s?s.headers:void 0)&&(t=s.headers["content-type"]),"application/json"!==t&&!/json/.test(u.dataType)&&!/json/.test(u.data.format))return(r=a.match(/\[ERROR\] (\d+)([\s\S]*)/))?c(new Error(r[2])):(200<=(o=s.statusCode)&&o<400?h:c)(a);if(""===a&&200===s.statusCode)return h();try{return(n=(i=JSON.parse(a)).error)?c(new Error(n)):h(i)}catch(t){return e=t,400<=s.statusCode?c(new Error(s.statusCode)):c(new Error(l(u,a,e,s.statusCode)))}})}},r.iterReq=function(c,l,f){return function(t,e,n,r,i){var o,s,a,u,h;return null==e&&(e={}),null==n&&(n=function(){}),null==r&&(r=function(){}),null==i&&(i=function(){}),w.isFunction(e)&&(e=(u=[{},e,n,r])[0],n=u[1],r=u[2],i=u[3]),h=y({format:f},e,{query:t.toXML()}),o=function(t){return t.on("data",n),t.on("error",r),t.on("end",i),setTimeout(function(){if(null!=t.resume)return t.resume()},3),t},a=function(t){var e,n;return n=t[0],(e=t[1]).on("data",r),e.on("error",r),e.on("end",i),null!=e.resume&&e.resume(),d(n)},(s=this.makeRequest(c,l,h,null,!0)).then(o,a),s}},m=function(t,e,n){var r;return r=setTimeout(function(){return e("Request timed out.")},t),n.then(function(){return cancelTimeout(r)})},v=function(t){var e,n,r,i,o,s,a,u;if(!t.url)throw new Error("No url provided in "+JSON.stringify(t));if("string"==typeof t.data){if(r=t.data,"GET"===(i=t.type)||"DELETE"===i)throw new Error("Invalid request. "+t.type+" requests must not have bodies")}else r=w.querystring(t.data);if((n=c.parse(t.url,!0)).withCredentials=!1,n.method=t.type||"GET",null!=t.port&&(n.port=t.port),n.headers={Accept:h[t.dataType]},("GET"===(o=n.method)||"DELETE"===o)&&(null!=r?r.length:void 0)?(a=/\?/.test(n.path)?"&":"?",n.path+=a+r,r=null):(n.headers["Content-Type"]=(t.contentType||"application/x-www-form-urlencoded")+"; charset=UTF-8",n.headers["Content-Length"]=r.length),null!=t.headers)for(e in s=t.headers)u=s[e],n.headers[e]=u;return null!=t.auth&&(n.auth=t.auth),[n,r]},r.doReq=function(e,t){var n,r,i,o,s,a,u,h,c,l;i=(o=p()).promise,h=o.resolve,a=o.reject,i.then(null,e.error);try{s=v(e),l=s[0],r=s[1],n=(t?b:f)(e,h,a),(u=g.request(l,n)).on("error",function(t){return a(new Error("Error: "+l.method+" "+e.url+": "+t))}),null!=r&&u.write(r),u.end(),0<(c=e.timeout)&&m(c,a,i)}catch(t){a(t)}return i}}).call(this)},{"./constants":1,"./util":16,"./version":17,JSONStream:20,http:44,url:43}],4:[function(y,t,v){(function(){var r,n,i,e,l,o,s,t,a,u,h,c,f,p={}.hasOwnProperty,d=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1},g=function(t,e){return function(){return t.apply(e,arguments)}};t=y("./util"),h=v,c=t.uniqBy,o=t.difference,l=t.defer,f=t.withCB,u=t.id,a=t.get,s=t.fold,e=t.concatMap,r=function(){var n;function t(t){var e,n;for(e in t)p.call(t,e)&&(n=t[e],this[e]=n)}return t.prototype.getStats=function(t){return null!=t?this.stats[t]:this.stats},n=e(a("matches")),t.prototype.getMatches=function(t){var e;return"MATCH"===t?this.matches[t]:null!=(e=n(this.matches[t]))?e:[]},t.prototype.getMatchIds=function(t){return null!=t?this.getMatches(t).map(a("id")):this.allMatchIds()},t.prototype.goodMatchIds=function(){return this.getMatchIds("MATCH")},t.prototype.allMatchIds=function(){var n;return s((n=this,function(t,e){return t.concat(n.getMatchIds(e))}))(this.goodMatchIds(),["DUPLICATE","WILDCARD","TYPE_CONVERTED","OTHER"])},t}(),i=function(){var s,n,r,a;function t(t){var e,n;for(e in t)p.call(t,e)&&(n=t[e],this[e]=n)}return a=c(u),s=e(u),n=function(n){var r,i;return s(function(){var t,e;for(r in e=[],t=n.identifiers)i=t[r],e.push(i);return e}())},r=function(t,e){return null==e||0<=d.call(n(t),e)},t.prototype.getStats=function(t){switch(t){case"objects":return this.getObjectStats();case"identifiers":return this.getIdentifierStats();default:return{objects:this.getObjectStats(),identifiers:this.getIdentifierStats()}}},t.prototype.getIdentifierStats=function(){var t,e,n;return e=(n=function(r){var i,o;return a(s(function(){var t,e,n;for(n=[],t=0,e=r.length;t<e;t++)o=r[t],n.push(function(){var t;for(i in t=[],null!=o?o.identifiers:void 0)t.push(i);return t}());return n}()))})(this.getMatches("MATCH")),t=n(this.getMatches()),{matches:e.length,all:t.length,issues:o(t,e).length}},t.prototype.getObjectStats=function(){var e;return{matches:this.goodMatchIds().length,all:this.allMatchIds().length,issues:function(){var t;for(u in t=[],this)p.call(this,u)&&(e=this[u],d.call(n(e),"MATCH")<0&&t.push(u));return t}.call(this).length}},t.prototype.getMatches=function(t){var e,n;for(u in n=[],this)p.call(this,u)&&(e=this[u],r(e,t)&&n.push(e));return n},t.prototype.getMatchIds=function(t){var e,n;for(u in n=[],this)p.call(this,u)&&(e=this[u],r(e,t)&&n.push(u));return n},t.prototype.goodMatchIds=function(){return this.getMatchIds("MATCH")},t.prototype.allMatchIds=function(){return this.getMatchIds()},t}(),(n=function(){function t(t,e){this.uid=t,this.service=e,this.del=g(this.del,this),this.fetchResults=g(this.fetchResults,this),this.fetchErrorMessage=g(this.fetchErrorMessage,this),this.fetchStatus=g(this.fetchStatus,this)}return t.prototype.fetchStatus=function(t){return f(t,this.service.get("ids/"+this.uid+"/status").then(a("status")))},t.prototype.fetchErrorMessage=function(t){return f(t,this.service.get("ids/"+this.uid+"/status").then(a("message")))},t.prototype.fetchResults=function(t){var n;return n=this.service.get("ids/"+this.uid+"/result").then(a("results")),this.service.fetchVersion().then(function(e){return n.then(function(t){return 16<=e?new r(t):new i(t)})})},t.prototype.del=function(t){return f(t,this.service.makeRequest("DELETE","ids/"+this.uid))},t.prototype.decay=50,t.prototype.poll=function(t,e,n){var r,i,o,s,a,u,h,c;return o=(s=l()).promise,u=s.resolve,a=s.reject,o.then(t,e),i=null!=n?n:function(){},(h=this.fetchStatus()).then(null,a),r=this.decay,this.decay=Math.min(6e4,1.25*r),h.then((c=this,function(t){switch(i(t),t){case"SUCCESS":return c.fetchResults().then(u,a);case"ERROR":return c.fetchErrorMessage().then(a,a);default:return setTimeout(function(){return c.poll(u,a,i)},r)}})),o},t}()).prototype.wait=n.prototype.poll,n.create=function(e){return function(t){return new n(t,e)}},h.IDResolutionJob=n,h.CategoryResults=r,h.IdResults=i}).call(this)},{"./util":16}],5:[function(r,t,h){(function(){var t,e,c,i,n,l,o,s,f,p,a=function(t,e){return function(){return t.apply(e,arguments)}},u={}.hasOwnProperty,d=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1};f=r("./util"),n=h,s=f.merge,p=f.withCB,c=f.get,l=f.invoke,f.REQUIRES_VERSION,f.set,e=f.dejoin,o=function(t){return"__folder__"===t.substr(0,t.indexOf(":"))},i=function(t){return t.substr(t.indexOf(":")+1)},t=function(){var r;function t(t,e){var n,r;for(n in this.service=e,this._updateTags=a(this._updateTags,this),this.hasTag=a(this.hasTag,this),t)u.call(t,n)&&(r=t[n],this[n]=r);this.dateCreated=null!=this.dateCreated?new Date(this.dateCreated):null,this.folders=this.tags.filter(o).map(i)}return t.prototype.hasTag=function(t){return 0<=d.call(this.tags,t)},t.prototype.query=function(t){return null==t&&(t=["*"]),this.service.query({select:t,from:this.type,where:[[this.type,"IN",this.name]]})},t.prototype.del=function(t){return this.service.makeRequest("DELETE","lists",{name:this.name},t)},r=function(t){return t.tags},t.prototype._updateTags=function(t,e){if(null==t)return this.tags=e.slice(),this.folders=this.tags.filter(o).map(i)},t.prototype.fetchTags=function(t){return p(this._updateTags,t,this.service.makeRequest("GET","list/tags",{name:this.name}).then(r))},t.prototype.addTags=function(t,e){var n;return n={name:this.name,tags:t},p(this._updateTags,e,this.service.makeRequest("POST","list/tags",n).then(r))},t.prototype.removeTags=function(t,e){var n;return n={name:this.name,tags:t},p(this._updateTags,e,this.service.makeRequest("DELETE","list/tags",n).then(r))},t.prototype.contents=function(t){return p(t,this.query().then(e).then(l("records")))},t.prototype.rename=function(t,e){var n,r;return n=this.service.post("lists/rename",{oldname:this.name,newname:t}).then(c("listName")).then((r=this,function(t){return r.name=t})).then(this.service.fetchList),p(e,n)},t.prototype.copy=function(t,e){var n,r,i,o,s,a,u,h;return null==t&&(t={}),null==e&&(e=function(){}),1===arguments.length&&f.isFunction(t)&&(t=(o=[{},t])[0],e=o[1]),"string"==typeof t&&(t={name:t}),r=n=null!=(s=t.name)?s:this.name+"_copy",u=this.tags.concat(null!=(a=t.tags)?a:[]),i=this.query(["id"]),p(e,this.service.fetchLists().then(l("map",c("name"))).then((h=this,function(t){var e;for(e=1;0<=d.call(t,r);)r=n+"-"+e++;return i.then(l("saveAsList",{name:r,tags:u,description:h.description}))})))},t.prototype.enrichment=function(t,e){return this.service.enrichment(s({list:this.name},t),e)},t.prototype.shareWithUser=function(t,e){return p(e,this.service.post("lists/shares",{list:this.name,with:t}))},t.prototype.inviteUserToShare=function(t,e,n){return null==e&&(e=!0),null==n&&(n=function(){}),p(n,this.service.post("lists/invitations",{list:this.name,to:t,notify:!!e}))},t}(),n.List=t}).call(this)},{"./util":16}],6:[function(c,t,l){(function(){var i,e,n,o,s,t,a,r,u=function(t,e){return function(){return t.apply(e,arguments)}},h=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1};o=c("./table").Table,n=c("./path").PathInfo,(r=c("./util")).flatten,s=r.find,r.error,a=r.omap,t=l,i=new o({name:"Object",tags:[],displayName:"Object",attributes:{},references:{},collections:{}}),(e=function(){function t(t){var e,n,r;this.name=t.name,e=t.classes,this.findCommonType=u(this.findCommonType,this),this.findSharedAncestor=u(this.findSharedAncestor,this),this.getAncestorsOf=u(this.getAncestorsOf,this),this.getSubclassesOf=u(this.getSubclassesOf,this),this.getPathInfo=u(this.getPathInfo,this),n=a((r=this,function(t,e){return[t,new o(e,r)]})),this.classes=n(e),this.classes["java.lang.Object"]=i}return t.prototype.getPathInfo=function(t,e){return n.parse(this,t,e)},t.prototype.getSubclassesOf=function(t){var e,n,r,i,o,s;if(null==(r=t&&t.name?t:this.classes[t]))throw new Error(t+" is not a table");for(e in s=[r.name],i=this.classes)n=i[e],o=r.name,0<=h.call(n.parents(),o)&&(s=s.concat(this.getSubclassesOf(n)));return s},t.prototype.getAncestorsOf=function(t){var e,n,r,i;if(null==(e=t&&t.name?t:this.classes[t]))throw new Error(t+" is not a table");return(n=e.parents()).filter((i=this,function(t){return i.classes[t]})).reduce((r=this,function(t,e){return t.concat(r.getAncestorsOf(e))}),n)},t.prototype.findSharedAncestor=function(t,e){var n,r;return null===e||null===t?null:t===e?t:(n=this.getAncestorsOf(t),0<=h.call(n,e)?e:(r=this.getAncestorsOf(e),0<=h.call(r,t)?t:s(n,function(t){return 0<=h.call(r,t)})))},t.prototype.findCommonType=function(t){return null==t&&(t=[]),t.reduce(this.findSharedAncestor)},t}()).prototype.makePath=e.prototype.getPathInfo,e.prototype.findCommonTypeOfMultipleClasses=e.prototype.findCommonType,e.load=function(t){try{return new e(t)}catch(t){throw new Error("Error loading model: "+t)}},e.INTEGRAL_TYPES=["int","Integer","long","Long"],e.FRACTIONAL_TYPES=["double","Double","float","Float"],e.NUMERIC_TYPES=e.INTEGRAL_TYPES.concat(e.FRACTIONAL_TYPES),e.BOOLEAN_TYPES=["boolean","Boolean"],t.Model=e}).call(this)},{"./path":7,"./table":14,"./util":16}],7:[function(v,t,m){(function(){var s,f,p,t,a,u,h,c,e,d,l,g,n,y,r=function(t,e){return function(){return t.apply(e,arguments)}},i=[].slice,o=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1};e=m,n=v("./util"),y=n.withCB,a=n.concatMap,c=n.get,t=n.any,l=n.set,u=n.copy,g=n.success,h=n.error,s={},f={},d=function(t,e,n){var r,i,o;return(null!=t?t.name:void 0)+"|"+(null!=t&&null!=(i=t.service)?i.root:void 0)+"|"+e+":"+function(){var t;for(r in t=[],n)o=n[r],t.push(r+"="+o);return t}()},(p=function(){function n(t){var e,n;this.root=t.root,this.model=t.model,this.descriptors=t.descriptors,this.subclasses=t.subclasses,this.displayName=t.displayName,this.ident=t.ident,this.allDescriptors=r(this.allDescriptors,this),this.getChildNodes=r(this.getChildNodes,this),this.getDisplayName=r(this.getDisplayName,this),this.isa=r(this.isa,this),this.append=r(this.append,this),this.getParent=r(this.getParent,this),this.getEndClass=r(this.getEndClass,this),this.containsCollection=r(this.containsCollection,this),this.isCollection=r(this.isCollection,this),this.isReverseReference=r(this.isReverseReference,this),this.isReference=r(this.isReference,this),this.isClass=r(this.isClass,this),this.isAttribute=r(this.isAttribute,this),this.isRoot=r(this.isRoot,this),n=this.descriptors,this.mid=2<=n.length?i.call(n,0,e=n.length-1):(e=0,[]),this.end=n[e++],null==this.ident&&(this.ident=d(this.model,this,this.subclasses))}return n.prototype.isRoot=function(){return 0===this.descriptors.length},n.prototype.isAttribute=function(){return null!=this.end&&!this.isReference()},n.prototype.isClass=function(){return this.isRoot()||this.isReference()},n.prototype.isReference=function(){var t;return null!=(null!=(t=this.end)?t.referencedType:void 0)},n.prototype.isReverseReference=function(){var t,e,n,r,i;return!!(this.isReference()&&0<this.mid.length)&&(i=(n=this.end).reverseReference,r=n.referencedType,t=(e=this.getParent()).getParent(),null!=r&&t.isa(r)&&e.end.name===i)},n.prototype.isCollection=function(){var t,e;return null!=(t=null!=(e=this.end)?e.isCollection:void 0)&&t},n.prototype.containsCollection=function(){return t(this.descriptors,function(t){return t.isCollection})},n.prototype.getEndClass=function(){var t;return this.model.classes[this.subclasses[this.toString()]||(null!=(t=this.end)?t.referencedType:void 0)]||this.root},n.prototype.getParent=function(){if(this.isRoot())throw new Error("Root paths do not have parents");return new n({root:this.root,model:this.model,descriptors:this.mid.slice(),subclasses:this.subclasses})},n.prototype.append=function(t){var e;if(this.isAttribute())throw new Error(this+" is an attribute.");if(null==(e="string"==typeof t?this.getType().fields[t]:t))throw new Error(t+" is not a field of "+this.getType());return new n({root:this.root,model:this.model,descriptors:this.descriptors.concat([e]),subclasses:this.subclasses})},n.prototype.isa=function(t){var e,n;return null!=t&&(this.isAttribute()?this.getType()===t:(e=t.name?t.name:""+t)===(n=this.getType()).name||0<=o.call(this.model.getAncestorsOf(n),e))},n.prototype.getDisplayName=function(t){var e,n,r,i,o;return(n=this.displayName)?g(n):(null==this.namePromise&&(this.namePromise=(e=s[this.ident])?g(e):this.isRoot()&&this.root.displayName?g(this.root.displayName):null==this.model.service?h("No service"):(i="model"+a(function(t){return"/"+t.name})(this.allDescriptors()),r=l({format:"json"})(u(this.subclasses)),this.model.service.get(i,r).then(c("display")).then((o=this,function(t){var e;return null!=s[e=o.ident]?s[e]:s[e]=t})))),y(t,this.namePromise))},n.prototype.getChildNodes=function(){var t,e,n,r,i;for(e in i=[],r=(null!=(n=this.getEndClass())?n.fields:void 0)||{})t=r[e],i.push(this.append(t));return i},n.prototype.allDescriptors=function(){return[this.root].concat(this.descriptors)},n.prototype.toString=function(){return this.allDescriptors().map(c("name")).join(".")},n.prototype.equals=function(t){return this===t||this.ident&&(null!=t?t.ident:void 0)===this.ident},n.prototype.getType=function(){var t,e;return(null!=(t=this.end)&&null!=(e=t.type)?e.replace(/java\.lang\./,""):void 0)||this.getEndClass()},n}()).prototype.toPathString=p.prototype.toString,p.parse=function(i,o,s){var t,a,e,u,n,h,c,l,r;return null==s&&(s={}),n=d(i,o,s),(t=f[n])?t:(l=(o+"").split("."),r=a=i.classes[l.shift()],h=r.name,e=function(){var t,e,n,r;for(r=[],t=0,e=l.length;t<e;t++){if(c=l[t],!(u=(null!=a?a.fields[c]:void 0)||(null!=(n=a=i.classes[s[h]])?n.fields[c]:void 0)))throw new Error("Could not find "+c+" in "+a+" when parsing "+o);h+="."+c,a=i.classes[u.type||u.referencedType],r.push(u)}return r}(),f[n]=new p({root:r,model:i,descriptors:e,subclasses:s,ident:n}))},p.flushCache=function(){return f={},s={}},e.PathInfo=p}).call(this)},{"./util":16}],8:[function(e,n,t){(function(){var t;t=e("es6-promise").Promise,n.exports=t}).call(this)},{"es6-promise":25}],9:[function(Z,t,tt){(function(){var e,h,t,c,u,l,n,r,i,o,g,y,v,s,m,b,w,E,_,a,f,S,T,O,j,p,R,A,L,d,I,k,C,P,x,N,q,M,U,B,D,F,V,H,Y,z,J,W,X,G=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1},K=function(t,e){return function(){return t.apply(e,arguments)}},Q=[].slice,$={}.hasOwnProperty;for(t=Z("backbone-events-standalone"),(R=tt).xml=Z("./xml"),W=Z("./util"),l=W.REQUIRES_VERSION,X=W.withCB,P=W.merge,_=W.filter,U=W.partition,f=W.fold,m=W.concatMap,j=W.id,S=W.get,W.invoke,Y=W.querystring,T=function(t){var e;if(!(e=null!=(null!=t?t.toLowerCase:void 0)?u.OP_DICT[t.toLowerCase()]:null))throw new Error("Illegal constraint operator: "+t);return e},r=(e=["path","op","code"]).concat(["value","extraValue","loopPath"]),n=["rowByRow","eachRow","recordByRecord","eachRecord","records","rows","table","tableRows","values"],c=function(t){return W.compose(t.fetchList,S("listName"))},h=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],w=function(t){return null==t&&(t=""),t.substr(t.indexOf("."))},s=function(t){return null!=t?"<value>"+W.escape(t)+"</value>":"<nullValue/>"},g=function(e,n){var r,i;return function(){var t;for(r in t=[],e)i=e[r],0<=G.call(n,r)&&t.push(r+'="'+W.escape(i)+'" ');return t}().join("")},M=function(t){return"<constraint "+g(t,e)+"/>"},z=function(t){return"<constraint "+g(t,["path","type"])+"/>"},F=function(t){return"<constraint "+g(t,r)+"/>"},N=function(t){return"<constraint "+g(t,e)+">"+m(s)(t.values)+"</constraint>"},p=function(t){return"<constraint "+g(t,e)+'ids="'+t.ids.join(",")+'"/>'},y=function(t){var e;return null!=t.values?N(t):null!=t.ids?p(t):null==t.op?z(t):(e=t.op,0<=G.call(u.NULL_OPS,e)?M(t):F(t))},O=function(t){return t.replace(/^[^\.]+\./,"")},b=function(t){var e,n,r,i,o,s,a,u,h,c,l,f;return a=t.path,c=t.type,s=t.op,l=t.value,f=t.values,o=t.loopPath,r=t.extraValue,i=t.ids,e=t.code,n=t.editable,h=t.switched,u=t.switchable,i=null!=i?i.slice():void 0,f=null!=f?f.slice():void 0,q({path:a,type:c,op:s,value:l,values:f,extraValue:r,ids:i,code:e,editable:n,switched:h,switchable:u,loopPath:o})},v=function(t){var e;return(e=b(t)).path=O(e.path),e},q=function(t){var e;for(e in t)null==t[e]&&delete t[e];return t},E=function(t,e){return"Did not remove a single constraint. original = "+t+", reduced = "+e},L=function(t,e){var n,r,i,o,s,a;if(n={path:t},null===e)n.op="IS NULL";else if(W.isArray(e))n.op="ONE OF",n.values=e;else if("string"==(o=typeof e)||"number"==o||"boolean"==o)s="function"==typeof e.toUpperCase?e.toUpperCase():void 0,0<=G.call(u.NULL_OPS,s)?n.op=e:(n.op="=",n.value=e);else if(i=function(){var t;for(r in t=[],e)e[r],t.push(r);return t}(),0<=G.call(i,"isa"))W.isArray(e.isa)?(n.op=r,n.values=e.isa):n.type=e.isa;else for(r in 0<=G.call(i,"extraValue")&&(n.extraValue=e.extraValue),e)a=e[r],"extraValue"!==r&&(n.op=r,W.isArray(a)?n.values=a:n.value=a);return n},A=function(t){var e,n,r,i;return n={path:(t=t.slice()).shift()},1===t.length?(r="function"==typeof(e=t[0]).toUpperCase?e.toUpperCase():void 0,0<=G.call(u.NULL_OPS,r)?n.op=e:n.type=e):2<=t.length&&(n.op=t[0],i=t[1],W.isArray(i)?n.values=i:n.value=i,3===t.length&&(n.extraValue=t[2])),n},H=function(r){var i;return function(){var t,e,n;for(n=[],t=0,e=r.length;t<e;t++)i=r[t],n.push(i.path+" "+i.direction);return n}().join(" ")},V=function(t){var e,n,r,i,o,s,a;if(null==t)return[];for(i=t.split(/\s+/),s=[],n=0,r=(o=function(){var t,e,n;for(n=[],a=t=0,e=i.length/2;0<=e?t<e:e<t;a=0<=e?++t:--t)n.push(2*a);return n}()).length;n<r;n++)e=o[n],s.push([i[e],i[e+1]]);return s},D=function(){var r,i;if(i=this.sortOrder,this.sortOrder=function(){var t,e,n;for(n=[],t=0,e=i.length;t<e;t++)r=i[t],this.isRelevant(r.path)&&n.push(r);return n}.call(this),i.length!==this.sortOrder.length)return this.trigger("change:sortorder change:orderby",this.sortOrder.slice())},u=function(){var s,f,p,a,r,t,d,e,u;function o(t,e,n){var r,i,o,s,a,u,h,c,l,f,p,d,g,y,v,m;for(o=(a=null!=n?n:{}).model,m=a.summaryFields,this.addConstraint=K(this.addConstraint,this),this.expandStar=K(this.expandStar,this),this.adjustPath=K(this.adjustPath,this),this.select=K(this.select,this),null==t&&(t={}),this.constraints=[],this.views=[],this.joins={},this.displayNames=W.copy(null!=(c=null!=(l=t.displayNames)?l:t.aliases)?c:{}),r=0,i=(f=["name","title","comment","description","type"]).length;r<i;r++)null!=t[s=f[r]]&&(this[s]=t[s]);this.service=null!=e?e:{},this.model=null!=(p=null!=o?o:t.model)?p:{},this.summaryFields=null!=(d=null!=m?m:t.summaryFields)?d:{},this.root=null!=(g=t.root)?g:t.from,this.maxRows=null!=(y=null!=(v=t.size)?v:t.limit)?y:t.maxRows,this.start=null!=(u=null!=(h=t.start)?h:t.offset)?u:0,this.select(t.views||t.view||t.select||[]),this.addConstraints(t.constraints||t.where||[]),this.addJoins(t.joins||t.join||[]),this.orderBy(t.sortOrder||t.orderBy||[]),null!=t.constraintLogic&&(this.constraintLogic=t.constraintLogic),this.on("change:views",D,this)}return o.JOIN_STYLES=["INNER","OUTER"],o.BIO_FORMATS=["gff3","fasta","bed"],o.NULL_OPS=["IS NULL","IS NOT NULL"],o.ATTRIBUTE_VALUE_OPS=["=","!=",">",">=","<","<=","CONTAINS","LIKE","NOT LIKE"],o.MULTIVALUE_OPS=["ONE OF","NONE OF"],o.RANGE_OPS=["OVERLAPS","DOES NOT OVERLAP","OUTSIDE","WITHIN","CONTAINS","DOES NOT CONTAIN"],o.TERNARY_OPS=["LOOKUP"],o.LOOP_OPS=["=","!="],o.LIST_OPS=["IN","NOT IN"],o.OP_DICT={"=":"=","==":"==",eq:"=",eqq:"==","!=":"!=",ne:"!=",">":">",gt:">",">=":">=",ge:">=","<":"<",lt:"<","<=":"<=",le:"<=",contains:"CONTAINS",CONTAINS:"CONTAINS","does not contain":"DOES NOT CONTAIN","DOES NOT CONTAIN":"DOES NOT CONTAIN",like:"LIKE",LIKE:"LIKE","not like":"NOT LIKE","NOT LIKE":"NOT LIKE",lookup:"LOOKUP","IS NULL":"IS NULL","is null":"IS NULL","IS NOT NULL":"IS NOT NULL","is not null":"IS NOT NULL","ONE OF":"ONE OF","one of":"ONE OF","NONE OF":"NONE OF","none of":"NONE OF",in:"IN","not in":"NOT IN",IN:"IN","NOT IN":"NOT IN",WITHIN:"WITHIN",within:"WITHIN",OVERLAPS:"OVERLAPS",overlaps:"OVERLAPS","DOES NOT OVERLAP":"DOES NOT OVERLAP","does not overlap":"DOES NOT OVERLAP",OUTSIDE:"OUTSIDE",outside:"OUTSIDE",ISA:"ISA",isa:"ISA"},r=["name","view","sortOrder","constraintLogic","title","description","comment"],f=["path","type","op","code","value","ids","loopPath"],d=function(t,e){var n,r,i,o;for(i=[],n=0,r=e.length;n<r;n++)o=e[n],t.hasAttribute(o)&&i.push([o,t.getAttribute(o)]);return i},p=function(t,e){var n,r,i,o,s;for(s=[],r=0,i=(o=t.getElementsByTagName(e)).length;r<i;r++)n=o[r],s.push(n);return s},u=function(e){return function(t){return t.getAttribute(e)}},o.fromXML=function(t){var c,e,i,o,n,l,s;if(e=R.xml.parse(t),!(l=p(e,"query")[0]||p(e,"template")[0]))throw new Error("no query in xml");return o=u("path"),s=u("style"),(n=W.pairsToObj(d(l,r))).view=n.view.split(/\s+/),n.sortOrder=V(n.sortOrder),n.joins=function(){var t,e,n,r;for(r=[],t=0,e=(n=p(l,"join")).length;t<e;t++)i=n[t],"OUTER"===s(i)&&r.push(o(i));return r}(),n.constraints=function(){var t,e,n,r,i,o,s,a,u,h;for(r=[],t=0,e=(n=p(l,"constraint")).length;t<e;t++)c=n[t],r.push((i=c,h=u=a=s=o=void 0,null!=(o=W.pairsToObj(d(i,f))).ids&&(o.ids=function(){var t,e,n,r;for(r=[],e=0,t=(n=o.ids.split(",")).length;e<t;e++)h=n[e],r.push(parseInt(h,10));return r}()),(u=p(i,"value")).length&&(o.values=function(){var t,e,n;for(n=[],e=0,t=u.length;e<t;e++)a=u[e],n.push(function(){var t,e,n,r;for(r=[],e=0,t=(n=a.childNodes).length;e<t;e++)s=n[e],r.push(s.data);return r}().join(""));return n}()),o));return r}(),n},o.prototype.constraints=[],o.prototype.views=[],o.prototype.joins={},o.prototype.constraintLogic="",o.prototype.sortOrder="",o.prototype.name=null,o.prototype.title=null,o.prototype.comment=null,o.prototype.description=null,o.prototype.removeFromSelect=function(o){var r,s,i,a;return null==o&&(o=[]),o=W.stringList(o),r=W.compose(this.expandStar,this.adjustPath),o=W.flatten(function(){var t,e,n;for(n=[],t=0,e=o.length;t<e;t++)i=o[t],n.push(r(i));return n}()),this.sortOrder=function(){var t,e,n,r,i;for(i=[],t=0,e=(n=this.sortOrder).length;t<e;t++)r=(s=n[t]).path,0<=G.call(o,r)||i.push(s);return i}.call(this),this.views=function(){var t,e,n,r;for(r=[],t=0,e=(n=this.views).length;t<e;t++)a=n[t],0<=G.call(o,a)||r.push(a);return r}.call(this),this.trigger("remove:view",o),this.trigger("change:views",this.views),this.trigger("change",this.views)},o.prototype.removeConstraint=function(r,t){var i,o,s,e;if(null==t&&(t=!1),s=this.constraints,o="string"==typeof r?function(t){return t.code===r}:function(t){var e,n;return t.path===r.path&&t.op===r.op&&t.value===r.value&&t.extraValue===r.extraValue&&r.type===t.type&&(null!=(e=t.values)?e.join("%%"):void 0)===(null!=(n=r.values)?n.join("%%"):void 0)},(e=function(){var t,e,n;for(n=[],t=0,e=s.length;t<e;t++)i=s[t],o(i)||n.push(i);return n}()).length!==s.length-1)throw new Error(E(s,e));if(this.constraints=e,!t)return this.trigger("change:constraints"),this.trigger("change"),this.trigger("removed:constraint",W.find(s,o))},o.prototype.addToSelect=function(r,t){var e,i,o,n,s,a,u,h;if(null==r&&(r=[]),null==t&&(t={}),r=W.stringList(r),i=W.compose(this.expandStar,this.adjustPath),a=W.flatten(function(){var t,e,n;for(n=[],t=0,e=r.length;t<e;t++)u=r[t],n.push(i(u));return n}()),(e=function(){var t,e,n;for(n=[],t=0,e=a.length;t<e;t++)o=a[t],0<=G.call(this.views,o)&&n.push(o);return n}.call(this)).length)throw new Error(e+" already in the select list");if((e=function(){var t,e,n;for(n=[],t=0,e=a.length;t<e;t++)o=a[t],1<function(){var t,e,n;for(n=[],e=0,t=a.length;e<t;e++)(h=a[e])===o&&n.push(h);return n}().length&&n.push(o);return n}()).length)throw new Error(e+" specified multiple times as arguments to addToSelect");return(n=this.views).push.apply(n,a),t.silent?t.events=(null!=(s=t.events)?s:[]).concat(["change","add:view","change:views"]):(this.trigger("add:view change:views",a),this.trigger("change")),this},o.prototype.select=function(t,e){var n,r;r=this.views.slice();try{this.views=[],this.addToSelect(t,e)}catch(t){n=t,this.views=r,W.error(n)}return this},o.prototype.adjustPath=function(t){return t=t&&t.name?t.name:""+t,null!=this.root?t.match("^"+this.root)||(t=this.root+"."+t):this.root=t.split(".")[0],t},o.prototype.getPossiblePaths=function(t,u,e){var n,h,r,i,o,c;return null==t&&(t=3),null==u&&(u=!0),null==e&&(e=null),o="string"==typeof e?function(t){return t[e]()}:e,h=function(e,n){var r,i,o,t,s,a;return s=c.getPathInfo(e),!u&&s.isReverseReference()?[]:s.isAttribute()?[s]:(r=s.getType(),a=m(function(t){return h(e+"."+t.name,n-1)}),t=r&&0<n?a(function(){var t,e;for(o in e=[],t=r.fields)i=t[o],e.push(i);return e}()):[],[s].concat(t))},r=t+"-"+u,null==(c=this)._possiblePaths&&(this._possiblePaths={}),i=(null!=(n=this._possiblePaths)[r]?n[r]:n[r]=h(this.root,t)).slice(),null!=o?i.filter(o):i},o.prototype.makePath=o.prototype.getPathInfo=function(t){var e,n,r;return e=this.adjustPath(t),(n=null!=(r=this.model)&&"function"==typeof r.getPathInfo?r.getPathInfo(e,this.getSubclasses()):void 0)&&e in this.displayNames&&(n.displayName=this.displayNames[e]),n},e=function(t){return[t.path,t.type]},t=W.compose(W.pairsToObj,W.map(e),_(S("type"))),o.prototype.getSubclasses=function(){return t(this.constraints)},o.prototype.getType=function(t){return this.getPathInfo(t).getType()},o.prototype.getViewNodes=function(){var i,o,e;return e=this,o=function(t){return e.getPathInfo(t).getParent()},W.uniqBy(String,function(){var t,e,n,r;for(r=[],t=0,e=(n=this.views).length;t<e;t++)i=n[t],r.push(o(i));return r}.call(this))},o.prototype.isInView=function(t){var e,n,r;if(!(e=this.getPathInfo(t)))throw new Error("Invalid path: "+t);return e.isAttribute()?(r=e.toString(),0<=G.call(this.views,r)):(n=e.toString(),W.any(this.getViewNodes(),function(t){return t.toString()===n}))},o.prototype.isConstrained=function(t,e){var n,r,i;if(null==e&&(e=!1),!(n=this.getPathInfo(t)))throw new Error("Invalid path: "+t);return r=function(t){return null!=t.op&&t.path===n.toString()},!n.isAttribute()&&e&&(i=this,r=function(t){return null!=t.op&&(t.path===n.toString()||n.equals(i.getPathInfo(t.path).getParent()))}),W.any(this.constraints,r)},o.prototype.canHaveMultipleValues=function(t){return this.getPathInfo(t).containsCollection()},o.prototype.getQueryNodes=function(){var i,t,o,e;return e=this.getViewNodes(),t=function(){var t,e,n,r;for(r=[],t=0,e=(n=this.constraints).length;t<e;t++)null==(i=n[t]).type&&((o=this.getPathInfo(i.path)).isAttribute()?r.push(o.getParent()):r.push(o));return r}.call(this),W.uniqBy(String,e.concat(t))},o.prototype.isInQuery=function(t){var i,e,n,r,o,s;if(r=this.getPathInfo(t)){for(o=r.toPathString(),e=0,n=(s=this.views.concat(function(){var t,e,n,r;for(r=[],e=0,t=(n=this.constraints).length;e<t;e++)null==(i=n[e]).type&&r.push(i.path);return r}.call(this))).length;e<n;e++)if(0===(t=s[e]).indexOf(o))return!0;return!1}return!0},o.prototype.isRelevant=function(t){var e,n,r;return(n=this.getPathInfo(t)).isAttribute()&&(n=n.getParent()),r=n.toString(),e=this.getViewNodes(),W.any(e,function(t){return t.toPathString()===r})},o.prototype.expandStar=function(t){var e,i,n,o,s,r,a,u;if(/\*$/.test(t))if(a=t.substr(0,t.lastIndexOf(".")),n=function(t){return a+t},i=this.getType(a),/\.\*$/.test(t)){if(i&&this.summaryFields[i.name])return o=W.compose(n,w),function(){var t,e,n,r;for(r=[],t=0,e=(n=this.summaryFields[i.name]).length;t<e;t++)s=n[t],this.hasView(s)||r.push(o(s));return r}.call(this)}else if(/\.\*\*$/.test(t))return u=this.expandStar(a+".*"),e=function(){var t;for(r in t=[],i.attributes)t.push(n("."+r));return t}(),W.uniqBy(j,u.concat(e));return t},o.prototype.isOuterJoin=function(t){return"OUTER"===this.joins[this.adjustPath(t)]},o.prototype.hasView=function(t){var e;return this.views&&(e=this.adjustPath(t),0<=G.call(this.views,e))},o.prototype.count=function(t){if(this.service.count)return this.service.count(this,t);throw new Error("This query has no service with count functionality attached.")},o.prototype.appendToList=function(n,t){var e,r,i,o;return o=(null!=n?n.name:void 0)?(e=n.name,function(t,e){if(null==t)return n.size=e.size}):(e=String(n),null),i={listName:e,query:this.makeListQuery().toXML()},r=c(this.service),X(o,t,this.service.post("query/append/tolist",i).then(r))},o.prototype.selectPreservingImpliedConstraints=function(t){var e,n,r,i,o;for(null==t&&(t=[]),(o=this.clone()).select(t),e=0,n=(i=this.getViewNodes()).length;e<n;e++)r=i[e],this.isOuterJoined(r)||o.isInView(r||o.isConstrained(r))||null==r.getEndClass().fields.id||o.addConstraint([r.append("id"),"IS NOT NULL"]);return o},o.prototype.makeListQuery=function(){var t,e;return 1===(t=this.views.slice()).length&&(null!=(e=t[0])?e.match(/\.id$/):void 0)||(t=["id"]),this.selectPreservingImpliedConstraints(t)},o.prototype.saveAsList=function(t,e){var n,r;return r=this.makeListQuery(),(n=W.copy(t)).listName=n.listName||n.name,n.query=r.toXML(),t.tags&&(n.tags=t.tags.join(";")),X(e,this.service.post("query/tolist",n).then(c(this.service)))},o.prototype.summarise=function(t,e,n){return this.filterSummary(t,"",e,n)},o.prototype.summarize=function(){var t;return t=1<=arguments.length?Q.call(arguments,0):[],this.summarise.apply(this,t)},a=function(t){var e,n,r,i,o,s,a;for(e=null!=(null!=(o=t.results[0])?o.max:void 0),n=0,r=(s=t.results).length;n<r;n++)(i=s[n]).count=parseInt(i.count,10);return a={uniqueValues:t.uniqueValues,filteredCount:t.filteredCount},e&&(a=P(a,t.results[0])),t.stats=a,t},o.prototype.filterSummary=function(t,e,n,r){var i,o,s;return null==r&&(r=function(){}),W.isFunction(n)&&(r=(i=[n,null])[0],n=i[1]),t=this.adjustPath(t),s=this.clone(),G.call(s.views,t)<0&&s.views.push(t),o={query:s.toXML(),summaryPath:t,format:"jsonrows"},n&&(o.size=n),e&&(o.filterTerm=e),X(r,this.service.post("query/results",o).then(a))},o.prototype.clone=function(t){var e,n,r,i;if(null==(e=new o(this,this.service))._callbacks&&(e._callbacks={}),t){for(n in r=this._callbacks)$.call(r,n)&&(i=r[n],e._callbacks[n]=i);e.off("change:views",D,this)}return e},o.prototype.next=function(){var t;return t=this.clone(),this.maxRows&&(t.start=this.start+this.maxRows),t},o.prototype.previous=function(){var t;return t=this.clone(),this.maxRows?t.start=this.start-this.maxRows:t.start=0,t},o.prototype.getSortDirection=function(t){var n,e;if(n=this.adjustPath(t),!this.isInQuery(n)&&!this.isRelevant(n))throw new Error(t+" is not in the query");return null!=(e=W.find(this.sortOrder,function(t){var e;return e=t.path,n===e}))?e.direction:void 0},o.prototype.isOuterJoined=function(t){var e,n;for(e in t=this.adjustPath(t),n=this.joins)if("OUTER"===n[e]&&0===t.indexOf(e))return!0;return!1},o.prototype.getOuterJoin=function(e){var t,n,r;return e=this.adjustPath(e),t=function(){var t;for(n in t=[],this.joins)t.push(n);return t}.call(this).sort(function(t,e){return e.length-t.length}),W.find(t,(r=this,function(t){return"OUTER"===r.joins[t]&&0===e.indexOf(t)}))},o.prototype._parse_sort_order=function(t){var e,n,r,i,o;if(null==t)throw new Error("No input");if("string"==typeof t)o={path:t,direction:"ASC"};else if(W.isArray(t))o={path:r=t[0],direction:e=t[1]};else if(null==t.path){for(n in t)r=(i=[n,t[n]])[0],e=i[1];o={path:r,direction:e}}else o={path:r=t.path,direction:e=t.direction};return o.path=this.adjustPath(o.path),null==o.direction&&(o.direction="ASC"),o.direction=o.direction.toUpperCase(),o},o.prototype.addOrSetSortOrder=function(e){var t;return e=this._parse_sort_order(e),null==(t=this.getSortDirection(e.path))?this.addSortOrder(e):t!==e.direction&&(W.find(this.sortOrder,function(t){return t.path===e.path}).direction=e.direction,this.trigger("change:sortorder",this.sortOrder),this.trigger("change")),this},o.prototype.addSortOrder=function(t,e){var n;if(n=(null!=e?e:{}).silent,this.sortOrder.push(this._parse_sort_order(t)),!n)return this.trigger("add:sortorder",t),this.trigger("change:sortorder",this.sortOrder),this.trigger("change")},o.prototype.orderBy=function(t,e){var n,o,r,i,s,a,u,h;for(null==e&&(e={}),a=this.sortOrder.slice(),this.sortOrder=[],r=0,i=t.length;r<i;r++)s=t[r],this.addSortOrder(this._parse_sort_order(s),{silent:!0});return n=function(){var t,e,n,r,i;for(i=[],e=0,t=(n=this.sortOrder).length;e<t;e++)r=n[e],u=r.path,o=r.direction,i.push({path:u,direction:o});return i}.call(this),this.trigger("set:sortorder",n),H(a)!==this.getSorting()&&(e.silent?e.events=(null!=(h=e.events)?h:[]).concat(["change","change:sortorder"]):(this.trigger("change:sortorder",n),this.trigger("change"))),this},o.prototype.addJoins=function(t){var e,n,r,i,o,s,a;if(W.isArray(t)){for(o=[],r=0,i=t.length;r<i;r++)e=t[r],o.push(this.addJoin(e));return o}for(n in s=[],t)a=t[n],s.push(this.addJoin({path:n,style:a}));return s},o.prototype.addJoin=function(t){return"string"==typeof t&&(t={path:t,style:"OUTER"}),this.setJoinStyle(t.path,t.style)},o.prototype.setJoinStyle=function(t,e){if(null==e&&(e="OUTER"),t=this.adjustPath(t),e=e.toUpperCase(),G.call(o.JOIN_STYLES,e)<0)throw new Error("Invalid join style: "+e);return this.joins[t]!==e&&(this.joins[t]=e,this.trigger("change:joins",{path:t,style:e}),this.trigger("change")),this},o.prototype.addConstraints=function(t,n){var e,r,i,o,s,a,u;if(null==n&&(n="and"),this.__silent__=!0,s=this.constraintLogic,W.isArray(t))for(i=0,o=t.length;i<o;i++)e=t[i],this.addConstraint(e,n);else for(a in u=this,r=function(t,e){return u.addConstraint(L(t,e),n)},t)r(a,t[a]);return this.__silent__=!1,this.trigger("add:constraint"),this.trigger("change:constraints"),s!==this.constraintLogic&&this.trigger("change:logic",this.constraintLogic),this.trigger("change")},o.prototype.addConstraint=function(t,e){var r,n,i,o,s,a,u;if(null==e&&(e="and"),"and"!==e&&"or"!==e)throw new Error("Unknown logical conjunction: "+e);return"OFF"===(t=W.isArray(t)?A(t):b(t)).switched||(t.path=this.adjustPath(t.path),null==t.type&&(t.op=T(t.op)),this.constraints.push(t),i="or"===e||0<(null!=(u=this.constraintLogic)?u.length:void 0),o=this.constraints.length,a=this.constraintLogic,i&&(s=2===o?h[0]+" "+e+" "+h[1]:((n=this.constraintLogic)||(n=function(){var t,e,n;for(n=[],r=t=0,e=o-2;0<=e?t<=e:e<=t;r=0<=e?++t:--t)n.push(h[r]);return n}().join(" and ")),"("+n+") "+e+" "+h[o-1]),this.constraintLogic=s),this.__silent__||(this.trigger("add:constraint",t),this.trigger("change:constraints"),a!==this.constraintLogic&&this.trigger("change:logic",this.constraintLogic),this.trigger("change"))),this},o.prototype.getSorting=function(){return H(this.sortOrder)},o.prototype.getConstraintXML=function(){var i,t;return(t=function(){var t,e,n,r;for(r=[],t=0,e=(n=this.constraints).length;t<e;t++)(null==(i=n[t]).type||this.isInQuery(i.path))&&r.push(i);return r}.call(this)).length?m(y)(m(j)(U(function(t){return null!=t.type})(t))):""},o.prototype.getJoinXML=function(){var n,r;return function(){var t,e;for(n in e=[],t=this.joins)r=t[n],this.isInQuery(n)&&"OUTER"===r&&e.push('<join path="'+n+'" style="OUTER"/>');return e}.call(this).join("")},o.prototype.toXML=function(){var e,n,r;return e={model:this.model.name,view:this.views.join(" "),sortOrder:this.getSorting(),constraintLogic:this.constraintLogic},null!=this.name&&(e.name=this.name),"<query "+function(){var t;for(n in t=[],e)(r=e[n])&&t.push(n+'="'+r+'"');return t}().join(" ")+" >"+this.getJoinXML()+this.getConstraintXML()+"</query>"},o.prototype.toJSON=function(){var i,o,s,a;return q({name:this.name,title:this.title,comment:this.comment,description:this.description,constraintLogic:this.constraintLogic,from:this.root,select:function(){var t,e,n,r;for(r=[],t=0,e=(n=this.views).length;t<e;t++)a=n[t],r.push(O(a));return r}.call(this),orderBy:function(){var t,e,n,r,i;for(i=[],t=0,e=(n=this.sortOrder).length;t<e;t++)r=n[t],s=r.path,o=r.direction,i.push({path:O(s),direction:o});return i}.call(this),joins:function(){var t,e;for(s in e=[],t=this.joins)"OUTER"===t[s]&&e.push(O(s));return e}.call(this),where:function(){var t,e,n,r;for(r=[],t=0,e=(n=this.constraints).length;t<e;t++)i=n[t],r.push(v(i));return r}.call(this)})},o.prototype.fetchCode=function(t,e){var n;return n={query:this.toXML(),lang:t},X(e,this.service.post("query/code",n).then(this.service.VERIFIER).then(S("code")))},o.prototype.setName=function(t){this.name=t},o.prototype.save=function(n,r){return l(this.service,16,(i=this,function(){var t,e;return W.isFunction(n)&&(n=(t=[null,n])[0],r=t[1]),null!=n&&i.setName(n),e={type:"PUT",path:"user/queries",data:i.toXML(),contentType:"application/xml",dataType:"json"},X(r,i.service.authorise(e)).then(function(t){return i.service.doReq(t)}).then(function(t){return t.queries})}));var i},o.prototype.store=function(i,o){return l(this.service,16,(s=this,function(){var t,e,n,r;return W.isFunction(i)&&(i=(e=[null,i])[0],o=e[1]),null!=i&&s.setName(i),r=function(t,e){if(null==t)return s.setName(e)},t=W.compose(S(s.name),S("queries")),n={type:"POST",path:"user/queries",data:s.toXML(),contentType:"application/xml",dataType:"json"},X(o,r,s.service.authorise(n)).then(function(t){return s.service.doReq(t)}).then(t)}));var s},o.prototype.saveAsTemplate=function(n,r){return l(this.service,16,(i=this,function(){var t,e;if(W.isFunction(n)&&(n=(t=[null,n])[0],r=t[1]),null!=n&&i.setName(n),!i.name)throw new Error("Templates must have a name");return e={type:"POST",path:"templates",data:"<template "+g(i,["name","title","comment"])+">"+i.toXML()+"</template>",contentType:"application/xml",dataType:"json"},X(r,i.service.authorise(e).then(function(t){return i.service.doReq(t)}))}));var i},o.prototype.getCodeURI=function(t){var e,n;return n={query:this.toXML(),lang:t,format:"text"},null!=(null!=(e=this.service)?e.token:void 0)&&(n.token=this.service.token),this.service.root+"query/code?"+Y(n)},o.prototype.getExportURI=function(t,e){var n,r;return null==t&&(t="tab"),null==e&&(e={}),0<=G.call(o.BIO_FORMATS,t)?this["get"+t.toUpperCase()+"URI"](e):(r=P(e,{query:this.toXML(),format:t}),null!=(null!=(n=this.service)?n.token:void 0)&&(r.token=this.service.token),this.service.root+"query/results?"+Y(r))},o.prototype.needsAuthentication=function(){return W.any(this.constraints,function(t){var e;return"NOT IN"===(e=t.op)||"IN"===e})},o.prototype.fetchQID=function(t){return X(t,this.service.post("queries",{query:this.toXML()}).then(S("id")))},s=function(t){return t.append("primaryIdentifier").toString()},o.prototype.__bio_req=function(t,i){var o,e;return e=this.makeListQuery(),o=function(e){return W.any(t,function(t){return e.isa(t)})},e.views=W.take(i)(function(){var t,e,n,r;for(r=[],t=0,e=(n=this.getViewNodes()).length;t<e;t++)i=n[t],o(i)&&r.push(s(i));return r}.call(this)),{query:e.toXML(),format:"text"}},o.prototype._fasta_req=function(){return this.__bio_req(["SequenceFeature","Protein"],1)},o.prototype._bed_req=o.prototype._gff3_req=function(){return this.__bio_req(["SequenceFeature"])},o}(),J=f(function(t,e){return t.concat(e)}),u.prototype.toString=u.prototype.toXML,u.ATTRIBUTE_OPS=J([u.ATTRIBUTE_VALUE_OPS,u.MULTIVALUE_OPS,u.NULL_OPS]),u.REFERENCE_OPS=J([u.TERNARY_OPS,u.LOOP_OPS,u.LIST_OPS]),o=function(u,h){return function(i,t){var e,n,r,o,s,a;return null==i&&(i={}),null==t&&(t=function(){}),W.isFunction(i)&&(i=(r=[{},i])[0],t=r[1]),a=this,e=function(t){var e;return(e=a.getPathInfo(t)).isAttribute()?e:e.append("id")},null!=(null!=i?i.view:void 0)&&(i.view=function(){var t,e,n,r;for(r=[],t=0,e=(n=i.view).length;t<e;t++)s=n[t],r.push(this.getPathInfo(s).toString());return r}.call(this)),n=null!=i.export?this.selectPreservingImpliedConstraints(i.export.map(e)):this,o=P(n[u](),i),h.call(n,o,t)}},a=function(n){var t,e,r;return e="_"+n+"_req",r=(t="get"+n.toUpperCase())+"URI",u.prototype[t]=o(e,function(t,e){return X(e,this.service.post("query/results/"+n,t))}),u.prototype[r]=o(e,function(t,e){return null!=this.service.token&&(t.token=this.service.token),this.service.root+"query/results/"+n+"?"+Y(t)})},d=0,I=(B=u.BIO_FORMATS).length;d<I;d++)a(B[d]);for(i=function(i){return function(){var t,e,n,r;if(e=arguments[0],t=2<=arguments.length?Q.call(arguments,1):[],this.service[i])return null==e?e={}:W.isFunction(e)&&(e={},t=function(){var t,e,n;for(n=[],e=0,t=arguments.length;e<t;e++)r=arguments[e],n.push(r);return n}.apply(this,arguments)),e=q(P({start:this.start,size:this.maxRows},e)),(n=this.service)[i].apply(n,[this,e].concat(Q.call(t)));throw new Error("Service does not provide '"+i+"'.")}},C=0,k=n.length;C<k;C++)x=n[C],u.prototype[x]=i(x);t.mixin(u.prototype),u.prototype.emit=u.prototype.trigger,u.prototype.bind=u.prototype.on,R.Query=u}).call(this)},{"./util":16,"./xml":18,"backbone-events-standalone":22}],10:[function(r,t,o){(function(){var i,t,c,n,l,f,e=function(t,e){return function(){return t.apply(e,arguments)}};n=r("querystring"),l=r("./util"),c=r("./http"),f=l.withCB,l.get,c.doReq,c.merge,i="instances",t=function(){function t(){this.fetchMines=e(this.fetchMines,this),this.makePath=e(this.makePath,this)}return t.prototype.getFormat=function(t){return null==t&&(t="json"),t},t.prototype.isEmpty=function(t){return 0===Object.entries(t).length&&t.constructor===Object},t.prototype.isEmptyString=function(t){return!(null!=t?t.trim():void 0)},t.prototype.errorHandler=function(t){var e;return(null!=(e=console.error)?e:console.log)(t)},t.prototype.makePath=function(t,e){return null==t&&(t=""),null==e&&(e={}),"http://registry.intermine.org/service/"+t+(this.isEmpty(e)?"":"?"+n.stringify(e))},t.prototype.makeRequest=function(t,e,n,r,i){var o,s,a,u,h;return null==t&&(t="GET"),null==e&&(e=""),null==n&&(n={}),null==r&&(r={}),null==i&&(i=function(){}),l.isArray(i)&&(i=(u=i)[0],s=u[1]),l.isArray(r)&&(r=l.pairsToObj(r)),null==s&&(s=this.errorHandler),r=l.copy(r),o=this.getFormat(r.format),c.supports(t)||(h=[t,c.getMethod(t)],r.method=h[0],t=h[1]),a={data:r,dataType:o,type:t,url:this.makePath(e,n)},f(i,c.doReq.call(this,a))},t.prototype.fetchMines=function(t,e,n){var r;return null==t&&(t=[]),null==e&&(e=[]),null==n&&(n=function(){}),e.every(function(t){return"dev"===t||"prod"===t||"all"===t})?(r={},t!==[]&&(r.q=t.join(" ")),e!==[]&&(r.mines=e.join(" ")),this.makeRequest("GET",i,r,{},n)):f(n,Promise.reject("Mines field should only contain 'dev', 'prod', or 'all'"))},t.prototype.fetchInstance=function(t,e){var n,r;return null==t&&(t=""),null==e&&(e=function(){}),this.isEmptyString(t)?f(e,Promise.reject("Must provide an id, name or namespace. It should be a non-empty string")):(r=null!=t?t.trim():void 0,n=i+"/"+r,this.makeRequest("GET",n,{},{},e))},t.prototype.fetchNamespace=function(t,e){var n;return null==t&&(t=""),null==e&&(e=function(){}),this.isEmptyString(t)?f(e,Promise.reject("Must provide a URL of an instance. It should be a non-empty string")):(n=null!=t?t.trim():void 0,this.makeRequest("GET","namespace",{url:n},{},e))},t}(),o.Registry=t}).call(this)},{"./http":3,"./util":16,querystring:55}],11:[function(ut,t,ht){(function(){var n,s,a,h,c,l,f,p,d,g,y,v,m,b,r,w,E,t,_,S,T,O,j,e,R,A,L,i,I,k,C,P,x,N,q,M,U,B,D,F,V,H,Y,o,z,u,J,W,X,G,K,Q,$,Z,tt,et,nt,rt,it,ot=function(t,e){return function(){return t.apply(e,arguments)}},st={}.hasOwnProperty,at=[].slice;for(t=ut("./promise"),m=ut("./model").Model,S=ut("./query").Query,y=ut("./lists").List,C=ut("./user").User,e=ut("./registry").Registry,p=ut("./id-resolution-job").IDResolutionJob,rt=ut("./version"),nt=ut("./util"),Y=ut("./http"),et=nt.querystring,it=nt.withCB,X=nt.map,G=nt.merge,V=nt.get,Z=nt.set,z=nt.invoke,tt=nt.success,F=nt.error,j=nt.REQUIRES_VERSION,D=nt.dejoin,P={},s={},T={},v={},L={},q={},"http://",I="templates","lists",c="list/enrichment",U="listswithobject",d={union:"lists/union",intersection:"lists/intersect",difference:"lists/diff"},R="lists/subtract",N="user/whoami",(_="query/results")+"/tablerows",E="user/preferences","user/tokens","ids",r={},o=0,J=(Q=[x="version",O="version/release",a="classkeys",M="widgets","model",A="summaryfields","search",w="path/values"]).length;o<J;o++)r[K=Q[o]]=!0;for(n={},u=0,W=($=[N,E,d,R,U,c,I,"user/tokens"]).length;u<W;u++)n[K=$[u]]=!0;b=function(t,e){return!r[t]&&(!!n[t]||(null==e||!e.needsAuthentication||e.needsAuthentication()))},l=/^https?:\/\//i,f=/service\/?$/i,h=function(t){var e;return(null!=(e=console.error)?e:console.log)(t)},B=function(t,e,n,r,i){var o,s,a,u,h;return a=this.root,u=this.useCache,s=null!=this[t]?this[t]:this[t]=u&&(h=e[a])?tt(h):(o={type:"GET",dataType:"json",data:{format:"json"}},this.doReq(G(o,{url:this.root+n})).then(function(t){return e[a]=t[r]})),it(i,s)},H=function(i){return function(r){return new t(function(t,e){var n;return(n=nt.find(r,function(t){return t.name===i}))?t(n):e('List "'+i+'" not found among: '+r.map(V("name")))})}},g=function(t,e){return null==e&&(e="listName"),nt.compose(t.fetchList,V(e))},k=function(t){var e,n,r,i,o,s;for(null==t&&(t=[]),o=[],n=0,e=(r=nt.isArray(t)?t:[t]).length;n<e;n++)s=r[n],o.push(null!=(i=s.name)?i:s);return o},(i=function(){var r,i,o,u,n;function e(t){var e;if(this.root=t.root,this.token=t.token,this.errorHandler=t.errorHandler,this.DEBUG=t.DEBUG,this.help=t.help,e=t.noCache,this.headers=t.headers,this.connectAs=ot(this.connectAs,this),this.createList=ot(this.createList,this),this.resolveIds=ot(this.resolveIds,this),this.templateQuery=ot(this.templateQuery,this),this.savedQuery=ot(this.savedQuery,this),this.query=ot(this.query,this),this.fetchRelease=ot(this.fetchRelease,this),this.fetchClassKeys=ot(this.fetchClassKeys,this),this.fetchVersion=ot(this.fetchVersion,this),this.fetchSummaryFields=ot(this.fetchSummaryFields,this),this.fetchModel=ot(this.fetchModel,this),this.fetchWidgetMap=ot(this.fetchWidgetMap,this),this.fetchWidgets=ot(this.fetchWidgets,this),this.complement=ot(this.complement,this),this.fetchListsContaining=ot(this.fetchListsContaining,this),this.fetchList=ot(this.fetchList,this),this.findLists=ot(this.findLists,this),this.fetchLists=ot(this.fetchLists,this),this.fetchTemplates=ot(this.fetchTemplates,this),this.tableRows=ot(this.tableRows,this),this.values=ot(this.values,this),this.rows=ot(this.rows,this),this.records=ot(this.records,this),this.table=ot(this.table,this),this.pathValues=ot(this.pathValues,this),this.fetchUser=ot(this.fetchUser,this),this.whoami=ot(this.whoami,this),this.findById=ot(this.findById,this),this.count=ot(this.count,this),this.enrichment=ot(this.enrichment,this),null==this.root)throw new Error("No service root provided. This is required");l.test(this.root)||(this.root="http://"+this.root),f.test(this.root)||(this.root=this.root+"/service/"),this.root=this.root.replace(/ice$/,"ice/"),null==this.headers&&(this.headers=null),null==this.errorHandler&&(this.errorHandler=h),null==this.help&&(this.help="no.help.available@dev.null"),this.useCache=!e,this.getFormat=function(t){return null==t&&(t="json"),t}}return e.prototype.doReq=function(){return arguments[0]=this.attachCustomHeaders(arguments[0]),Y.doReq.apply(this,arguments)},e.prototype.post=function(t,e){return this.makeRequest("POST",t,e)},e.prototype.get=function(t,e){return this.makeRequest("GET",t,e)},e.prototype.makeRequest=function(t,e,n,r,i){var o,s,a,u,h,c,l,f;return null==t&&(t="GET"),null==e&&(e=""),null==n&&(n={}),null==r&&(r=function(){}),null==i&&(i=!1),nt.isArray(r)&&(r=(u=r)[0],s=u[1]),nt.isArray(n)&&(n=nt.pairsToObj(n)),null==s&&(s=this.errorHandler),n=nt.copy(n),o=this.getFormat(n.format),Y.supports(t)||(h=[t,Y.getMethod(t)],n.method=h[0],t=h[1]),a={data:n,dataType:o,success:r,error:s,path:e,type:t},null!=n.auth&&(a.auth=n.auth,delete a.data.auth),null!=n.headers&&(a.headers=nt.copy(n.headers),delete a.data.headers),(l=null!=(c=n.timeout)?c:this.timeout)&&(a.timeout=l,delete n.timeout),this.authorise(a).then((f=this,function(t){return f.doReq(t,i)}))},e.prototype.authorise=function(i){return this.fetchVersion().then((o=this,function(t){var e,n,r;return null==(e=nt.copy(i)).headers&&(e.headers={}),e.url=o.root+e.path,n=[],t<14&&("string"==typeof e.data?n.push(["format",e.dataType]):e.data.format=e.dataType),null!=o.token&&b(i.path,null!=(r=e.data)?r.query:void 0)&&(14<=t?e.headers.Authorization="Token "+o.token:"string"==typeof e.data?n.push(["token",o.token]):e.data.token=o.token),n.length&&(e.url+="?"+et(n)),e}));var o},e.prototype.attachCustomHeaders=function(t){var e;return null!=this.headers?((e=nt.copy(t)).headers=nt.merge(e.headers,this.headers),e):t},e.prototype.enrichment=function(n,r){return j(this,8,(i=this,function(){var t,e;return t={maxp:.05,correction:"Holm-Bonferroni"},e=nt.isArray(n.ids)?G(t,n,{ids:n.ids.join(",")}):G(t,n),it(r,i.get(c,e).then(V("results")))}));var i},e.prototype.search=function(i,o){return null==i&&(i={}),null==o&&(o=function(){}),j(this,9,(s=this,function(){var t,e,n,r;if(nt.isFunction(i)&&(o=(e=[i,{}])[0],i=e[1]),"string"==typeof i)n={q:i};else for(t in n={q:i.q,start:i.start,size:i.size},i)st.call(i,t)&&(r=i[t],"q"!==t&&"start"!==t&&"size"!==t&&(n["facet_"+t]=r));return it(o,s.post("search",n))}));var s},e.prototype.makePath=function(e,n,t){return null==n&&(n={}),null==t&&(t=function(){}),it(t,this.fetchModel().then(function(t){return t.makePath(e,n)}))},e.prototype.count=function(e,t){var n,r,i;return null==t&&(t=function(){}),n=e?null!=e.toPathString?(K=e.isClass()?e.append("id"):e,this.pathValues(K,"count")):null!=e.toXML?(r={query:e,format:"jsoncount"},this.post(_,r).then(V("count"))):"string"==typeof e?this.fetchModel().then((i=this,function(t){try{return i.count(t.makePath(e))}catch(t){return i.query({select:[e]}).then(i.count)}})):this.query(e).then(this.count):F("Not enough arguments"),it(t,n)},e.prototype.findById=function(t,e,n,r){var i,o;return null==n&&(n=["**"]),null==r&&(r=function(){}),nt.isFunction(n)&&(n=(o=[["**"],n])[0],r=o[1]),i=this.query({from:t,select:n,where:{id:e}}).then(D).then(z("records")).then(V(0)),it(r,i)},e.prototype.lookup=function(t,e,n,r){var i,o;return nt.isFunction(n)&&(n=(o=[null,n])[0],r=o[1]),i=this.query({from:t,select:["**"],where:[[t,"LOOKUP",e,n]]}).then(D).then(z("records")),it(r,i)},e.prototype.find=function(t,e,n,r){var i;return nt.isFunction(n)&&(n=(i=[null,n])[0],r=i[1]),it(r,this.lookup(t,e,n).then(function(t){return null==t||0===t.length?F("Nothing found"):1<t.length?F("Multiple items found: "+t.slice(0,3)+"..."):tt(t[0])}))},e.prototype.whoami=function(t){return j(this,9,(e=this,function(){return it(t,e.get(N).then(V("user")).then(function(t){return new C(e,t)}))}));var e},e.prototype.fetchUser=function(){var t;return t=1<=arguments.length?at.call(arguments,0):[],this.whoami.apply(this,t)},u=function(t,e){return{format:t,path:String(e),typeConstraints:JSON.stringify(e.subclasses)}},e.prototype.pathValues=function(i,o,s){return null==o&&(o={}),j(this,6,(a=this,function(){var n,t,e,r;return"string"==typeof o&&(r=o,o={}),nt.isFunction(o)&&(o=(e=[s,o])[0],s=e[1]),"count"!==r&&(r="results"),n="count"===r?"jsoncount":"json",t=function(){var t,e;try{return this.fetchModel().then(z("makePath",i,null!=(t=i.subclasses)?t:o)).then(function(t){return u(n,t)}).then((e=this,function(t){return e.post(w,t)})).then(V(r))}catch(t){return F(t)}}.call(a),it(s,t)}));var a},e.prototype.doPagedRequest=function(t,e,n,r,i){var o,s,a;return null==n&&(n={}),null==i&&(i=function(){}),null!=t.toXML?(nt.isFunction(n)&&(i=(o=[n,{}])[0],n=o[1]),s=G(n,{query:t,format:r}),it(i,this.post(e,s).then(V("results")))):this.query(t).then((a=this,function(t){return a.doPagedRequest(t,e,n,r,i)}))},e.prototype.table=function(t,e,n){return this.doPagedRequest(t,_,e,"jsontable",n)},e.prototype.records=function(t,e,n){return this.doPagedRequest(t,_,e,"jsonobjects",n)},e.prototype.rows=function(t,e,n){return this.doPagedRequest(t,_,e,"json",n)},e.prototype.values=function(t,e,n){var r,i,o;return nt.isFunction(e)&&(n=(r=[e,n])[0],e=r[1]),i=null==t?F("No query term supplied"):null!=t.descriptors||"string"==typeof t?this.pathValues(t,e).then(X(V("value"))):null!=t.toXML?1!==t.views.length?F("Expected one column, got "+t.views.length):this.rows(t,e).then(X(V(0))):this.query(t).then((o=this,function(t){return o.values(t,e)})),it(n,i)},e.prototype.tableRows=function(t,e,n){return this.doPagedRequest(t,"query/results/tablerows",e,"json",n)},e.prototype.fetchTemplates=function(t){return it(t,this.get(I).then(V("templates")))},e.prototype.fetchLists=function(t){return this.findLists("",t)},e.prototype.findLists=function(n,r){return null==n&&(n=""),null==r&&(r=function(){}),this.fetchVersion().then((o=this,function(t){var e;return it(r,n&&t<13?F("Finding lists by name on the server requires version 13. This is only "+t):(e=function(t){var e,n,r,i;for(i=[],r=0,n=t.length;r<n;r++)e=t[r],i.push(new y(e,o));return i},o.get("lists",{name:n}).then(V("lists")).then(e)))}));var o},e.prototype.fetchList=function(e,n){return this.fetchVersion().then((r=this,function(t){return it(n,t<13?r.findLists().then(H(e)):r.findLists(e).then(V(0)))}));var r},e.prototype.fetchListsContaining=function(t,e){var n,o;return n=function(t){var e,n,r,i;for(r=[],n=0,e=t.length;n<e;n++)i=t[n],r.push(new y(i,o));return r},it(e,(o=this).get(U,t).then(V("lists")).then(n))},e.prototype.combineLists=function(t,e,n){var r,i,o,s,a;return i=(o=G({lists:[],tags:[]},e)).name,r=o.lists,a=o.tags,null==(s={name:i,description:o.description}).description&&(s.description=t+" of "+r.join(", ")),s.tags=a.join(";"),s.lists=r.join(";"),it(n,this.get(d[t],s).then(g(this)))},e.prototype.merge=function(){return this.combineLists.apply(this,["union"].concat(at.call(arguments)))},e.prototype.intersect=function(){return this.combineLists.apply(this,["intersection"].concat(at.call(arguments)))},e.prototype.diff=function(){return this.combineLists.apply(this,["difference"].concat(at.call(arguments)))},e.prototype.complement=function(t,e){var n,r,i,o,s,a,u,h,c;return null==t&&(t={}),null==e&&(e=function(){}),o=t.from,i=t.exclude,a=t.name,r=t.description,c=t.tags,n=function(){return"Relative complement of "+s.join(" and ")+" in "+u.join(" and ")},u=k(o),s=k(i),null==a&&(a=n()),null==r&&(r=n()),null==c&&(c=[]),h={name:a,description:r,tags:c,lists:s,references:u},it(e,this.post(R,h).then(g(this)))},e.prototype.fetchWidgets=function(t){return j(this,8,(e=this,function(){return B.call(e,"widgets",q,M,"widgets",t)}));var e},n=nt.omap(function(t){return[t.name,t]}),e.prototype.fetchWidgetMap=function(t){return j(this,8,(e=this,function(){return it(t,null!=e.__wmap__?e.__wmap__:e.__wmap__=e.fetchWidgets().then(n))}));var e},e.prototype.fetchModel=function(t){var e;return e=B.call(this,"model",v,"model","model").then(m.load).then(Z({service:this})),it(t,e)},e.prototype.fetchSummaryFields=function(t){return B.call(this,"summaryFields",L,A,"classes",t)},e.prototype.fetchVersion=function(t){return B.call(this,"version",P,x,"version",t)},e.prototype.fetchClassKeys=function(t){return B.call(this,"classkeys",s,a,"classes",t)},e.prototype.fetchRelease=function(t){return B.call(this,"release",T,O,"version",t)},e.prototype.query=function(r,t){var e,i;return i=this,e=function(t){var e,n;return e=t[0],n=t[1],new S(r,i,{model:e,summaryFields:n})},it(t,nt.parallel(this.fetchModel(),this.fetchSummaryFields()).then(e))},o=function(e,n){return function(t){return t?e.query(t):F("No query found called "+n)}},r=function(t){return t?"string"==typeof t?tt():F("Name must be a string"):F("Name not provided")},e.prototype.savedQuery=function(e,t){return j(this,16,(n=this,function(){return r(e).then(function(){return it(t,n.get("user/queries",{filter:e}).then(function(t){return t.queries[e]}).then(o(n,e)))})}));var n},e.prototype.templateQuery=function(t,e){return r(t).then((n=this,function(){return it(e,n.fetchTemplates().then(V(t)).then(Z("type","TEMPLATE")).then(o(n,t)))}));var n},e.prototype.manageUserPreferences=function(t,e,n){return j(this,11,(r=this,function(){return it(n,r.makeRequest(t,E,e).then(V("preferences")))}));var r},e.prototype.resolveIds=function(e,n){return j(this,10,(r=this,function(){var t;return t={type:"POST",url:r.root+"ids",contentType:"application/json",data:JSON.stringify(e),dataType:"json"},it(n,r.doReq(t).then(V("uid")).then(p.create(r)))}));var r},e.prototype.resolutionJob=function(t){return p.create(this)(t)},e.prototype.createList=function(e,t,n){var r,i,o;return null==e&&(e={}),null==t&&(t=""),null==n&&(n=function(){}),o=this,r=function(t){return G(t,{token:o.token,tags:e.tags||[]})},i={data:nt.isArray(t)?t.map(function(t){return'"'+t+'"'}).join("\n"):t,dataType:"json",url:this.root+"lists?"+et(r(e)),type:"POST",contentType:"text/plain"},it(n,this.doReq(i).then(g(this)))},i=function(t){return t.user.temporaryToken},e.prototype.connectAs=function(t){return e.connect(G(this,{token:t,noCache:!this.useCache}))},e.prototype.register=function(t,e,n){return j(this,9,(r=this,function(){return it(n,r.post("users",{name:t,password:e}).then(i).then(r.connectAs))}));var r},300,e.prototype.getDeregistrationToken=function(e,n){return null==e&&(e=300),j(this,16,(r=this,function(){var t;return t=null!=r.token?r.post("user/deregistration",{validity:e}).then(V("token")):F("Not registered"),it(n,t)}));var r},e.prototype.deregister=function(t,e){return j(this,16,(n=this,function(){return it(e,n.makeRequest("DELETE","user",{deregistrationToken:t,format:"xml"}))}));var n},e.prototype.login=function(t,n,r){return j(this,9,(i=this,function(){var e;return e=t+":"+n,it(r,i.logout().then(function(t){return t.get("user/token",{auth:e})})).then(V("token")).then(i.connectAs)}));var i},e.prototype.logout=function(t){return it(t,tt(this.connectAs()))},e}()).prototype.rowByRow=function(){var e,t,n,r;return n=arguments[0],e=2<=arguments.length?at.call(arguments,1):[],t=Y.iterReq("POST",_,"json"),null!=n.toXML?t.apply(this,arguments):this.query(n).then((r=this,function(t){return r.rowByRow.apply(r,[t].concat(at.call(e)))}))},i.prototype.eachRow=i.prototype.rowByRow,i.prototype.recordByRecord=function(){var e,t,n,r;return n=arguments[0],e=2<=arguments.length?at.call(arguments,1):[],t=Y.iterReq("POST",_,"jsonobjects"),null!=n.toXML?t.apply(this,arguments):this.query(n).then((r=this,function(t){return r.recordByRecord.apply(r,[t].concat(at.call(e)))}))},i.prototype.eachRecord=i.prototype.recordByRecord,i.prototype.union=i.prototype.merge,i.prototype.difference=i.prototype.diff,i.prototype.symmetricDifference=i.prototype.diff,i.prototype.relativeComplement=i.prototype.complement,i.prototype.subtract=i.prototype.complement,i.flushCaches=function(){return v={},P={},T={},s={},L={},q={}},i.connect=function(t){if(null==(null!=t?t.root:void 0))throw new Error("Invalid options provided: "+JSON.stringify(t));return new i(t)},ht.Service=i,ht.Model=m,ht.Query=S,ht.Registry=e,ht.utils=nt,ht.VERSION=rt.VERSION,ht.imjs=rt}).call(this)},{"./http":3,"./id-resolution-job":4,"./lists":5,"./model":6,"./promise":8,"./query":9,"./registry":10,"./user":15,"./util":16,"./version":17}],12:[function(t,e,n){(function(t){(function(){n.DOMParser=null!=t.DOMParser?t.DOMParser:function(){throw new Error("DOMParser is not available")}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],13:[function(t,e,n){(function(){var t,e,s,n,a,u,r,i,o,h;if(t="undefined"!=typeof console,e="undefined"!=typeof JSON,s=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],e||((h=document.createElement("script")).src="http://cdn.intermine.org/js/json3/3.2.2/json3.min.js",h.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(h)),null==Object.keys&&(u=Object.prototype.hasOwnProperty,a=!{toString:null}.propertyIsEnumerable("toString"),Object.keys=function(e){var t,n,r,i,o;if("object"!=typeof e&&""!=typeof e||null===e)throw new TypeError("Object.keys called on a non-object");if(n=function(){var t;for(i in t=[],e)u.call(e,i)&&t.push(i);return t}(),a)for(t=0,r=s.length;t<r;t++)o=s[t],u.call(e,o)&&n.push(o);return n}),null==Array.prototype.map&&(Array.prototype.map=function(t){var e,n,r,i;for(r=[],e=0,n=this.length;e<n;e++)i=this[e],r.push(t(i));return r}),null==Array.prototype.filter&&(Array.prototype.filter=function(t){var e,n,r,i;for(r=[],e=0,n=this.length;e<n;e++)t(i=this[e])&&r.push(i);return r}),null==Array.prototype.reduce&&(Array.prototype.reduce=function(t,e){var n,r,i,o;for(o=this.slice(),i=arguments.length<2?o.pop():e,n=0,r=o.length;n<r;n++)i=t(i,o[n]);return i}),null==Array.prototype.forEach&&(Array.prototype.forEach=function(t,e){var n,r,i,o,s;if(!t)throw new Error("No function provided");for(o=[],n=r=0,i=this.length;r<i;n=++r)s=this[n],o.push(t.call(null!=e?e:this,s,n,this));return o}),t||(this.console={log:function(){},error:function(){},debug:function(){}},"undefined"!=typeof window&&null!==window&&(window.console=this.console)),null==console.log&&(console.log=function(){}),null==console.error&&(console.error=function(){}),null==console.debug&&(console.debug=function(){}),null==console.log.apply)for(console.log("Your console needs patching."),n=function(t){var e;return e=console[t],console[t]=function(t){return e(t)}},r=0,i=(o=["log","error","debug"]).length;r<i;r++)n(o[r])}).call(this)},{}],14:[function(t,e,n){(function(){var e,u,h;u=function(t,e){var n,r,i;for(n in r=[],t)i=t[n],r.push(e[n]=i);return r},e=t("./promise"),h=["attributes","references","collections"],n.Table=function(){function t(t,e){var n,r,i,o,s,a;for(this.model=e,this.getDisplayName=function(t,e){return function(){return t.apply(e,arguments)}}(this.getDisplayName,this),this.name=t.name,this.tags=t.tags,this.displayName=t.displayName,this.attributes=t.attributes,this.references=t.references,this.collections=t.collections,this.fields={},this.__parents__=null!=(s=t.extends)?s:[],r=0,i=h.length;r<i;r++){if(null==this[o=h[r]])throw new Error("Bad model data: missing "+o);u(this[o],this.fields)}for(n in a=this.collections)a[n].isCollection=!0}return t.prototype.toString=function(){var n;return"[Table name="+this.name+", fields=["+function(){var t,e;for(n in e=[],t=this.fields)t[n],e.push(n);return e}.call(this)+"]]"},t.prototype.parents=function(){var t;return(null!=(t=this.__parents__)?t:[]).slice()},t.prototype.getDisplayName=function(){return new e((n=this,function(t,e){return null!=n.model?t(n.model.makePath(n.name).getDisplayName()):e(new Error("model not set - cannot make path"))}));var n},t}()}).call(this)},{"./promise":8}],15:[function(e,t,i){(function(){var o,n,s,a,u,t,h,r=function(t,e){return function(){return t.apply(e,arguments)}};t=e("./util"),h=t.withCB,a=t.get,u=t.isFunction,o=t.any,s=t.error,n=function(e,t,n,r){return e.service.manageUserPreferences(n,t,r).then(function(t){return e.preferences=t})},i.User=function(){function t(t,e){this.service=t,this.username=e.username,this.preferences=e.preferences,this.refresh=r(this.refresh,this),this.clearPreferences=r(this.clearPreferences,this),this.clearPreference=r(this.clearPreference,this),this.setPreferences=r(this.setPreferences,this),this.setPreference=r(this.setPreference,this),this.hasPreferences=null!=this.preferences,null==this.preferences&&(this.preferences={})}return t.prototype.setPreference=function(t,e,n){var r,i;if(u(e)&&(e=(i=[null,e])[0],n=i[1]),"string"==typeof t)(r={})[t]=e;else{if(null!=e)return h(n,s("Incorrect arguments to setPreference"));r=t}return this.setPreferences(r,n)},t.prototype.setPreferences=function(t,e){return n(this,t,"POST",e)},t.prototype.clearPreference=function(t,e){return n(this,{key:t},"DELETE",e)},t.prototype.clearPreferences=function(t){return n(this,{},"DELETE",t)},t.prototype.refresh=function(t){return n(this,{},"GET",t)},t.prototype.createToken=function(t,e,n){var r,i;return null==t&&(t="day"),null==n&&o([t,e],u)&&(u(t)?(t=(r=[null,null,t])[0],e=r[1],n=r[2]):u(e)&&(e=(i=[null,e])[0],n=i[1])),h(n,this.service.post("user/tokens",{type:t,message:e}).then(a("token")))},t.prototype.fetchCurrentTokens=function(t){return h(t,this.service.get("user/tokens").then(a("tokens")))},t.prototype.revokeAllTokens=function(t){return h(t,this.service.makeRequest("DELETE","user/tokens"))},t.prototype.revokeToken=function(t,e){return h(e,this.service.makeRequest("DELETE","user/tokens/"+t))},t}()}).call(this)},{"./util":16}],16:[function(S,t,T){(function(){var e,r,n,u,o,a,i,h,c,s,l,f,p,d,g,y,t,v,m,b,w=[].slice,E=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1},_={}.hasOwnProperty;e=S("./promise"),(v=T).defer=function(){var n;return(n={}).promise=new e(function(t,e){return n.resolve=t,n.reject=e}),n},o=function(t){return encodeURIComponent(String(t))},y=function(r){var i;return function(){var t,e,n;for(n=[],t=0,e=r.length;t<e;t++)i=r[t],n.push(i.map(o).join("="));return n}().join("&")},v.querystring=function(t){var r,i,o,e,s,a;if(!t)return"";if(p(t))o=t.slice();else for(r in o=[],t)a=t[r],p(a)?(e=function(){var t,e,n;for(n=[],t=0,e=a.length;t<e;t++)s=a[t],n.push([r,s]);return n}(),o=o.concat(e)):o.push([r,a]);return y(function(){var t,e,n;for(n=[],t=0,e=o.length;t<e;t++)null!=(i=o[t])[1]&&n.push(i);return n}())},v.curry=u=function(){var e,n;return n=arguments[0],e=2<=arguments.length?w.call(arguments,1):[],function(){var t;return t=1<=arguments.length?w.call(arguments,0):[],n.apply(null,e.concat(t))}},v.error=i=function(n){return new e(function(t,e){return e(new Error(n))})},v.success=m=function(n){return new e(function(t,e){return t(n)})},v.parallel=function(){var t;return 1===(t=1<=arguments.length?w.call(arguments,0):[]).length&&!t[0].then&&t[0].length?e.all(t[0]):e.all(t)},v.withCB=function(){var t,e,n,r,i,o,s,a;for(e=2<=arguments.length?w.call(arguments,0,n=arguments.length-1):(n=0,[]),a=arguments[n++],r=0,i=e.length;r<i;r++)null!=(t=e[r])&&(s=u(t,null),o=t,a.then(s,o));return a},v.fold=c=function(o){return function(t,e){var n,r,i;if(1===arguments.length&&(t=(null!=(e=(null!=t?t.slice():void 0)||t)?e.shift():void 0)||{}),null==e)throw new Error("xs is null");if(null!=e.reduce)return e.reduce(o,t);for(n in r=t,e)i=e[n],r=null!=r?o(r,n,i):{k:i};return r}},v.take=function(e){return function(t){return null!=e?t.slice(0,+(e-1)+1||9e9):t.slice()}},v.filter=function(o){return function(t){var e,n,r,i;for(r=[],e=0,n=t.length;e<n;e++)i=t[e],o(i)&&r.push(i);return r}},v.uniqBy=function(t,e){var n,r,i,o,s,a;if(1===arguments.length)return u(v.uniqBy,t);if(i=[],s=[],null==e)return s;for(n=0,o=e.length;n<o;n++)r=t(a=e[n]),E.call(i,r)<0&&(i.push(r),s.push(a));return s},v.find=function(t,e){var n,r,i;if(1===arguments.length)return e=t,function(t){return v.find(t,e)};for(n=0,r=t.length;n<r;n++)if(i=t[n],e(i))return i;return null},p=null!=(t=Array.isArray)?t:function(t){return null!=(null!=t?t.splice:void 0)&&null!=(null!=t?t.push:void 0)&&null!=(null!=t?t.pop:void 0)&&null!=(null!=t?t.slice:void 0)},v.isArray=p,v.isFunction="function"!=typeof/./?function(t){return"function"==typeof t}:function(t){return null!=t&&null!=t.call&&null!=t.apply&&"[object Function]"===t.toString()},a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"},v.escape=function(t){var e,n,r,i,o,s;if(null==t)return"";for(o=[],n=r=0,i=(s=String(t).replace(/[&<>"']/g,function(t){return a[t]})).length;0<=i?r<=i:i<=r;n=0<=i?++r:--r)256<(e=s.charCodeAt(n))?o.push("&#"+e+";"):o.push(s.charAt(n));return o.join("")},v.omap=function(s){var e;return e=c(function(t,e,n){var r,i,o;return r=(o=s(e,n))[0],i=o[1],p(i)&&(i=i.slice()),t[r]=i,t}),function(t){return e({},t)}},v.copy=v.omap(function(t,e){return[t,e]}),v.partition=function(i){return function(t){return c(function(t,e){var n,r;return r=t[0],n=t[1],i(e)?[r.concat([e]),n]:[r,n.concat([e])]})([[],[]],t)}},v.merge=function(t,e){return extend(extend({},t),e)},v.extend=function(t,e){var n,r,i;for(n in r=[],e)i=e[n],r.push(t[n]=i);return r},v.id=s=function(t){return t},v.concatMap=function(s){return function(t){var e,n,r,i,o;for(i=void 0,n=0,r=t.length;n<r;n++)o=t[n],e=s(o),i=void 0===i?e:"number"==typeof i?i+e:null!=i.concat?i.concat(e):d(i,e);return i}},v.map=function(t){return l("map",t)},n=c(function(e,n){return function(){var t;return t=1<=arguments.length?w.call(arguments,0):[],e(n.apply(null,t))}}),v.compose=function(){var t;return t=1<=arguments.length?w.call(arguments,0):[],n(t)},v.flatMap=v.concatMap,v.difference=function(t,e){var n,r,i,o;for(i=[],n=0,r=t.length;n<r;n++)o=t[n],E.call(e,o)<0&&i.push(o);return i},v.stringList=function(t){return"string"==typeof t?[t]:t},v.flatten=h=function(){var t,e,n,r,i,o,s,a,u;for(o=[],t=0,n=(a=1<=arguments.length?w.call(arguments,0):[]).length;t<n;t++)if(s=a[t],p(s))for(e=0,r=(i=h.apply(null,s)).length;e<r;e++)u=i[e],o.push(u);else o.push(s);return o},v.sum=v.concatMap(s),v.merge=d=function(){var t,e,n,r,i,o,s;for(r={},t=0,n=(o=1<=arguments.length?w.call(arguments,0):[]).length;t<n;t++)for(e in i=o[t])_.call(i,e)&&(s=i[e],r[e]=s);return r},v.any=function(t,e){var n,r;for(null==e&&(e=s),n=0,r=t.length;n<r;n++)if(e(t[n]))return!0;return!1},v.invoke=l=function(){var t,e;return e=arguments[0],t=2<=arguments.length?w.call(arguments,1):[],f(e,t)},v.invokeWith=f=function(e,n,r){return null==n&&(n=[]),null==r&&(r=null),function(t){if(null==t)throw new Error('Cannot call method "'+e+'" of null');if(t[e])return t[e].apply(r||t,n);throw new Error('Cannot call undefined method "'+e+" of "+t)}},v.get=function(e){return function(t){return t[e]}},v.set=function(r,i){return function(t){var e,n;if(2===arguments.length)t[r]=i;else for(e in r)_.call(r,e)&&(n=r[e],t[e]=n);return t}},r=function(t,e){return"This service requires a service at version "+t+" or above. This one is at "+e},v.REQUIRES_VERSION=function(t,e,n){return t.fetchVersion().then(function(t){return e<=t?n():i(r(e,t))})},v.dejoin=function(t){var e,n,r,i;for(e=0,n=(i=t.views).length;e<n;e++)2<(r=i[e].split(".")).length&&t.addJoin(r.slice(1,-1).join("."));return t},b=c(function(t,e){return t.then(e)}),v.sequence=function(){var t;return t=1<=arguments.length?w.call(arguments,0):[],b(m(),t)},g=c(function(t,e){var n,r;if(n=e[0],r=e[1],null!=t[n])throw new Error("Duplicate key: "+n);return t[n]=r,t}),v.pairsToObj=function(t){return g({},t)}}).call(this)},{"./promise":8}],17:[function(t,e,n){(function(){n.VERSION="3.18.1"}).call(this)},{}],18:[function(t,e,i){(function(){var n,r;n=t("xmldom").DOMParser,r=function(t){return 0===(t=(t=t.replace(/^\s*/g,"")).replace(/\s$/g,"")).length?t:">"!==t[t.length-1]?t+">":t},i.parse=function(t){var e;if("string"!=typeof t)throw new Error("Expected a string - got "+t);if(!(t=r(t)))throw new Error("Expected content - got empty string");if(!(e=function(){try{return(new n).parseFromString(t,"text/xml")}catch(t){}}())||!e.documentElement||e.getElementsByTagName("parsererror").length)throw new Error("Invalid XML: "+t);return e}}).call(this)},{xmldom:12}],19:[function(t,e,n){!function(){var t=void 0!==n?n:this,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function a(t){this.message=t}(a.prototype=new Error).name="InvalidCharacterError",t.btoa||(t.btoa=function(t){for(var e,n,r=0,i=s,o="";t.charAt(0|r)||(i="=",r%1);o+=i.charAt(63&e>>8-r%1*8)){if(255<(n=t.charCodeAt(r+=.75)))throw new a("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");e=e<<8|n}return o}),t.atob||(t.atob=function(t){if((t=t.replace(/=+$/,"")).length%4==1)throw new a("'atob' failed: The string to be decoded is not correctly encoded.");for(var e,n,r=0,i=0,o="";n=t.charAt(i++);~n&&(e=r%4?64*e+n:n,r++%4)?o+=String.fromCharCode(255&e>>(-2*r&6)):0)n=s.indexOf(n);return o})}()},{}],20:[function(n,t,r){(function(e){"use strict";var t=n("jsonparse"),u=n("through"),i=e.from&&e.from!==Uint8Array.from;function y(t,e){return"string"==typeof t?e==t:t&&"function"==typeof t.exec?t.exec(e):"boolean"==typeof t||"object"==typeof t?t:"function"==typeof t&&t(e)}r.parse=function(l,f){var p,n,r=new t,d=u(function(t){"string"==typeof t&&(t=i?e.from(t):new e(t)),r.write(t)},function(t){t&&d.write(t),p&&d.emit("header",p),n&&d.emit("footer",n),d.queue(null)});"string"==typeof l&&(l=l.split(".").map(function(t){return"$*"===t?{emitKey:!0}:"*"===t||(""===t?{recurse:!0}:t)}));return l&&l.length||(l=null),r.onValue=function(t){if(this.root||(d.root=t),l){for(var e=0,n=0,r=!1,i=!1;e<l.length;){var o,s=l[e];if(n++,s&&!s.recurse){if(!(o=n===this.stack.length?this:this.stack[n]))return;if(!y(s,o.key))return void g(o.key,t);r=!!s.emitKey,i=!!s.emitPath,e++}else{var a=l[++e];if(!a)return;for(;;){if(!(o=n===this.stack.length?this:this.stack[n]))return;if(y(a,o.key)){e++,Object.isFrozen(this.stack[n])||(this.stack[n].value=null);break}g(o.key,t),n++}}}if(p&&(d.emit("header",p),p=!1),n===this.stack.length){0;var u=this.stack.slice(1).map(function(t){return t.key}).concat([this.key]),h=t;for(var c in null!=h&&null!=(h=f?f(h,u):h)&&((r||i)&&(h={value:h},r&&(h.key=this.key),i&&(h.path=u)),d.queue(h)),this.value&&delete this.value[this.key],this.stack)Object.isFrozen(this.stack[c])||(this.stack[c].value=null)}}},r._onToken=r.onToken,r.onToken=function(t,e){r._onToken(t,e),0===this.stack.length&&d.root&&(l||d.queue(d.root),0,d.root=null)},r.onError=function(t){-1<t.message.indexOf("at position")&&(t.message="Invalid JSON ("+t.message+")"),d.emit("error",t)},d;function g(t,e){!1!==p&&((p=p||{})[t]=e),!1!==n&&!1===p&&((n=n||{})[t]=e)}},r.stringify=function(n,r,e,i){i=i||0,!1===n?(r="\n",e=n=""):null==n&&(n="[\n",r="\n,\n",e="\n]\n");var o,s=!0,a=!1;return o=u(function(t){a=!0;try{var e=JSON.stringify(t,null,i)}catch(t){return o.emit("error",t)}s?(s=!1,o.queue(n+e)):o.queue(r+e)},function(t){a||o.queue(n),o.queue(e),o.queue(null)})},r.stringifyObject=function(n,r,e,i){i=i||0,!1===n?(r="\n",e=n=""):null==n&&(n="{\n",r="\n,\n",e="\n}\n");var o=!0,s=!1;return u(function(t){s=!0;var e=JSON.stringify(t[0])+":"+JSON.stringify(t[1],null,i);o?(o=!1,this.queue(n+e)):this.queue(r+e)},function(t){s||this.queue(n),this.queue(e),this.queue(null)})}}).call(this,n("buffer").Buffer)},{buffer:27,jsonparse:51,through:56}],21:[function(t,a,h){!function(){var s=Array.prototype.forEach,n=Object.prototype.hasOwnProperty,i=Array.prototype.slice,r=0;var e,l={keys:Object.keys||function(t){if("object"!=typeof t&&"function"!=typeof t||null===t)throw new TypeError("keys() called on a non-object");var e,n=[];for(e in t)t.hasOwnProperty(e)&&(n[n.length]=e);return n},uniqueId:function(t){var e=++r+"";return t?t+e:e},has:function(t,e){return n.call(t,e)},each:function(t,e,n){if(null!=t)if(s&&t.forEach===s)t.forEach(e,n);else if(t.length===+t.length)for(var r=0,i=t.length;r<i;r++)e.call(n,t[r],r,t);else for(var o in t)this.has(t,o)&&e.call(n,t[o],o,t)},once:function(t){var e,n=!1;return function(){return n||(n=!0,e=t.apply(this,arguments),t=null),e}}};e={on:function(t,e,n){return f(this,"on",t,[e,n])&&e&&(this._events||(this._events={}),(this._events[t]||(this._events[t]=[])).push({callback:e,context:n,ctx:n||this})),this},once:function(t,e,n){if(!f(this,"once",t,[e,n])||!e)return this;var r=this,i=l.once(function(){r.off(t,i),e.apply(this,arguments)});return i._callback=e,this.on(t,i,n)},off:function(t,e,n){var r,i,o,s,a,u,h,c;if(!this._events||!f(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._events={},this;for(a=0,u=(s=t?[t]:l.keys(this._events)).length;a<u;a++)if(t=s[a],o=this._events[t]){if(this._events[t]=r=[],e||n)for(h=0,c=o.length;h<c;h++)i=o[h],(e&&e!==i.callback&&e!==i.callback._callback||n&&n!==i.context)&&r.push(i);r.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=i.call(arguments,1);if(!f(this,"trigger",t,e))return this;var n=this._events[t],r=this._events.all;return n&&o(n,e),r&&o(r,arguments),this},stopListening:function(t,e,n){var r=this._listeners;if(!r)return this;var i=!e&&!n;for(var o in"object"==typeof e&&(n=this),t&&((r={})[t._listenerId]=t),r)r[o].off(e,n,this),i&&delete this._listeners[o];return this}};var u=/\s+/,f=function(t,e,n,r){if(!n)return!0;if("object"==typeof n){for(var i in n)t[e].apply(t,[i,n[i]].concat(r));return!1}if(u.test(n)){for(var o=n.split(u),s=0,a=o.length;s<a;s++)t[e].apply(t,[o[s]].concat(r));return!1}return!0},o=function(t,e){var n,r=-1,i=t.length,o=e[0],s=e[1],a=e[2];switch(e.length){case 0:for(;++r<i;)(n=t[r]).callback.call(n.ctx);return;case 1:for(;++r<i;)(n=t[r]).callback.call(n.ctx,o);return;case 2:for(;++r<i;)(n=t[r]).callback.call(n.ctx,o,s);return;case 3:for(;++r<i;)(n=t[r]).callback.call(n.ctx,o,s,a);return;default:for(;++r<i;)(n=t[r]).callback.apply(n.ctx,e)}};l.each({listenTo:"on",listenToOnce:"once"},function(i,t){e[t]=function(t,e,n){var r=this._listeners||(this._listeners={});return"object"==typeof e&&(n=this),(r[t._listenerId||(t._listenerId=l.uniqueId("l"))]=t)[i](e,n,this),this}}),e.bind=e.on,e.unbind=e.off,e.mixin=function(e){return l.each(["on","once","off","trigger","stopListening","listenTo","listenToOnce","bind","unbind"],function(t){e[t]=this[t]},this),e},void 0!==h?(void 0!==a&&a.exports&&(h=a.exports=e),h.BackboneEvents=e):this.BackboneEvents=e}()},{}],22:[function(t,e,n){e.exports=t("./backbone-events-standalone")},{"./backbone-events-standalone":21}],23:[function(t,e,n){},{}],24:[function(t,e,n){(function(t){function e(t){return Object.prototype.toString.call(t)}n.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===e(t)},n.isBoolean=function(t){return"boolean"==typeof t},n.isNull=function(t){return null===t},n.isNullOrUndefined=function(t){return null==t},n.isNumber=function(t){return"number"==typeof t},n.isString=function(t){return"string"==typeof t},n.isSymbol=function(t){return"symbol"==typeof t},n.isUndefined=function(t){return void 0===t},n.isRegExp=function(t){return"[object RegExp]"===e(t)},n.isObject=function(t){return"object"==typeof t&&null!==t},n.isDate=function(t){return"[object Date]"===e(t)},n.isError=function(t){return"[object Error]"===e(t)||t instanceof Error},n.isFunction=function(t){return"function"==typeof t},n.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},n.isBuffer=t.isBuffer}).call(this,{isBuffer:t("../../is-buffer/index.js")})},{"../../is-buffer/index.js":50}],25:[function(V,n,r){(function(D,F){var t,e;t=this,e=function(){"use strict";function h(t){return"function"==typeof t}var n=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},r=0,e=void 0,i=void 0,s=function(t,e){f[r]=t,f[r+1]=e,2===(r+=2)&&(i?i(p):m())};var t="undefined"!=typeof window?window:void 0,o=t||{},a=o.MutationObserver||o.WebKitMutationObserver,u="undefined"==typeof self&&void 0!==D&&"[object process]"==={}.toString.call(D),c="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function l(){var t=setTimeout;return function(){return t(p,1)}}var f=new Array(1e3);function p(){for(var t=0;t<r;t+=2){(0,f[t])(f[t+1]),f[t]=void 0,f[t+1]=void 0}r=0}var d,g,y,v,m=void 0;function b(t,e){var n=this,r=new this.constructor(_);void 0===r[E]&&M(r);var i=n._state;if(i){var o=arguments[i-1];s(function(){return N(i,r,o,n._result)})}else P(n,r,t,e);return r}function w(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(_);return L(e,t),e}m=u?function(){return D.nextTick(p)}:a?(g=0,y=new a(p),v=document.createTextNode(""),y.observe(v,{characterData:!0}),function(){v.data=g=++g%2}):c?((d=new MessageChannel).port1.onmessage=p,function(){return d.port2.postMessage(0)}):void 0===t&&"function"==typeof V?function(){try{var t=Function("return this")().require("vertx");return void 0!==(e=t.runOnLoop||t.runOnContext)?function(){e(p)}:l()}catch(t){return l()}}():l();var E=Math.random().toString(36).substring(2);function _(){}var S=void 0,T=1,O=2,j={error:null};function R(t){try{return t.then}catch(t){return j.error=t,j}}function A(t,e,n){e.constructor===t.constructor&&n===b&&e.constructor.resolve===w?function(e,t){t._state===T?k(e,t._result):t._state===O?C(e,t._result):P(t,void 0,function(t){return L(e,t)},function(t){return C(e,t)})}(t,e):n===j?(C(t,j.error),j.error=null):void 0===n?k(t,e):h(n)?function(t,r,i){s(function(e){var n=!1,t=function(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}(i,r,function(t){n||(n=!0,r!==t?L(e,t):k(e,t))},function(t){n||(n=!0,C(e,t))},e._label);!n&&t&&(n=!0,C(e,t))},t)}(t,e,n):k(t,e)}function L(t,e){t===e?C(t,new TypeError("You cannot resolve a promise with itself")):!function(t){var e=typeof t;return null!==t&&("object"==e||"function"==e)}(e)?k(t,e):A(t,e,R(e))}function I(t){t._onerror&&t._onerror(t._result),x(t)}function k(t,e){t._state===S&&(t._result=e,t._state=T,0!==t._subscribers.length&&s(x,t))}function C(t,e){t._state===S&&(t._state=O,t._result=e,s(I,t))}function P(t,e,n,r){var i=t._subscribers,o=i.length;t._onerror=null,i[o]=e,i[o+T]=n,i[o+O]=r,0===o&&t._state&&s(x,t)}function x(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,i=void 0,o=t._result,s=0;s<e.length;s+=3)r=e[s],i=e[s+n],r?N(n,r,i,o):i(o);t._subscribers.length=0}}function N(t,e,n,r){var i=h(n),o=void 0,s=void 0,a=void 0,u=void 0;if(i){if((o=function(t,e){try{return t(e)}catch(t){return j.error=t,j}}(n,r))===j?(u=!0,s=o.error,o.error=null):a=!0,e===o)return void C(e,new TypeError("A promises callback cannot return that same promise."))}else o=r,a=!0;e._state!==S||(i&&a?L(e,o):u?C(e,s):t===T?k(e,o):t===O&&C(e,o))}var q=0;function M(t){t[E]=q++,t._state=void 0,t._result=void 0,t._subscribers=[]}var U=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(_),this.promise[E]||M(this.promise),n(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?k(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&k(this.promise,this._result))):C(this.promise,new Error("Array Methods must be provided an Array"))}return t.prototype._enumerate=function(t){for(var e=0;this._state===S&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===w){var i=R(e);if(i===b&&e._state!==S)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(n===B){var o=new n(_);A(o,e,i),this._willSettleAt(o,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},t.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===S&&(this._remaining--,t===O?C(r,n):this._result[e]=n),0===this._remaining&&k(r,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;P(t,void 0,function(t){return n._settledAt(T,e,t)},function(t){return n._settledAt(O,e,t)})},t}();var B=function(){function e(t){this[E]=q++,this._result=this._state=void 0,this._subscribers=[],_!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(e,t){try{t(function(t){L(e,t)},function(t){C(e,t)})}catch(t){C(e,t)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(t){return this.then(null,t)},e.prototype.finally=function(e){var n=this.constructor;return h(e)?this.then(function(t){return n.resolve(e()).then(function(){return t})},function(t){return n.resolve(e()).then(function(){throw t})}):this.then(e,e)},e}();return B.prototype.then=b,B.all=function(t){return new U(this,t).promise},B.race=function(i){var o=this;return n(i)?new o(function(t,e){for(var n=i.length,r=0;r<n;r++)o.resolve(i[r]).then(t,e)}):new o(function(t,e){return e(new TypeError("You must pass an array to race."))})},B.resolve=w,B.reject=function(t){var e=new this(_);return C(e,t),e},B._setScheduler=function(t){i=t},B._setAsap=function(t){s=t},B._asap=s,B.polyfill=function(){var t=void 0;if(void 0!==F)t=F;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=B},B.Promise=B},"object"==typeof r&&void 0!==n?n.exports=e():t.ES6Promise=e()}).call(this,V("../../process/browser.js"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../process/browser.js":52}],26:[function(t,e,n){!function(t){"use strict";var c="undefined"!=typeof Uint8Array?Uint8Array:Array,n="+".charCodeAt(0),r="/".charCodeAt(0),i="0".charCodeAt(0),o="a".charCodeAt(0),s="A".charCodeAt(0);function l(t){var e=t.charCodeAt(0);return e===n?62:e===r?63:e<i?-1:e<i+10?e-i+26+26:e<s+26?e-s:e<o+26?e-o+26:void 0}t.toByteArray=function(t){var e,n,r,i,o,s;if(0<t.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var a=t.length;o="="===t.charAt(a-2)?2:"="===t.charAt(a-1)?1:0,s=new c(3*t.length/4-o),r=0<o?t.length-4:t.length;var u=0;function h(t){s[u++]=t}for(n=e=0;e<r;e+=4,n+=3)h((16711680&(i=l(t.charAt(e))<<18|l(t.charAt(e+1))<<12|l(t.charAt(e+2))<<6|l(t.charAt(e+3))))>>16),h((65280&i)>>8),h(255&i);return 2==o?h(255&(i=l(t.charAt(e))<<2|l(t.charAt(e+1))>>4)):1==o&&(h((i=l(t.charAt(e))<<10|l(t.charAt(e+1))<<4|l(t.charAt(e+2))>>2)>>8&255),h(255&i)),s},t.fromByteArray=function(t){var e,n,r,i,o=t.length%3,s="";function a(t){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t)}for(e=0,r=t.length-o;e<r;e+=3)n=(t[e]<<16)+(t[e+1]<<8)+t[e+2],s+=a((i=n)>>18&63)+a(i>>12&63)+a(i>>6&63)+a(63&i);switch(o){case 1:s+=a((n=t[t.length-1])>>2),s+=a(n<<4&63),s+="==";break;case 2:s+=a((n=(t[t.length-2]<<8)+t[t.length-1])>>10),s+=a(n>>4&63),s+=a(n<<2&63),s+="="}return s}}(void 0===n?this.base64js={}:n)},{}],27:[function(t,e,n){var r=t("base64-js"),o=t("ieee754"),a=t("is-array");n.Buffer=h,n.SlowBuffer=h,n.INSPECT_MAX_BYTES=50,h.poolSize=8192;var u=1073741823;function h(t,e,n){if(!(this instanceof h))return new h(t,e,n);var r,i,o,s=typeof t;if("number"==s)r=0<t?t>>>0:0;else if("string"==s)"base64"===e&&(t=function(t){t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(_,"");for(;t.length%4!=0;)t+="=";return t}(t)),r=h.byteLength(t,e);else{if("object"!=s||null===t)throw new TypeError("must start with number, buffer, array or string");"Buffer"===t.type&&a(t.data)&&(t=t.data),r=0<+t.length?Math.floor(+t.length):0}if(this.length>u)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+u.toString(16)+" bytes");if(h.TYPED_ARRAY_SUPPORT?i=h._augment(new Uint8Array(r)):((i=this).length=r,i._isBuffer=!0),h.TYPED_ARRAY_SUPPORT&&"number"==typeof t.byteLength)i._set(t);else if(function(t){return a(t)||h.isBuffer(t)||t&&"object"==typeof t&&"number"==typeof t.length}(t))if(h.isBuffer(t))for(o=0;o<r;o++)i[o]=t.readUInt8(o);else for(o=0;o<r;o++)i[o]=(t[o]%256+256)%256;else if("string"==s)i.write(t,0,e);else if("number"==s&&!h.TYPED_ARRAY_SUPPORT&&!n)for(o=0;o<r;o++)i[o]=0;return i}function c(t,e,n,r){return j(function(t){for(var e=[],n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function i(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function s(t,e,n){var r="",i="";n=Math.min(t.length,n);for(var o=e;o<n;o++)t[o]<=127?(r+=R(i)+String.fromCharCode(t[o]),i=""):i+="%"+t[o].toString(16);return r+R(i)}function l(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;i++)r+=String.fromCharCode(t[i]);return r}function f(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||r<n)&&(n=r);for(var i="",o=e;o<n;o++)i+=S(t[o]);return i}function p(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function d(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(n<t+e)throw new RangeError("Trying to access beyond buffer length")}function g(t,e,n,r,i,o){if(!h.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");if(i<e||e<o)throw new TypeError("value is out of bounds");if(n+r>t.length)throw new TypeError("index out of range")}function y(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;i++)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function v(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;i++)t[n+i]=e>>>8*(r?i:3-i)&255}function m(t,e,n,r,i,o){if(i<e||e<o)throw new TypeError("value is out of bounds");if(n+r>t.length)throw new TypeError("index out of range")}function b(t,e,n,r,i){return i||m(t,e,n,4,34028234663852886e22,-34028234663852886e22),o.write(t,e,n,r,23,4),n+4}function w(t,e,n,r,i){return i||m(t,e,n,8,17976931348623157e292,-17976931348623157e292),o.write(t,e,n,r,52,8),n+8}h.TYPED_ARRAY_SUPPORT=function(){try{var t=new ArrayBuffer(0),e=new Uint8Array(t);return e.foo=function(){return 42},42===e.foo()&&"function"==typeof e.subarray&&0===new Uint8Array(1).subarray(1,1).byteLength}catch(t){return!1}}(),h.isBuffer=function(t){return!(null==t||!t._isBuffer)},h.compare=function(t,e){if(!h.isBuffer(t)||!h.isBuffer(e))throw new TypeError("Arguments must be Buffers");for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o&&t[i]===e[i];i++);return i!==o&&(n=t[i],r=e[i]),n<r?-1:r<n?1:0},h.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(t,e){if(!a(t))throw new TypeError("Usage: Buffer.concat(list[, length])");if(0===t.length)return new h(0);if(1===t.length)return t[0];var n;if(void 0===e)for(n=e=0;n<t.length;n++)e+=t[n].length;var r=new h(e),i=0;for(n=0;n<t.length;n++){var o=t[n];o.copy(r,i),i+=o.length}return r},h.byteLength=function(t,e){var n;switch(t+="",e||"utf8"){case"ascii":case"binary":case"raw":n=t.length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=2*t.length;break;case"hex":n=t.length>>>1;break;case"utf8":case"utf-8":n=T(t).length;break;case"base64":n=O(t).length;break;default:n=t.length}return n},h.prototype.length=void 0,h.prototype.parent=void 0,h.prototype.toString=function(t,e,n){var r=!1;if(t||(t="utf8"),(e>>>=0)<0&&(e=0),(n=void 0===n||n===1/0?this.length:n>>>0)>this.length&&(n=this.length),n<=e)return"";for(;;)switch(t){case"hex":return f(this,e,n);case"utf8":case"utf-8":return s(this,e,n);case"ascii":return l(this,e,n);case"binary":return l(this,e,n);case"base64":return i(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return p(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}},h.prototype.equals=function(t){if(!h.isBuffer(t))throw new TypeError("Argument must be a Buffer");return 0===h.compare(this,t)},h.prototype.inspect=function(){var t="",e=n.INSPECT_MAX_BYTES;return 0<this.length&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},h.prototype.compare=function(t){if(!h.isBuffer(t))throw new TypeError("Argument must be a Buffer");return h.compare(this,t)},h.prototype.get=function(t){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(t)},h.prototype.set=function(t,e){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(t,e)},h.prototype.write=function(t,e,n,r){if(isFinite(e))isFinite(n)||(r=n,n=void 0);else{var i=r;r=e,e=n,n=i}e=Number(e)||0;var o,s=this.length-e;switch(n?s<(n=Number(n))&&(n=s):n=s,r=String(r||"utf8").toLowerCase()){case"hex":o=function(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?i<(r=Number(r))&&(r=i):r=i;var o=e.length;if(o%2!=0)throw new Error("Invalid hex string");o/2<r&&(r=o/2);for(var s=0;s<r;s++){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))throw new Error("Invalid hex string");t[n+s]=a}return s}(this,t,e,n);break;case"utf8":case"utf-8":o=function(t,e,n,r){return j(T(e),t,n,r)}(this,t,e,n);break;case"ascii":o=c(this,t,e,n);break;case"binary":o=function(t,e,n,r){return c(t,e,n,r)}(this,t,e,n);break;case"base64":o=function(t,e,n,r){return j(O(e),t,n,r)}(this,t,e,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":o=function(t,e,n,r){return j(function(t){for(var e,n,r,i=[],o=0;o<t.length;o++)e=t.charCodeAt(o),n=e>>8,r=e%256,i.push(r),i.push(n);return i}(e),t,n,r,2)}(this,t,e,n);break;default:throw new TypeError("Unknown encoding: "+r)}return o},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},h.prototype.slice=function(t,e){var n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):n<t&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):n<e&&(e=n),e<t&&(e=t),h.TYPED_ARRAY_SUPPORT)return h._augment(this.subarray(t,e));for(var r=e-t,i=new h(r,void 0,!0),o=0;o<r;o++)i[o]=this[o+t];return i},h.prototype.readUInt8=function(t,e){return e||d(t,1,this.length),this[t]},h.prototype.readUInt16LE=function(t,e){return e||d(t,2,this.length),this[t]|this[t+1]<<8},h.prototype.readUInt16BE=function(t,e){return e||d(t,2,this.length),this[t]<<8|this[t+1]},h.prototype.readUInt32LE=function(t,e){return e||d(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},h.prototype.readUInt32BE=function(t,e){return e||d(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},h.prototype.readInt8=function(t,e){return e||d(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},h.prototype.readInt16LE=function(t,e){e||d(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},h.prototype.readInt16BE=function(t,e){e||d(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},h.prototype.readInt32LE=function(t,e){return e||d(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},h.prototype.readInt32BE=function(t,e){return e||d(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},h.prototype.readFloatLE=function(t,e){return e||d(t,4,this.length),o.read(this,t,!0,23,4)},h.prototype.readFloatBE=function(t,e){return e||d(t,4,this.length),o.read(this,t,!1,23,4)},h.prototype.readDoubleLE=function(t,e){return e||d(t,8,this.length),o.read(this,t,!0,52,8)},h.prototype.readDoubleBE=function(t,e){return e||d(t,8,this.length),o.read(this,t,!1,52,8)},h.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||g(this,t,e,1,255,0),h.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=t,e+1},h.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||g(this,t,e,2,65535,0),h.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8):y(this,t,e,!0),e+2},h.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||g(this,t,e,2,65535,0),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t):y(this,t,e,!1),e+2},h.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||g(this,t,e,4,4294967295,0),h.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=t):v(this,t,e,!0),e+4},h.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||g(this,t,e,4,4294967295,0),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t):v(this,t,e,!1),e+4},h.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||g(this,t,e,1,127,-128),h.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=t,e+1},h.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||g(this,t,e,2,32767,-32768),h.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8):y(this,t,e,!0),e+2},h.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||g(this,t,e,2,32767,-32768),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t):y(this,t,e,!1),e+2},h.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||g(this,t,e,4,2147483647,-2147483648),h.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):v(this,t,e,!0),e+4},h.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||g(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t):v(this,t,e,!1),e+4},h.prototype.writeFloatLE=function(t,e,n){return b(this,t,e,!0,n)},h.prototype.writeFloatBE=function(t,e,n){return b(this,t,e,!1,n)},h.prototype.writeDoubleLE=function(t,e,n){return w(this,t,e,!0,n)},h.prototype.writeDoubleBE=function(t,e,n){return w(this,t,e,!1,n)},h.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e||(e=0),r!==n&&0!==t.length&&0!==this.length){if(r<n)throw new TypeError("sourceEnd < sourceStart");if(e<0||e>=t.length)throw new TypeError("targetStart out of bounds");if(n<0||n>=this.length)throw new TypeError("sourceStart out of bounds");if(r<0||r>this.length)throw new TypeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i=r-n;if(i<1e3||!h.TYPED_ARRAY_SUPPORT)for(var o=0;o<i;o++)t[o+e]=this[o+n];else t._set(this.subarray(n,n+i),e)}},h.prototype.fill=function(t,e,n){if(t||(t=0),e||(e=0),n||(n=this.length),n<e)throw new TypeError("end < start");if(n!==e&&0!==this.length){if(e<0||e>=this.length)throw new TypeError("start out of bounds");if(n<0||n>this.length)throw new TypeError("end out of bounds");var r;if("number"==typeof t)for(r=e;r<n;r++)this[r]=t;else{var i=T(t.toString()),o=i.length;for(r=e;r<n;r++)this[r]=i[r%o]}return this}},h.prototype.toArrayBuffer=function(){if("undefined"==typeof Uint8Array)throw new TypeError("Buffer.toArrayBuffer not supported in this browser");if(h.TYPED_ARRAY_SUPPORT)return new h(this).buffer;for(var t=new Uint8Array(this.length),e=0,n=t.length;e<n;e+=1)t[e]=this[e];return t.buffer};var E=h.prototype;h._augment=function(t){return t.constructor=h,t._isBuffer=!0,t._get=t.get,t._set=t.set,t.get=E.get,t.set=E.set,t.write=E.write,t.toString=E.toString,t.toLocaleString=E.toString,t.toJSON=E.toJSON,t.equals=E.equals,t.compare=E.compare,t.copy=E.copy,t.slice=E.slice,t.readUInt8=E.readUInt8,t.readUInt16LE=E.readUInt16LE,t.readUInt16BE=E.readUInt16BE,t.readUInt32LE=E.readUInt32LE,t.readUInt32BE=E.readUInt32BE,t.readInt8=E.readInt8,t.readInt16LE=E.readInt16LE,t.readInt16BE=E.readInt16BE,t.readInt32LE=E.readInt32LE,t.readInt32BE=E.readInt32BE,t.readFloatLE=E.readFloatLE,t.readFloatBE=E.readFloatBE,t.readDoubleLE=E.readDoubleLE,t.readDoubleBE=E.readDoubleBE,t.writeUInt8=E.writeUInt8,t.writeUInt16LE=E.writeUInt16LE,t.writeUInt16BE=E.writeUInt16BE,t.writeUInt32LE=E.writeUInt32LE,t.writeUInt32BE=E.writeUInt32BE,t.writeInt8=E.writeInt8,t.writeInt16LE=E.writeInt16LE,t.writeInt16BE=E.writeInt16BE,t.writeInt32LE=E.writeInt32LE,t.writeInt32BE=E.writeInt32BE,t.writeFloatLE=E.writeFloatLE,t.writeFloatBE=E.writeFloatBE,t.writeDoubleLE=E.writeDoubleLE,t.writeDoubleBE=E.writeDoubleBE,t.fill=E.fill,t.inspect=E.inspect,t.toArrayBuffer=E.toArrayBuffer,t};var _=/[^+\/0-9A-z]/g;function S(t){return t<16?"0"+t.toString(16):t.toString(16)}function T(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);if(r<=127)e.push(r);else{var i=n;55296<=r&&r<=57343&&n++;for(var o=encodeURIComponent(t.slice(i,n+1)).substr(1).split("%"),s=0;s<o.length;s++)e.push(parseInt(o[s],16))}}return e}function O(t){return r.toByteArray(t)}function j(t,e,n,r,i){i&&(r-=r%i);for(var o=0;o<r&&!(o+n>=e.length||o>=t.length);o++)e[o+n]=t[o];return o}function R(t){try{return decodeURIComponent(t)}catch(t){return String.fromCharCode(65533)}}},{"base64-js":26,ieee754:47,"is-array":49}],28:[function(t,e,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function a(t){return"function"==typeof t}function u(t){return"object"==typeof t&&null!==t}function h(t){return void 0===t}((e.exports=r).EventEmitter=r).prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(t){if(!function(t){return"number"==typeof t}(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},r.prototype.emit=function(t){var e,n,r,i,o,s;if(this._events||(this._events={}),"error"===t&&(!this._events.error||u(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;throw TypeError('Uncaught, unspecified "error" event.')}if(h(n=this._events[t]))return!1;if(a(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(r=arguments.length,i=new Array(r-1),o=1;o<r;o++)i[o-1]=arguments[o];n.apply(this,i)}else if(u(n)){for(r=arguments.length,i=new Array(r-1),o=1;o<r;o++)i[o-1]=arguments[o];for(r=(s=n.slice()).length,o=0;o<r;o++)s[o].apply(this,i)}return!0},r.prototype.on=r.prototype.addListener=function(t,e){var n;if(!a(e))throw TypeError("listener must be a function");(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,a(e.listener)?e.listener:e),this._events[t]?u(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,u(this._events[t])&&!this._events[t].warned)&&((n=h(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&0<n&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()));return this},r.prototype.once=function(t,e){if(!a(e))throw TypeError("listener must be a function");var n=!1;function r(){this.removeListener(t,r),n||(n=!0,e.apply(this,arguments))}return r.listener=e,this.on(t,r),this},r.prototype.removeListener=function(t,e){var n,r,i,o;if(!a(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(i=(n=this._events[t]).length,r=-1,n===e||a(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(u(n)){for(o=i;0<o--;)if(n[o]===e||n[o].listener&&n[o].listener===e){r=o;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},r.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(a(n=this._events[t]))this.removeListener(t,n);else for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},r.prototype.listeners=function(t){return this._events&&this._events[t]?a(this._events[t])?[this._events[t]]:this._events[t].slice():[]},r.listenerCount=function(t,e){return t._events&&t._events[e]?a(t._events[e])?1:t._events[e].length:0}},{}],29:[function(t,e,n){e.exports=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)}},{}],30:[function(t,C,P){(function(k){!function(t){var e="object"==typeof P&&P,n="object"==typeof C&&C&&C.exports==e&&C,r="object"==typeof k&&k;r.global!==r&&r.window!==r||(t=r);var i,o,v=2147483647,m=36,b=1,w=26,s=38,a=700,E=72,_=128,S="-",u=/^xn--/,h=/[^ -~]/,c=/\x2E|\u3002|\uFF0E|\uFF61/g,l={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=m-b,T=Math.floor,O=String.fromCharCode;function j(t){throw RangeError(l[t])}function p(t,e){for(var n=t.length;n--;)t[n]=e(t[n]);return t}function d(t,e){return p(t.split(c),e).join(".")}function R(t){for(var e,n,r=[],i=0,o=t.length;i<o;)55296<=(e=t.charCodeAt(i++))&&e<=56319&&i<o?56320==(64512&(n=t.charCodeAt(i++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),i--):r.push(e);return r}function A(t){return p(t,function(t){var e="";return 65535<t&&(e+=O((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=O(t)}).join("")}function L(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function I(t,e,n){var r=0;for(t=n?T(t/a):t>>1,t+=T(t/e);f*w>>1<t;r+=m)t=T(t/f);return T(r+(f+1)*t/(t+s))}function g(t){var e,n,r,i,o,s,a,u,h,c,l,f=[],p=t.length,d=0,g=_,y=E;for((n=t.lastIndexOf(S))<0&&(n=0),r=0;r<n;++r)128<=t.charCodeAt(r)&&j("not-basic"),f.push(t.charCodeAt(r));for(i=0<n?n+1:0;i<p;){for(o=d,s=1,a=m;p<=i&&j("invalid-input"),l=t.charCodeAt(i++),(m<=(u=l-48<10?l-22:l-65<26?l-65:l-97<26?l-97:m)||u>T((v-d)/s))&&j("overflow"),d+=u*s,!(u<(h=a<=y?b:y+w<=a?w:a-y));a+=m)s>T(v/(c=m-h))&&j("overflow"),s*=c;y=I(d-o,e=f.length+1,0==o),T(d/e)>v-g&&j("overflow"),g+=T(d/e),d%=e,f.splice(d++,0,g)}return A(f)}function y(t){var e,n,r,i,o,s,a,u,h,c,l,f,p,d,g,y=[];for(f=(t=R(t)).length,e=_,o=E,s=n=0;s<f;++s)(l=t[s])<128&&y.push(O(l));for(r=i=y.length,i&&y.push(S);r<f;){for(a=v,s=0;s<f;++s)e<=(l=t[s])&&l<a&&(a=l);for(a-e>T((v-n)/(p=r+1))&&j("overflow"),n+=(a-e)*p,e=a,s=0;s<f;++s)if((l=t[s])<e&&++n>v&&j("overflow"),l==e){for(u=n,h=m;!(u<(c=h<=o?b:o+w<=h?w:h-o));h+=m)g=u-c,d=m-c,y.push(O(L(c+g%d,0))),u=T(g/d);y.push(O(L(u,0))),o=I(n,p,r==i),n=0,++r}++n,++e}return y.join("")}if(i={version:"1.2.4",ucs2:{decode:R,encode:A},decode:g,encode:y,toASCII:function(t){return d(t,function(t){return h.test(t)?"xn--"+y(t):t})},toUnicode:function(t){return d(t,function(t){return u.test(t)?g(t.slice(4).toLowerCase()):t})}},e&&!e.nodeType)if(n)n.exports=i;else for(o in i)i.hasOwnProperty(o)&&(e[o]=i[o]);else t.punycode=i}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],31:[function(t,e,n){e.exports=t("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":32}],32:[function(a,u,t){(function(t){u.exports=o;var e=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e},n=a("core-util-is");n.inherits=a("inherits");var r=a("./_stream_readable"),i=a("./_stream_writable");function o(t){if(!(this instanceof o))return new o(t);r.call(this,t),i.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",s)}function s(){this.allowHalfOpen||this._writableState.ended||t.nextTick(this.end.bind(this))}n.inherits(o,r),function(t,e){for(var n=0,r=t.length;n<r;n++)e(t[n],n)}(e(i.prototype),function(t){o.prototype[t]||(o.prototype[t]=i.prototype[t])})}).call(this,a("../../../../process/browser.js"))},{"../../../../process/browser.js":52,"./_stream_readable":34,"./_stream_writable":36,"core-util-is":24,inherits:48}],33:[function(t,e,n){e.exports=o;var r=t("./_stream_transform"),i=t("core-util-is");function o(t){if(!(this instanceof o))return new o(t);r.call(this,t)}i.inherits=t("inherits"),i.inherits(o,r),o.prototype._transform=function(t,e,n){n(null,t)}},{"./_stream_transform":35,"core-util-is":24,inherits:48}],34:[function(b,t,e){(function(d){t.exports=n;var g=b("isarray"),f=b("buffer").Buffer;n.ReadableState=e;var y=b("events").EventEmitter;y.listenerCount||(y.listenerCount=function(t,e){return t.listeners(e).length});var o,s=b("stream"),a=b("core-util-is");a.inherits=b("inherits");var v=b("util");function e(t,e){var n=b("./_stream_duplex"),r=(t=t||{}).highWaterMark,i=t.objectMode?16:16384;this.highWaterMark=r||0===r?r:i,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!t.objectMode,e instanceof n&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.defaultEncoding=t.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(o||(o=b("string_decoder/").StringDecoder),this.decoder=new o(t.encoding),this.encoding=t.encoding)}function n(t){b("./_stream_duplex");if(!(this instanceof n))return new n(t);this._readableState=new e(t,this),this.readable=!0,s.call(this)}function r(t,e,n,r,i){var o=function(t,e){var n=null;a.isBuffer(e)||a.isString(e)||a.isNullOrUndefined(e)||t.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));return n}(e,n);if(o)t.emit("error",o);else if(a.isNullOrUndefined(n))e.reading=!1,e.ended||function(t,e){if(e.decoder&&!e.ended){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,h(t)}(t,e);else if(e.objectMode||n&&0<n.length)if(e.ended&&!i){var s=new Error("stream.push() after EOF");t.emit("error",s)}else if(e.endEmitted&&i){s=new Error("stream.unshift() after end event");t.emit("error",s)}else!e.decoder||i||r||(n=e.decoder.write(n)),i||(e.reading=!1),e.flowing&&0===e.length&&!e.sync?(t.emit("data",n),t.read(0)):(e.length+=e.objectMode?1:n.length,i?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&h(t)),function(t,e){e.readingMore||(e.readingMore=!0,d.nextTick(function(){!function(t,e){var n=e.length;for(;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(v("maybeReadMore read 0"),t.read(0),n!==e.length);)n=e.length;e.readingMore=!1}(t,e)}))}(t,e);else i||(e.reading=!1);return function(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}(e)}v=v&&v.debuglog?v.debuglog("stream"):function(){},a.inherits(n,s),n.prototype.push=function(t,e){var n=this._readableState;return a.isString(t)&&!n.objectMode&&(e=e||n.defaultEncoding)!==n.encoding&&(t=new f(t,e),e=""),r(this,n,t,e,!1)},n.prototype.unshift=function(t){return r(this,this._readableState,t,"",!0)},n.prototype.setEncoding=function(t){return o||(o=b("string_decoder/").StringDecoder),this._readableState.decoder=new o(t),this._readableState.encoding=t,this};var i=8388608;function u(t,e){return 0===e.length&&e.ended?0:e.objectMode?0===t?0:1:isNaN(t)||a.isNull(t)?e.flowing&&e.buffer.length?e.buffer[0].length:e.length:t<=0?0:(t>e.highWaterMark&&(e.highWaterMark=function(t){if(i<=t)t=i;else{t--;for(var e=1;e<32;e<<=1)t|=t>>e;t++}return t}(t)),t>e.length?e.ended?e.length:(e.needReadable=!0,0):t)}function h(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(v("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?d.nextTick(function(){c(t)}):c(t))}function c(t){v("emit readable"),t.emit("readable"),m(t)}function m(t){var e=t._readableState;if(v("flow",e.flowing),e.flowing)do{var n=t.read()}while(null!==n&&e.flowing)}function l(t,e){var n,r=e.buffer,i=e.length,o=!!e.decoder,s=!!e.objectMode;if(0===r.length)return null;if(0===i)n=null;else if(s)n=r.shift();else if(!t||i<=t)n=o?r.join(""):f.concat(r,i),r.length=0;else{if(t<r[0].length)n=(c=r[0]).slice(0,t),r[0]=c.slice(t);else if(t===r[0].length)n=r.shift();else{n=o?"":new f(t);for(var a=0,u=0,h=r.length;u<h&&a<t;u++){var c=r[0],l=Math.min(t-a,c.length);o?n+=c.slice(0,l):c.copy(n,a,0,l),l<c.length?r[0]=c.slice(l):r.shift(),a+=l}}}return n}function p(t){var e=t._readableState;if(0<e.length)throw new Error("endReadable called on non-empty stream");e.endEmitted||(e.ended=!0,d.nextTick(function(){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}))}n.prototype.read=function(t){v("read",t);var e=this._readableState,n=t;if((!a.isNumber(t)||0<t)&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return v("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?p(this):h(this),null;if(0===(t=u(t,e))&&e.ended)return 0===e.length&&p(this),null;var r,i=e.needReadable;return v("need readable",i),(0===e.length||e.length-t<e.highWaterMark)&&v("length less than watermark",i=!0),(e.ended||e.reading)&&v("reading or ended",i=!1),i&&(v("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1),i&&!e.reading&&(t=u(n,e)),r=0<t?l(t,e):null,a.isNull(r)&&(e.needReadable=!0,t=0),e.length-=t,0!==e.length||e.ended||(e.needReadable=!0),n!==t&&e.ended&&0===e.length&&p(this),a.isNull(r)||this.emit("data",r),r},n.prototype._read=function(t){this.emit("error",new Error("not implemented"))},n.prototype.pipe=function(e,t){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=e;break;case 1:r.pipes=[r.pipes,e];break;default:r.pipes.push(e)}r.pipesCount+=1,v("pipe count=%d opts=%j",r.pipesCount,t);var i=(!t||!1!==t.end)&&e!==d.stdout&&e!==d.stderr?s:u;function o(t){v("onunpipe"),t===n&&u()}function s(){v("onend"),e.end()}r.endEmitted?d.nextTick(i):n.once("end",i),e.on("unpipe",o);var a=function(e){return function(){var t=e._readableState;v("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&y.listenerCount(e,"data")&&(t.flowing=!0,m(e))}}(n);function u(){v("cleanup"),e.removeListener("close",l),e.removeListener("finish",f),e.removeListener("drain",a),e.removeListener("error",c),e.removeListener("unpipe",o),n.removeListener("end",s),n.removeListener("end",u),n.removeListener("data",h),!r.awaitDrain||e._writableState&&!e._writableState.needDrain||a()}function h(t){v("ondata"),!1===e.write(t)&&(v("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,n.pause())}function c(t){v("onerror",t),p(),e.removeListener("error",c),0===y.listenerCount(e,"error")&&e.emit("error",t)}function l(){e.removeListener("finish",f),p()}function f(){v("onfinish"),e.removeListener("close",l),p()}function p(){v("unpipe"),n.unpipe(e)}return e.on("drain",a),n.on("data",h),e._events&&e._events.error?g(e._events.error)?e._events.error.unshift(c):e._events.error=[c,e._events.error]:e.on("error",c),e.once("close",l),e.once("finish",f),e.emit("pipe",n),r.flowing||(v("pipe resume"),n.resume()),e},n.prototype.unpipe=function(t){var e=this._readableState;if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this)),this;if(t)return-1===(i=function(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}(e.pipes,t))||(e.pipes.splice(i,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this)),this;var n=e.pipes,r=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var i=0;i<r;i++)n[i].emit("unpipe",this);return this},n.prototype.addListener=n.prototype.on=function(t,e){var n=s.prototype.on.call(this,t,e);if("data"===t&&!1!==this._readableState.flowing&&this.resume(),"readable"===t&&this.readable){var r=this._readableState;if(!r.readableListening)if(r.readableListening=!0,r.emittedReadable=!1,r.needReadable=!0,r.reading)r.length&&h(this);else{var i=this;d.nextTick(function(){v("readable nexttick read 0"),i.read(0)})}}return n},n.prototype.resume=function(){var t=this._readableState;return t.flowing||(v("resume"),t.flowing=!0,t.reading||(v("resume read 0"),this.read(0)),function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,d.nextTick(function(){!function(t,e){e.resumeScheduled=!1,t.emit("resume"),m(t),e.flowing&&!e.reading&&t.read(0)}(t,e)}))}(this,t)),this},n.prototype.pause=function(){return v("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(v("pause"),this._readableState.flowing=!1,this.emit("pause")),this},n.prototype.wrap=function(e){var n=this._readableState,r=!1,i=this;for(var t in e.on("end",function(){if(v("wrapped end"),n.decoder&&!n.ended){var t=n.decoder.end();t&&t.length&&i.push(t)}i.push(null)}),e.on("data",function(t){(v("wrapped data"),n.decoder&&(t=n.decoder.write(t)),t&&(n.objectMode||t.length))&&(i.push(t)||(r=!0,e.pause()))}),e)a.isFunction(e[t])&&a.isUndefined(this[t])&&(this[t]=function(t){return function(){return e[t].apply(e,arguments)}}(t));return function(t,e){for(var n=0,r=t.length;n<r;n++)e(t[n],n)}(["error","close","destroy","pause","resume"],function(t){e.on(t,i.emit.bind(i,t))}),i._read=function(t){v("wrapped _read",t),r&&(r=!1,e.resume())},i},n._fromList=l}).call(this,b("../../../../process/browser.js"))},{"../../../../process/browser.js":52,"./_stream_duplex":32,buffer:27,"core-util-is":24,events:28,inherits:48,isarray:29,stream:41,"string_decoder/":42,util:23}],35:[function(t,e,n){e.exports=o;var r=t("./_stream_duplex"),s=t("core-util-is");function i(t,n){this.afterTransform=function(t,e){return function(t,e,n){var r=t._transformState;r.transforming=!1;var i=r.writecb;if(!i)return t.emit("error",new Error("no writecb in Transform class"));r.writechunk=null,r.writecb=null,s.isNullOrUndefined(n)||t.push(n);i&&i(e);var o=t._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&t._read(o.highWaterMark)}(n,t,e)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function o(t){if(!(this instanceof o))return new o(t);r.call(this,t),this._transformState=new i(t,this);var e=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("prefinish",function(){s.isFunction(this._flush)?this._flush(function(t){a(e,t)}):a(e)})}function a(t,e){if(e)return t.emit("error",e);var n=t._writableState,r=t._transformState;if(n.length)throw new Error("calling transform done when ws.length != 0");if(r.transforming)throw new Error("calling transform done when still transforming");return t.push(null)}s.inherits=t("inherits"),s.inherits(o,r),o.prototype.push=function(t,e){return this._transformState.needTransform=!1,r.prototype.push.call(this,t,e)},o.prototype._transform=function(t,e,n){throw new Error("not implemented")},o.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(t){var e=this._transformState;s.isNull(e.writechunk)||!e.writecb||e.transforming?e.needTransform=!0:(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform))}},{"./_stream_duplex":32,"core-util-is":24,inherits:48}],36:[function(g,t,e){(function(s){t.exports=i;var a=g("buffer").Buffer;i.WritableState=r;var u=g("core-util-is");u.inherits=g("inherits");var n=g("stream");function h(t,e,n){this.chunk=t,this.encoding=e,this.callback=n}function r(t,e){var n=g("./_stream_duplex"),r=(t=t||{}).highWaterMark,i=t.objectMode?16:16384;this.highWaterMark=r||0===r?r:i,this.objectMode=!!t.objectMode,e instanceof n&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1;var o=(this.finished=!1)===t.decodeStrings;this.decodeStrings=!o,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var n=t._writableState,r=n.sync,i=n.writecb;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(n),e)!function(t,e,n,r,i){n?s.nextTick(function(){e.pendingcb--,i(r)}):(e.pendingcb--,i(r));t._writableState.errorEmitted=!0,t.emit("error",r)}(t,n,r,e,i);else{var o=p(t,n);o||n.corked||n.bufferProcessing||!n.buffer.length||f(t,n),r?s.nextTick(function(){l(t,n,o,i)}):l(t,n,o,i)}}(e,t)},this.writecb=null,this.writelen=0,this.buffer=[],this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1}function i(t){var e=g("./_stream_duplex");if(!(this instanceof i||this instanceof e))return new i(t);this._writableState=new r(t,this),this.writable=!0,n.call(this)}function c(t,e,n,r,i,o,s){e.writelen=r,e.writecb=s,e.writing=!0,e.sync=!0,n?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function l(t,e,n,r){n||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,r(),d(t,e)}function f(t,n){if(n.bufferProcessing=!0,t._writev&&1<n.buffer.length){for(var r=[],e=0;e<n.buffer.length;e++)r.push(n.buffer[e].callback);n.pendingcb++,c(t,n,!0,n.length,n.buffer,"",function(t){for(var e=0;e<r.length;e++)n.pendingcb--,r[e](t)}),n.buffer=[]}else{for(e=0;e<n.buffer.length;e++){var i=n.buffer[e],o=i.chunk,s=i.encoding,a=i.callback,u=n.objectMode?1:o.length;if(c(t,n,!1,u,o,s,a),n.writing){e++;break}}e<n.buffer.length?n.buffer=n.buffer.slice(e):n.buffer.length=0}n.bufferProcessing=!1}function p(t,e){return e.ending&&0===e.length&&!e.finished&&!e.writing}function o(t,e){e.prefinished||(e.prefinished=!0,t.emit("prefinish"))}function d(t,e){var n=p(0,e);return n&&(0===e.pendingcb?(o(t,e),e.finished=!0,t.emit("finish")):o(t,e)),n}u.inherits(i,n),i.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},i.prototype.write=function(t,e,n){var r=this._writableState,i=!1;return u.isFunction(e)&&(n=e,e=null),u.isBuffer(t)?e="buffer":e||(e=r.defaultEncoding),u.isFunction(n)||(n=function(){}),r.ended?function(t,e,n){var r=new Error("write after end");t.emit("error",r),s.nextTick(function(){n(r)})}(this,0,n):function(t,e,n,r){var i=!0;if(!(u.isBuffer(n)||u.isString(n)||u.isNullOrUndefined(n)||e.objectMode)){var o=new TypeError("Invalid non-string/buffer chunk");t.emit("error",o),s.nextTick(function(){r(o)}),i=!1}return i}(this,r,t,n)&&(r.pendingcb++,i=function(t,e,n,r,i){n=function(t,e,n){return!t.objectMode&&!1!==t.decodeStrings&&u.isString(e)&&(e=new a(e,n)),e}(e,n,r),u.isBuffer(n)&&(r="buffer");var o=e.objectMode?1:n.length;e.length+=o;var s=e.length<e.highWaterMark;s||(e.needDrain=!0);e.writing||e.corked?e.buffer.push(new h(n,r,i)):c(t,e,!1,o,n,r,i);return s}(this,r,t,e,n)),i},i.prototype.cork=function(){this._writableState.corked++},i.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.buffer.length||f(this,t))},i.prototype._write=function(t,e,n){n(new Error("not implemented"))},i.prototype._writev=null,i.prototype.end=function(t,e,n){var r=this._writableState;u.isFunction(t)?(n=t,e=t=null):u.isFunction(e)&&(n=e,e=null),u.isNullOrUndefined(t)||this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(t,e,n){e.ending=!0,d(t,e),n&&(e.finished?s.nextTick(n):t.once("finish",n));e.ended=!0}(this,r,n)}}).call(this,g("../../../../process/browser.js"))},{"../../../../process/browser.js":52,"./_stream_duplex":32,buffer:27,"core-util-is":24,inherits:48,stream:41}],37:[function(t,e,n){e.exports=t("./lib/_stream_passthrough.js")},{"./lib/_stream_passthrough.js":33}],38:[function(e,n,r){(function(t){(r=n.exports=e("./lib/_stream_readable.js")).Stream=e("stream"),(r.Readable=r).Writable=e("./lib/_stream_writable.js"),r.Duplex=e("./lib/_stream_duplex.js"),r.Transform=e("./lib/_stream_transform.js"),r.PassThrough=e("./lib/_stream_passthrough.js"),t.browser||"disable"!==t.env.READABLE_STREAM||(n.exports=e("stream"))}).call(this,e("../../../process/browser.js"))},{"../../../process/browser.js":52,"./lib/_stream_duplex.js":32,"./lib/_stream_passthrough.js":33,"./lib/_stream_readable.js":34,"./lib/_stream_transform.js":35,"./lib/_stream_writable.js":36,stream:41}],39:[function(t,e,n){e.exports=t("./lib/_stream_transform.js")},{"./lib/_stream_transform.js":35}],40:[function(t,e,n){e.exports=t("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":36}],41:[function(t,e,n){e.exports=r;var c=t("events").EventEmitter;function r(){c.call(this)}t("inherits")(r,c),r.Readable=t("readable-stream/readable.js"),r.Writable=t("readable-stream/writable.js"),r.Duplex=t("readable-stream/duplex.js"),r.Transform=t("readable-stream/transform.js"),r.PassThrough=t("readable-stream/passthrough.js"),(r.Stream=r).prototype.pipe=function(e,t){var n=this;function r(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function i(){n.readable&&n.resume&&n.resume()}n.on("data",r),e.on("drain",i),e._isStdio||t&&!1===t.end||(n.on("end",s),n.on("close",a));var o=!1;function s(){o||(o=!0,e.end())}function a(){o||(o=!0,"function"==typeof e.destroy&&e.destroy())}function u(t){if(h(),0===c.listenerCount(this,"error"))throw t}function h(){n.removeListener("data",r),e.removeListener("drain",i),n.removeListener("end",s),n.removeListener("close",a),n.removeListener("error",u),e.removeListener("error",u),n.removeListener("end",h),n.removeListener("close",h),e.removeListener("close",h)}return n.on("error",u),e.on("error",u),n.on("end",h),n.on("close",h),e.on("close",h),e.emit("pipe",n),e}},{events:28,inherits:48,"readable-stream/duplex.js":31,"readable-stream/passthrough.js":37,"readable-stream/readable.js":38,"readable-stream/transform.js":39,"readable-stream/writable.js":40}],42:[function(t,e,n){var r=t("buffer").Buffer,i=r.isEncoding||function(t){switch(t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};var o=n.StringDecoder=function(t){switch(this.encoding=(t||"utf8").toLowerCase().replace(/[-_]/,""),function(t){if(t&&!i(t))throw new Error("Unknown encoding: "+t)}(t),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=a;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=u;break;default:return void(this.write=s)}this.charBuffer=new r(6),this.charReceived=0,this.charLength=0};function s(t){return t.toString(this.encoding)}function a(t){this.charReceived=t.length%2,this.charLength=this.charReceived?2:0}function u(t){this.charReceived=t.length%3,this.charLength=this.charReceived?3:0}o.prototype.write=function(t){for(var e="";this.charLength;){var n=t.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:t.length;if(t.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";if(t=t.slice(n,t.length),!(55296<=(i=(e=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(e.length-1))&&i<=56319)){if(this.charReceived=this.charLength=0,0===t.length)return e;break}this.charLength+=this.surrogateSize,e=""}this.detectIncompleteChar(t);var r=t.length;this.charLength&&(t.copy(this.charBuffer,0,t.length-this.charReceived,r),r-=this.charReceived);var i;r=(e+=t.toString(this.encoding,0,r)).length-1;if(55296<=(i=e.charCodeAt(r))&&i<=56319){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),t.copy(this.charBuffer,0,0,o),e.substring(0,r)}return e},o.prototype.detectIncompleteChar=function(t){for(var e=3<=t.length?3:t.length;0<e;e--){var n=t[t.length-e];if(1==e&&n>>5==6){this.charLength=2;break}if(e<=2&&n>>4==14){this.charLength=3;break}if(e<=3&&n>>3==30){this.charLength=4;break}}this.charReceived=e},o.prototype.end=function(t){var e="";if(t&&t.length&&(e=this.write(t)),this.charReceived){var n=this.charReceived,r=this.charBuffer,i=this.encoding;e+=r.slice(0,n).toString(i)}return e}},{buffer:27}],43:[function(t,e,n){var k=t("punycode");function m(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}n.parse=o,n.resolve=function(t,e){return o(t,!1,!0).resolve(e)},n.resolveObject=function(t,e){return t?o(t,!1,!0).resolveObject(e):e},n.format=function(t){V(t)&&(t=o(t));return t instanceof m?t.format():m.prototype.format.call(t)},n.Url=m;var C=/^([a-z0-9.+-]+:)/i,r=/:[0-9]*$/,i=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),P=["'"].concat(i),x=["%","/","?",";","#"].concat(P),N=["/","?","#"],q=/^[a-z0-9A-Z_-]{0,63}$/,M=/^([a-z0-9A-Z_-]{0,63})(.*)$/,U={javascript:!0,"javascript:":!0},B={javascript:!0,"javascript:":!0},D={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},F=t("querystring");function o(t,e,n){if(t&&a(t)&&t instanceof m)return t;var r=new m;return r.parse(t,e,n),r}function V(t){return"string"==typeof t}function a(t){return"object"==typeof t&&null!==t}function b(t){return null===t}m.prototype.parse=function(t,e,n){if(!V(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var r=t;r=r.trim();var i=C.exec(r);if(i){var o=(i=i[0]).toLowerCase();this.protocol=o,r=r.substr(i.length)}if(n||i||r.match(/^\/\/[^@\/]+@[^@\/]+/)){var s="//"===r.substr(0,2);!s||i&&B[i]||(r=r.substr(2),this.slashes=!0)}if(!B[i]&&(s||i&&!D[i])){for(var a,u,h=-1,c=0;c<N.length;c++){-1!==(l=r.indexOf(N[c]))&&(-1===h||l<h)&&(h=l)}-1!==(u=-1===h?r.lastIndexOf("@"):r.lastIndexOf("@",h))&&(a=r.slice(0,u),r=r.slice(u+1),this.auth=decodeURIComponent(a)),h=-1;for(c=0;c<x.length;c++){var l;-1!==(l=r.indexOf(x[c]))&&(-1===h||l<h)&&(h=l)}-1===h&&(h=r.length),this.host=r.slice(0,h),r=r.slice(h),this.parseHost(),this.hostname=this.hostname||"";var f="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!f)for(var p=this.hostname.split(/\./),d=(c=0,p.length);c<d;c++){var g=p[c];if(g&&!g.match(q)){for(var y="",v=0,m=g.length;v<m;v++)127<g.charCodeAt(v)?y+="x":y+=g[v];if(!y.match(q)){var b=p.slice(0,c),w=p.slice(c+1),E=g.match(M);E&&(b.push(E[1]),w.unshift(E[2])),w.length&&(r="/"+w.join(".")+r),this.hostname=b.join(".");break}}}if(255<this.hostname.length?this.hostname="":this.hostname=this.hostname.toLowerCase(),!f){var _=this.hostname.split("."),S=[];for(c=0;c<_.length;++c){var T=_[c];S.push(T.match(/[^A-Za-z0-9_-]/)?"xn--"+k.encode(T):T)}this.hostname=S.join(".")}var O=this.port?":"+this.port:"",j=this.hostname||"";this.host=j+O,this.href+=this.host,f&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==r[0]&&(r="/"+r))}if(!U[o])for(c=0,d=P.length;c<d;c++){var R=P[c],A=encodeURIComponent(R);A===R&&(A=escape(R)),r=r.split(R).join(A)}var L=r.indexOf("#");-1!==L&&(this.hash=r.substr(L),r=r.slice(0,L));var I=r.indexOf("?");if(-1!==I?(this.search=r.substr(I),this.query=r.substr(I+1),e&&(this.query=F.parse(this.query)),r=r.slice(0,I)):e&&(this.search="",this.query={}),r&&(this.pathname=r),D[o]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){O=this.pathname||"",T=this.search||"";this.path=O+T}return this.href=this.format(),this},m.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",i=!1,o="";this.host?i=t+this.host:this.hostname&&(i=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&a(this.query)&&Object.keys(this.query).length&&(o=F.stringify(this.query));var s=this.search||o&&"?"+o||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||D[e])&&!1!==i?(i="//"+(i||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):i||(i=""),r&&"#"!==r.charAt(0)&&(r="#"+r),s&&"?"!==s.charAt(0)&&(s="?"+s),e+i+(n=n.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(s=s.replace("#","%23"))+r},m.prototype.resolve=function(t){return this.resolveObject(o(t,!1,!0)).format()},m.prototype.resolveObject=function(e){if(V(e)){var t=new m;t.parse(e,!1,!0),e=t}var n=new m;if(Object.keys(this).forEach(function(t){n[t]=this[t]},this),n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol)return Object.keys(e).forEach(function(t){"protocol"!==t&&(n[t]=e[t])}),D[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n;if(e.protocol&&e.protocol!==n.protocol){if(!D[e.protocol])return Object.keys(e).forEach(function(t){n[t]=e[t]}),n.href=n.format(),n;if(n.protocol=e.protocol,e.host||B[e.protocol])n.pathname=e.pathname;else{for(var r=(e.pathname||"").split("/");r.length&&!(e.host=r.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==r[0]&&r.unshift(""),r.length<2&&r.unshift(""),n.pathname=r.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var i=n.pathname||"",o=n.search||"";n.path=i+o}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var s=n.pathname&&"/"===n.pathname.charAt(0),a=e.host||e.pathname&&"/"===e.pathname.charAt(0),u=a||s||n.host&&e.pathname,h=u,c=n.pathname&&n.pathname.split("/")||[],l=(r=e.pathname&&e.pathname.split("/")||[],n.protocol&&!D[n.protocol]);if(l&&(n.hostname="",n.port=null,n.host&&(""===c[0]?c[0]=n.host:c.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===r[0]?r[0]=e.host:r.unshift(e.host)),e.host=null),u=u&&(""===r[0]||""===c[0])),a)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,c=r;else if(r.length)c||(c=[]),c.pop(),c=c.concat(r),n.search=e.search,n.query=e.query;else if(!function(t){return null==t}(e.search)){if(l)n.hostname=n.host=c.shift(),(y=!!(n.host&&0<n.host.indexOf("@"))&&n.host.split("@"))&&(n.auth=y.shift(),n.host=n.hostname=y.shift());return n.search=e.search,n.query=e.query,b(n.pathname)&&b(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!c.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var f=c.slice(-1)[0],p=(n.host||e.host)&&("."===f||".."===f)||""===f,d=0,g=c.length;0<=g;g--)"."==(f=c[g])?c.splice(g,1):".."===f?(c.splice(g,1),d++):d&&(c.splice(g,1),d--);if(!u&&!h)for(;d--;d)c.unshift("..");!u||""===c[0]||c[0]&&"/"===c[0].charAt(0)||c.unshift(""),p&&"/"!==c.join("/").substr(-1)&&c.push("");var y,v=""===c[0]||c[0]&&"/"===c[0].charAt(0);l&&(n.hostname=n.host=v?"":c.length?c.shift():"",(y=!!(n.host&&0<n.host.indexOf("@"))&&n.host.split("@"))&&(n.auth=y.shift(),n.host=n.hostname=y.shift()));return(u=u||n.host&&c.length)&&!v&&c.unshift(""),c.length?n.pathname=c.join("/"):(n.pathname=null,n.path=null),b(n.pathname)&&b(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},m.prototype.parseHost=function(){var t=this.host,e=r.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},{punycode:30,querystring:55}],44:[function(t,e,n){var r=e.exports,i=(t("events").EventEmitter,t("./lib/request")),o=t("url");r.request=function(t,e){"string"==typeof t&&(t=o.parse(t)),t||(t={}),t.host||t.port||(t.port=parseInt(window.location.port,10)),!t.host&&t.hostname&&(t.host=t.hostname),t.protocol||(t.scheme?t.protocol=t.scheme+":":t.protocol=window.location.protocol),t.host||(t.host=window.location.hostname||window.location.host),/:/.test(t.host)&&(t.port||(t.port=t.host.split(":")[1]),t.host=t.host.split(":")[0]),t.port||(t.port="https:"==t.protocol?443:80);var n=new i(new s,t);return e&&n.on("response",e),n},r.get=function(t,e){t.method="GET";var n=r.request(t,e);return n.end(),n},r.Agent=function(){},r.Agent.defaultMaxSockets=4;var s=function(){if("undefined"==typeof window)throw new Error("no window object present");if(window.XMLHttpRequest)return window.XMLHttpRequest;if(window.ActiveXObject){for(var e=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"],n=0;n<e.length;n++)try{var r=new window.ActiveXObject(e[n]);return function(){if(r){var t=r;return r=null,t}return new window.ActiveXObject(e[n])}}catch(t){}throw new Error("ajax not supported in this browser")}throw new Error("ajax not supported in this browser")}();r.STATUS_CODES={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Time-out",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Large",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{"./lib/request":45,events:28,url:43}],45:[function(t,e,n){var r=t("stream"),u=t("./response"),h=t("Base64"),i=t("inherits"),o=e.exports=function(t,e){var n=this;n.writable=!0,n.xhr=t,n.body=[],n.uri=(e.protocol||"http:")+"//"+e.host+(e.port?":"+e.port:"")+(e.path||"/"),void 0===e.withCredentials&&(e.withCredentials=!0);try{t.withCredentials=e.withCredentials}catch(t){}if(e.responseType)try{t.responseType=e.responseType}catch(t){}if(t.open(e.method||"GET",n.uri,!0),t.onerror=function(t){n.emit("error",new Error("Network error"))},n._headers={},e.headers)for(var r=c(e.headers),i=0;i<r.length;i++){var o=r[i];if(n.isSafeRequestHeader(o)){var s=e.headers[o];n.setHeader(o,s)}}e.auth&&this.setHeader("Authorization","Basic "+h.btoa(e.auth));var a=new u;a.on("close",function(){n.emit("close")}),a.on("ready",function(){n.emit("response",a)}),a.on("error",function(t){n.emit("error",t)}),t.onreadystatechange=function(){t.__aborted||a.handle(t)}};i(o,r),o.prototype.setHeader=function(t,e){this._headers[t.toLowerCase()]=e},o.prototype.getHeader=function(t){return this._headers[t.toLowerCase()]},o.prototype.removeHeader=function(t){delete this._headers[t.toLowerCase()]},o.prototype.write=function(t){this.body.push(t)},o.prototype.destroy=function(t){this.xhr.__aborted=!0,this.xhr.abort(),this.emit("close")},o.prototype.end=function(t){void 0!==t&&this.body.push(t);for(var e=c(this._headers),n=0;n<e.length;n++){var r=e[n],i=this._headers[r];if(l(i))for(var o=0;o<i.length;o++)this.xhr.setRequestHeader(r,i[o]);else this.xhr.setRequestHeader(r,i)}if(0===this.body.length)this.xhr.send("");else if("string"==typeof this.body[0])this.xhr.send(this.body.join(""));else if(l(this.body[0])){var s=[];for(n=0;n<this.body.length;n++)s.push.apply(s,this.body[n]);this.xhr.send(s)}else if(/Array/.test(Object.prototype.toString.call(this.body[0]))){var a=0;for(n=0;n<this.body.length;n++)a+=this.body[n].length;s=new this.body[0].constructor(a);var u=0;for(n=0;n<this.body.length;n++){var h=this.body[n];for(o=0;o<h.length;o++)s[u++]=h[o]}this.xhr.send(s)}else if(f(this.body[0]))this.xhr.send(this.body[0]);else{for(s="",n=0;n<this.body.length;n++)s+=this.body[n].toString();this.xhr.send(s)}},o.unsafeHeaders=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"],o.prototype.isSafeRequestHeader=function(t){return!!t&&-1===s(o.unsafeHeaders,t.toLowerCase())};var c=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e},l=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},s=function(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1},f=function(t){return"undefined"!=typeof Blob&&t instanceof Blob||("undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer||("undefined"!=typeof FormData&&t instanceof FormData||void 0))}},{"./response":46,Base64:19,inherits:48,stream:41}],46:[function(t,e,n){var r=t("stream"),i=t("util"),o=e.exports=function(t){this.offset=0,this.readable=!0};i.inherits(o,r);var s={streaming:!0,status2:!0};function a(t){for(var e=t.getAllResponseHeaders().split(/\r?\n/),n={},r=0;r<e.length;r++){var i=e[r];if(""!==i){var o=i.match(/^([^:]+):\s*(.*)/);if(o){var s=o[1].toLowerCase(),a=o[2];void 0!==n[s]?u(n[s])?n[s].push(a):n[s]=[n[s],a]:n[s]=a}else n[i]=!0}}return n}o.prototype.getResponse=function(t){var e=String(t.responseType).toLowerCase();return"blob"===e?t.responseBlob||t.response:"arraybuffer"===e?t.response:t.responseText},o.prototype.getHeader=function(t){return this.headers[t.toLowerCase()]},o.prototype.handle=function(t){if(2===t.readyState&&s.status2){try{this.statusCode=t.status,this.headers=a(t)}catch(t){s.status2=!1}s.status2&&this.emit("ready")}else if(s.streaming&&3===t.readyState){try{this.statusCode||(this.statusCode=t.status,this.headers=a(t),this.emit("ready"))}catch(t){}try{this._emitData(t)}catch(t){s.streaming=!1}}else 4===t.readyState&&(this.statusCode||(this.statusCode=t.status,this.emit("ready")),this._emitData(t),t.error?this.emit("error",this.getResponse(t)):this.emit("end"),this.emit("close"))},o.prototype._emitData=function(t){var e=this.getResponse(t);if(e.toString().match(/ArrayBuffer/))return this.emit("data",new Uint8Array(e,this.offset)),void(this.offset=e.byteLength);e.length>this.offset&&(this.emit("data",e.slice(this.offset)),this.offset=e.length)};var u=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{stream:41,util:58}],47:[function(t,e,n){n.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,h=u>>1,c=-7,l=n?i-1:0,f=n?-1:1,p=t[e+l];for(l+=f,o=p&(1<<-c)-1,p>>=-c,c+=a;0<c;o=256*o+t[e+l],l+=f,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=r;0<c;s=256*s+t[e+l],l+=f,c-=8);if(0===o)o=1-h;else{if(o===u)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),o-=h}return(p?-1:1)*s*Math.pow(2,o-r)},n.write=function(t,e,n,r,i,o){var s,a,u,h=8*o-i-1,c=(1<<h)-1,l=c>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),2<=(e+=1<=s+l?f/u:f*Math.pow(2,1-l))*u&&(s++,u/=2),c<=s+l?(a=0,s=c):1<=s+l?(a=(e*u-1)*Math.pow(2,i),s+=l):(a=e*Math.pow(2,l-1)*Math.pow(2,i),s=0));8<=i;t[n+p]=255&a,p+=d,a/=256,i-=8);for(s=s<<i|a,h+=i;0<h;t[n+p]=255&s,p+=d,s/=256,h-=8);t[n+p-d]|=128*g}},{}],48:[function(t,e,n){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],49:[function(t,e,n){var r=Array.isArray,i=Object.prototype.toString;e.exports=r||function(t){return!!t&&"[object Array]"==i.call(t)}},{}],50:[function(t,e,n){function r(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}e.exports=function(t){return null!=t&&(r(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&r(t.slice(0,0))}(t)||!!t._isBuffer)}},{}],51:[function(t,e,n){(function(u){var o={},h=o.LEFT_BRACE=1,c=o.RIGHT_BRACE=2,l=o.LEFT_BRACKET=3,f=o.RIGHT_BRACKET=4,p=o.COLON=5,d=o.COMMA=6,g=o.TRUE=7,y=o.FALSE=8,v=o.NULL=9,m=o.STRING=10,b=o.NUMBER=11,w=o.START=17,n=o.STOP=18,E=o.TRUE1=33,_=o.TRUE2=34,S=o.TRUE3=35,T=o.FALSE1=49,O=o.FALSE2=50,j=o.FALSE3=51,R=o.FALSE4=52,A=o.NULL1=65,L=o.NULL2=66,I=o.NULL3=67,k=o.NUMBER1=81,C=o.NUMBER3=83,P=o.STRING1=97,x=o.STRING2=98,N=o.STRING3=99,q=o.STRING4=100,M=o.STRING5=101,U=o.STRING6=102,r=o.VALUE=113,i=o.KEY=114,s=o.OBJECT=129,a=o.ARRAY=130,B="\\".charCodeAt(0),D="/".charCodeAt(0),F="\b".charCodeAt(0),V="\f".charCodeAt(0),H="\n".charCodeAt(0),Y="\r".charCodeAt(0),z="\t".charCodeAt(0),J=65536;function W(){this.tState=w,this.value=void 0,this.string=void 0,this.stringBuffer=u.alloc?u.alloc(J):new u(J),this.stringBufferOffset=0,this.unicode=void 0,this.highSurrogate=void 0,this.key=void 0,this.mode=void 0,this.stack=[],this.state=r,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:new u(2),3:new u(3),4:new u(4)},this.offset=-1}W.toknam=function(t){for(var e=Object.keys(o),n=0,r=e.length;n<r;n++){var i=e[n];if(o[i]===t)return i}return t&&"0x"+t.toString(16)};var t=W.prototype;t.onError=function(t){throw t},t.charError=function(t,e){this.tState=n,this.onError(new Error("Unexpected "+JSON.stringify(String.fromCharCode(t[e]))+" at position "+e+" in state "+W.toknam(this.tState)))},t.appendStringChar=function(t){this.stringBufferOffset>=J&&(this.string+=this.stringBuffer.toString("utf8"),this.stringBufferOffset=0),this.stringBuffer[this.stringBufferOffset++]=t},t.appendStringBuf=function(t,e,n){var r=t.length;"number"==typeof e&&(r="number"==typeof n?n<0?t.length-e+n:n-e:t.length-e),r<0&&(r=0),this.stringBufferOffset+r>J&&(this.string+=this.stringBuffer.toString("utf8",0,this.stringBufferOffset),this.stringBufferOffset=0),t.copy(this.stringBuffer,this.stringBufferOffset,e,n),this.stringBufferOffset+=r},t.write=function(t){var e;"string"==typeof t&&(t=new u(t));for(var n=0,r=t.length;n<r;n++)if(this.tState===w){if(e=t[n],this.offset++,123===e)this.onToken(h,"{");else if(125===e)this.onToken(c,"}");else if(91===e)this.onToken(l,"[");else if(93===e)this.onToken(f,"]");else if(58===e)this.onToken(p,":");else if(44===e)this.onToken(d,",");else if(116===e)this.tState=E;else if(102===e)this.tState=T;else if(110===e)this.tState=A;else if(34===e)this.string="",this.stringBufferOffset=0,this.tState=P;else if(45===e)this.string="-",this.tState=k;else if(48<=e&&e<64)this.string=String.fromCharCode(e),this.tState=C;else if(32!==e&&9!==e&&10!==e&&13!==e)return this.charError(t,n)}else if(this.tState===P)if(e=t[n],0<this.bytes_remaining){for(var i=0;i<this.bytes_remaining;i++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+i]=t[i];this.appendStringBuf(this.temp_buffs[this.bytes_in_sequence]),this.bytes_in_sequence=this.bytes_remaining=0,n=n+i-1}else if(0===this.bytes_remaining&&128<=e){if(e<=193||244<e)return this.onError(new Error("Invalid UTF-8 character at position "+n+" in state "+W.toknam(this.tState)));if(194<=e&&e<=223&&(this.bytes_in_sequence=2),224<=e&&e<=239&&(this.bytes_in_sequence=3),240<=e&&e<=244&&(this.bytes_in_sequence=4),this.bytes_in_sequence+n>t.length){for(var o=0;o<=t.length-1-n;o++)this.temp_buffs[this.bytes_in_sequence][o]=t[n+o];this.bytes_remaining=n+this.bytes_in_sequence-t.length,n=t.length-1}else this.appendStringBuf(t,n,n+this.bytes_in_sequence),n=n+this.bytes_in_sequence-1}else if(34===e)this.tState=w,this.string+=this.stringBuffer.toString("utf8",0,this.stringBufferOffset),this.stringBufferOffset=0,this.onToken(m,this.string),this.offset+=u.byteLength(this.string,"utf8")+1,this.string=void 0;else if(92===e)this.tState=x;else{if(!(32<=e))return this.charError(t,n);this.appendStringChar(e)}else if(this.tState===x)if(34===(e=t[n]))this.appendStringChar(e),this.tState=P;else if(92===e)this.appendStringChar(B),this.tState=P;else if(47===e)this.appendStringChar(D),this.tState=P;else if(98===e)this.appendStringChar(F),this.tState=P;else if(102===e)this.appendStringChar(V),this.tState=P;else if(110===e)this.appendStringChar(H),this.tState=P;else if(114===e)this.appendStringChar(Y),this.tState=P;else if(116===e)this.appendStringChar(z),this.tState=P;else{if(117!==e)return this.charError(t,n);this.unicode="",this.tState=N}else if(this.tState===N||this.tState===q||this.tState===M||this.tState===U){if(!(48<=(e=t[n])&&e<64||64<e&&e<=70||96<e&&e<=102))return this.charError(t,n);if(this.unicode+=String.fromCharCode(e),this.tState++==U){var s=parseInt(this.unicode,16);(this.unicode=void 0)!==this.highSurrogate&&56320<=s&&s<57344?(this.appendStringBuf(new u(String.fromCharCode(this.highSurrogate,s))),this.highSurrogate=void 0):void 0===this.highSurrogate&&55296<=s&&s<56320?this.highSurrogate=s:(void 0!==this.highSurrogate&&(this.appendStringBuf(new u(String.fromCharCode(this.highSurrogate))),this.highSurrogate=void 0),this.appendStringBuf(new u(String.fromCharCode(s)))),this.tState=P}}else if(this.tState===k||this.tState===C)switch(e=t[n]){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 46:case 101:case 69:case 43:case 45:this.string+=String.fromCharCode(e),this.tState=C;break;default:this.tState=w;var a=Number(this.string);if(isNaN(a))return this.charError(t,n);this.string.match(/[0-9]+/)==this.string&&a.toString()!=this.string?this.onToken(m,this.string):this.onToken(b,a),this.offset+=this.string.length-1,this.string=void 0,n--}else if(this.tState===E){if(114!==t[n])return this.charError(t,n);this.tState=_}else if(this.tState===_){if(117!==t[n])return this.charError(t,n);this.tState=S}else if(this.tState===S){if(101!==t[n])return this.charError(t,n);this.tState=w,this.onToken(g,!0),this.offset+=3}else if(this.tState===T){if(97!==t[n])return this.charError(t,n);this.tState=O}else if(this.tState===O){if(108!==t[n])return this.charError(t,n);this.tState=j}else if(this.tState===j){if(115!==t[n])return this.charError(t,n);this.tState=R}else if(this.tState===R){if(101!==t[n])return this.charError(t,n);this.tState=w,this.onToken(y,!1),this.offset+=4}else if(this.tState===A){if(117!==t[n])return this.charError(t,n);this.tState=L}else if(this.tState===L){if(108!==t[n])return this.charError(t,n);this.tState=I}else if(this.tState===I){if(108!==t[n])return this.charError(t,n);this.tState=w,this.onToken(v,null),this.offset+=3}},t.onToken=function(t,e){},t.parseError=function(t,e){this.tState=n,this.onError(new Error("Unexpected "+W.toknam(t)+(e?"("+JSON.stringify(e)+")":"")+" in state "+W.toknam(this.state)))},t.push=function(){this.stack.push({value:this.value,key:this.key,mode:this.mode})},t.pop=function(){var t=this.value,e=this.stack.pop();this.value=e.value,this.key=e.key,this.mode=e.mode,this.emit(t),this.mode||(this.state=r)},t.emit=function(t){this.mode&&(this.state=d),this.onValue(t)},t.onValue=function(t){},t.onToken=function(t,e){if(this.state===r)if(t===m||t===b||t===g||t===y||t===v)this.value&&(this.value[this.key]=e),this.emit(e);else if(t===h)this.push(),this.value?this.value=this.value[this.key]={}:this.value={},this.key=void 0,this.state=i,this.mode=s;else if(t===l)this.push(),this.value?this.value=this.value[this.key]=[]:this.value=[],this.key=0,this.mode=a,this.state=r;else if(t===c){if(this.mode!==s)return this.parseError(t,e);this.pop()}else{if(t!==f)return this.parseError(t,e);if(this.mode!==a)return this.parseError(t,e);this.pop()}else if(this.state===i)if(t===m)this.key=e,this.state=p;else{if(t!==c)return this.parseError(t,e);this.pop()}else if(this.state===p){if(t!==p)return this.parseError(t,e);this.state=r}else{if(this.state!==d)return this.parseError(t,e);if(t===d)this.mode===a?(this.key++,this.state=r):this.mode===s&&(this.state=i);else{if(!(t===f&&this.mode===a||t===c&&this.mode===s))return this.parseError(t,e);this.pop()}}},W.C=o,e.exports=W}).call(this,t("buffer").Buffer)},{buffer:27}],52:[function(t,e,n){var r,i,o=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function u(e){if(r===setTimeout)return setTimeout(e,0);if((r===s||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:s}catch(t){r=s}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(t){i=a}}();var h,c=[],l=!1,f=-1;function p(){l&&h&&(l=!1,h.length?c=h.concat(c):f=-1,c.length&&d())}function d(){if(!l){var t=u(p);l=!0;for(var e=c.length;e;){for(h=c,c=[];++f<e;)h&&h[f].run();f=-1,e=c.length}h=null,l=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(t)}}function g(t,e){this.fun=t,this.array=e}function y(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new g(t,e)),1!==c.length||l||u(d)},g.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=y,o.addListener=y,o.once=y,o.off=y,o.removeListener=y,o.removeAllListeners=y,o.emit=y,o.prependListener=y,o.prependOnceListener=y,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],53:[function(t,e,n){"use strict";e.exports=function(t,e,n,r){e=e||"&",n=n||"=";var i={};if("string"!=typeof t||0===t.length)return i;var o=/\+/g;t=t.split(e);var s=1e3;r&&"number"==typeof r.maxKeys&&(s=r.maxKeys);var a,u,h=t.length;0<s&&s<h&&(h=s);for(var c=0;c<h;++c){var l,f,p,d,g=t[c].replace(o,"%20"),y=g.indexOf(n);f=0<=y?(l=g.substr(0,y),g.substr(y+1)):(l=g,""),p=decodeURIComponent(l),d=decodeURIComponent(f),a=i,u=p,Object.prototype.hasOwnProperty.call(a,u)?v(i[p])?i[p].push(d):i[p]=[i[p],d]:i[p]=d}return i};var v=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],54:[function(t,e,n){"use strict";var o=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};e.exports=function(n,r,i,t){return r=r||"&",i=i||"=",null===n&&(n=void 0),"object"==typeof n?a(u(n),function(t){var e=encodeURIComponent(o(t))+i;return s(n[t])?a(n[t],function(t){return e+encodeURIComponent(o(t))}).join(r):e+encodeURIComponent(o(n[t]))}).join(r):t?encodeURIComponent(o(t))+i+encodeURIComponent(o(n)):""};var s=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function a(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var u=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},{}],55:[function(t,e,n){"use strict";n.decode=n.parse=t("./decode"),n.encode=n.stringify=t("./encode")},{"./decode":53,"./encode":54}],56:[function(e,n,t){(function(h){var c=e("stream");function t(e,n,t){e=e||function(t){this.queue(t)},n=n||function(){this.queue(null)};var r=!1,i=!1,o=[],s=!1,a=new c;function u(){for(;o.length&&!a.paused;){var t=o.shift();if(null===t)return a.emit("end");a.emit("data",t)}}return a.readable=a.writable=!0,a.paused=!1,a.autoDestroy=!(t&&!1===t.autoDestroy),a.write=function(t){return e.call(this,t),!a.paused},a.queue=a.push=function(t){return s||(null===t&&(s=!0),o.push(t),u()),a},a.on("end",function(){a.readable=!1,!a.writable&&a.autoDestroy&&h.nextTick(function(){a.destroy()})}),a.end=function(t){if(!r)return r=!0,arguments.length&&a.write(t),a.writable=!1,n.call(a),!a.readable&&a.autoDestroy&&a.destroy(),a},a.destroy=function(){if(!i)return r=i=!0,o.length=0,a.writable=a.readable=!1,a.emit("close"),a},a.pause=function(){if(!a.paused)return a.paused=!0,a},a.resume=function(){return a.paused&&(a.paused=!1,a.emit("resume")),u(),a.paused||a.emit("drain"),a},a}n.exports=t,t.through=t}).call(this,e("../process/browser.js"))},{"../process/browser.js":52,stream:41}],57:[function(t,e,n){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],58:[function(j,t,R){(function(r,i){var a=/%[sdj%]/g;R.format=function(t){if(!b(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(u(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,i=r.length,o=String(t).replace(a,function(t){if("%%"===t)return"%";if(i<=n)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),s=r[n];n<i;s=r[++n])v(s)||!c(s)?o+=" "+s:o+=" "+u(s);return o},R.deprecate=function(t,e){if(w(i.process))return function(){return R.deprecate(t,e).apply(this,arguments)};if(!0===r.noDeprecation)return t;var n=!1;return function(){if(!n){if(r.throwDeprecation)throw new Error(e);r.traceDeprecation?console.trace(e):console.error(e),n=!0}return t.apply(this,arguments)}};var t,o={};function u(t,e){var n={seen:[],stylize:h};return 3<=arguments.length&&(n.depth=arguments[2]),4<=arguments.length&&(n.colors=arguments[3]),y(e)?n.showHidden=e:e&&R._extend(n,e),w(n.showHidden)&&(n.showHidden=!1),w(n.depth)&&(n.depth=2),w(n.colors)&&(n.colors=!1),w(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=s),f(n,t,n.depth)}function s(t,e){var n=u.styles[e];return n?"["+u.colors[n][0]+"m"+t+"["+u.colors[n][1]+"m":t}function h(t,e){return t}function f(e,n,r){if(e.customInspect&&n&&T(n.inspect)&&n.inspect!==R.inspect&&(!n.constructor||n.constructor.prototype!==n)){var t=n.inspect(r,e);return b(t)||(t=f(e,t,r)),t}var i=function(t,e){if(w(e))return t.stylize("undefined","undefined");if(b(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(m(e))return t.stylize(""+e,"number");if(y(e))return t.stylize(""+e,"boolean");if(v(e))return t.stylize("null","null")}(e,n);if(i)return i;var o=Object.keys(n),s=function(t){var n={};return t.forEach(function(t,e){n[t]=!0}),n}(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(n)),S(n)&&(0<=o.indexOf("message")||0<=o.indexOf("description")))return p(n);if(0===o.length){if(T(n)){var a=n.name?": "+n.name:"";return e.stylize("[Function"+a+"]","special")}if(E(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(_(n))return e.stylize(Date.prototype.toString.call(n),"date");if(S(n))return p(n)}var u,h="",c=!1,l=["{","}"];(g(n)&&(c=!0,l=["[","]"]),T(n))&&(h=" [Function"+(n.name?": "+n.name:"")+"]");return E(n)&&(h=" "+RegExp.prototype.toString.call(n)),_(n)&&(h=" "+Date.prototype.toUTCString.call(n)),S(n)&&(h=" "+p(n)),0!==o.length||c&&0!=n.length?r<0?E(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),u=c?function(e,n,r,i,t){for(var o=[],s=0,a=n.length;s<a;++s)O(n,String(s))?o.push(d(e,n,r,i,String(s),!0)):o.push("");return t.forEach(function(t){t.match(/^\d+$/)||o.push(d(e,n,r,i,t,!0))}),o}(e,n,r,s,o):o.map(function(t){return d(e,n,r,s,t,c)}),e.seen.pop(),function(t,e,n){if(60<t.reduce(function(t,e){return 0,0<=e.indexOf("\n")&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0))return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(u,h,l)):l[0]+h+l[1]}function p(t){return"["+Error.prototype.toString.call(t)+"]"}function d(t,e,n,r,i,o){var s,a,u;if((u=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?a=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(a=t.stylize("[Setter]","special")),O(r,i)||(s="["+i+"]"),a||(t.seen.indexOf(u.value)<0?-1<(a=v(n)?f(t,u.value,null):f(t,u.value,n-1)).indexOf("\n")&&(a=o?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n")):a=t.stylize("[Circular]","special")),w(s)){if(o&&i.match(/^\d+$/))return a;s=(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),t.stylize(s,"string"))}return s+": "+a}function g(t){return Array.isArray(t)}function y(t){return"boolean"==typeof t}function v(t){return null===t}function m(t){return"number"==typeof t}function b(t){return"string"==typeof t}function w(t){return void 0===t}function E(t){return c(t)&&"[object RegExp]"===e(t)}function c(t){return"object"==typeof t&&null!==t}function _(t){return c(t)&&"[object Date]"===e(t)}function S(t){return c(t)&&("[object Error]"===e(t)||t instanceof Error)}function T(t){return"function"==typeof t}function e(t){return Object.prototype.toString.call(t)}function n(t){return t<10?"0"+t.toString(10):t.toString(10)}R.debuglog=function(e){if(w(t)&&(t=r.env.NODE_DEBUG||""),e=e.toUpperCase(),!o[e])if(new RegExp("\\b"+e+"\\b","i").test(t)){var n=r.pid;o[e]=function(){var t=R.format.apply(R,arguments);console.error("%s %d: %s",e,n,t)}}else o[e]=function(){};return o[e]},(R.inspect=u).colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},R.isArray=g,R.isBoolean=y,R.isNull=v,R.isNullOrUndefined=function(t){return null==t},R.isNumber=m,R.isString=b,R.isSymbol=function(t){return"symbol"==typeof t},R.isUndefined=w,R.isRegExp=E,R.isObject=c,R.isDate=_,R.isError=S,R.isFunction=T,R.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},R.isBuffer=j("./support/isBuffer");var l=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function O(t,e){return Object.prototype.hasOwnProperty.call(t,e)}R.log=function(){console.log("%s - %s",function(){var t=new Date,e=[n(t.getHours()),n(t.getMinutes()),n(t.getSeconds())].join(":");return[t.getDate(),l[t.getMonth()],e].join(" ")}(),R.format.apply(R,arguments))},R.inherits=j("inherits"),R._extend=function(t,e){if(!e||!c(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(this,j("../process/browser.js"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../process/browser.js":52,"./support/isBuffer":57,inherits:48}]},{},[2])(2)})}(window.intermine);